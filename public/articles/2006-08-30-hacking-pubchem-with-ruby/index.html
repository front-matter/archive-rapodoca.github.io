<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Hacking PubChem with Ruby | Depth-First</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="PubChem is an increasingly popular, free-access, online molecular database operated by the National Institutes of Health. Web services are a hot topic, with sites such as Flickr, Google, and eBay offering developers the tools to build rich content through &ldquo;mashups&rdquo; of several web APIs. Although there is no formal PubChem API, it&rsquo;s possible to roll your own. As a demonstration, this article will show how structural information can be retrieved from PubChem using some simple Ruby code. The inspiration for this article came from the PubChem module that is part of Chemruby.">
    <meta name="generator" content="Hugo 0.139.4">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    

    
      

    

    

    
      <link rel="canonical" href="http://localhost:1313/articles/2006-08-30-hacking-pubchem-with-ruby/">
    

    <meta property="og:url" content="http://localhost:1313/articles/2006-08-30-hacking-pubchem-with-ruby/">
  <meta property="og:site_name" content="Depth-First">
  <meta property="og:title" content="Hacking PubChem with Ruby">
  <meta property="og:description" content="PubChem is an increasingly popular, free-access, online molecular database operated by the National Institutes of Health. Web services are a hot topic, with sites such as Flickr, Google, and eBay offering developers the tools to build rich content through “mashups” of several web APIs. Although there is no formal PubChem API, it’s possible to roll your own. As a demonstration, this article will show how structural information can be retrieved from PubChem using some simple Ruby code. The inspiration for this article came from the PubChem module that is part of Chemruby.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="articles">
    <meta property="article:published_time" content="2006-08-30T00:00:00+00:00">
    <meta property="article:modified_time" content="2006-08-30T00:00:00+00:00">

  <meta itemprop="name" content="Hacking PubChem with Ruby">
  <meta itemprop="description" content="PubChem is an increasingly popular, free-access, online molecular database operated by the National Institutes of Health. Web services are a hot topic, with sites such as Flickr, Google, and eBay offering developers the tools to build rich content through “mashups” of several web APIs. Although there is no formal PubChem API, it’s possible to roll your own. As a demonstration, this article will show how structural information can be retrieved from PubChem using some simple Ruby code. The inspiration for this article came from the PubChem module that is part of Chemruby.">
  <meta itemprop="datePublished" content="2006-08-30T00:00:00+00:00">
  <meta itemprop="dateModified" content="2006-08-30T00:00:00+00:00">
  <meta itemprop="wordCount" content="437">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Hacking PubChem with Ruby">
  <meta name="twitter:description" content="PubChem is an increasingly popular, free-access, online molecular database operated by the National Institutes of Health. Web services are a hot topic, with sites such as Flickr, Google, and eBay offering developers the tools to build rich content through “mashups” of several web APIs. Although there is no formal PubChem API, it’s possible to roll your own. As a demonstration, this article will show how structural information can be retrieved from PubChem using some simple Ruby code. The inspiration for this article came from the PubChem module that is part of Chemruby.">

	
  </head><body class="ma0 avenir bg-near-white development">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Depth-First
      
    </a>
    <div class="flex-l items-center">
      

      
      <div class="ananke-socials"></div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Articles
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1">Hacking PubChem with Ruby</h1>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2006-08-30T00:00:00Z">August 30, 2006</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p><!-- raw HTML omitted -->PubChem<!-- raw HTML omitted --> is an increasingly popular, free-access, online molecular database operated by the National Institutes of Health. Web services are a hot topic, with sites such as <!-- raw HTML omitted -->Flickr<!-- raw HTML omitted -->, <!-- raw HTML omitted -->Google<!-- raw HTML omitted -->, and <!-- raw HTML omitted -->eBay<!-- raw HTML omitted --> offering developers the tools to build rich content through &ldquo;mashups&rdquo; of several web APIs. Although there is no formal PubChem API, it&rsquo;s possible to roll your own. As a demonstration, this article will show how structural information can be retrieved from PubChem using some simple Ruby code. The inspiration for this article came from the <code>PubChem</code> module that is part of <!-- raw HTML omitted -->Chemruby<!-- raw HTML omitted -->.</p>
<p>The only thing you&rsquo;ll need for this tutorial is Ruby, preferably version 1.8.2 or higher. Create a directory called <strong>pubchem</strong> and make it your working directory. Then create a file called <strong>pubchem.rb</strong> containing the following code:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span>require <span style="color:#e6db74">&#39;net/http&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># A very simple PubChem Web API.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PubChem</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># Returns a molfile (as a String) for the molecule with PubChem</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># CID matching compound_id.</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">self</span><span style="color:#f92672">.</span><span style="color:#a6e22e">get_molfile</span>(compound_id)
</span></span><span style="display:flex;"><span>    molfile <span style="color:#f92672">=</span> <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>    path <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/summary/summary.cgi?cid=&#39;</span> <span style="color:#f92672">+</span> compound_id <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;&amp;disopt=DisplaySDF&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">Net</span><span style="color:#f92672">::</span><span style="color:#66d9ef">HTTP</span><span style="color:#f92672">.</span>start(<span style="color:#e6db74">&#39;pubchem.ncbi.nlm.nih.gov&#39;</span>) <span style="color:#66d9ef">do</span> <span style="color:#f92672">|</span>http<span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span>      response <span style="color:#f92672">=</span> http<span style="color:#f92672">.</span>get(path)
</span></span><span style="display:flex;"><span>      molfile <span style="color:#f92672">=</span> response<span style="color:#f92672">.</span>body
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    molfile
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># Writes a PNG image, for the molecule with PubChem</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># CID matching compound_id, to the file specified by filename.</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">self</span><span style="color:#f92672">.</span><span style="color:#a6e22e">write_image</span>(compound_id, filename)
</span></span><span style="display:flex;"><span>    path <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/image/imgsrv.fcgi?t=l&amp;cid=&#39;</span> <span style="color:#f92672">+</span> compound_id
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">Net</span><span style="color:#f92672">::</span><span style="color:#66d9ef">HTTP</span><span style="color:#f92672">.</span>start(<span style="color:#e6db74">&#39;pubchem.ncbi.nlm.nih.gov&#39;</span>) <span style="color:#66d9ef">do</span> <span style="color:#f92672">|</span>http<span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span>      response <span style="color:#f92672">=</span> http<span style="color:#f92672">.</span>get(path)
</span></span><span style="display:flex;"><span>      image <span style="color:#f92672">=</span> response<span style="color:#f92672">.</span>body
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">File</span><span style="color:#f92672">.</span>open(filename, <span style="color:#e6db74">&#34;w&#34;</span>) <span style="color:#66d9ef">do</span> <span style="color:#f92672">|</span>file<span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span>        file <span style="color:#f92672">&lt;&lt;</span> image
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><p>PubChem references each of its compounds by a unique integer identifier, the PubChem CID. This is very handy because retrieving PubChem resources is as simple as encoding a URL containing the CID of interest. The class above illustrates how this system can be used to get a molfile and write a PNG image using just a few lines of Ruby.</p>
<p>Using the <code>PubChem</code> class is simplicity itself. To get the molfile for Levonorgestrel (<!-- raw HTML omitted -->Plan B<!-- raw HTML omitted -->), which has the CID 13109:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span>require <span style="color:#e6db74">&#39;pubchem&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>molfile <span style="color:#f92672">=</span> <span style="color:#66d9ef">PubChem</span><span style="color:#f92672">::</span>get_molfile(<span style="color:#e6db74">&#39;13109&#39;</span>) <span style="color:#75715e">#=&gt; returns the molfile for Levonorgestrel as a String</span>
</span></span></code></pre></div><p>To write the 2-D structure diagram of Levonorgestrel as a PNG:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span>require <span style="color:#e6db74">&#39;pubchem&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">PubChem</span><span style="color:#f92672">::</span>write_png(<span style="color:#e6db74">&#39;13109&#39;</span>, <span style="color:#e6db74">&#39;image.png&#39;</span>) <span style="color:#75715e">#=&gt; writes a PNG image of Levonorgestrel</span>
</span></span></code></pre></div><p>This code saves the image below to your working directory as <strong>image.png</strong>. The above two code fragments can either be saved as a file and executed by the Ruby interpreter:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ruby filename.rb
</span></span></code></pre></div><p>or it they be entered interactively in your console with <!-- raw HTML omitted -->irb<!-- raw HTML omitted -->:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>irb
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:001:0&gt;  
</span></span></code></pre></div><p>As you can see, there&rsquo;s not much to building a PubChem API in Ruby. The same principles discussed here should apply in any programming language. Future articles in this series will show how to build more complex PubChem APIs and integrate them with other software packages and web services.</p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://localhost:1313/" >
    &copy;  Depth-First 2024 
  </a>
    <div><div class="ananke-socials"></div>
</div>
  </div>
</footer>

  </body>
</html>
