<!DOCTYPE html>
<html lang="en-us" dir="ltr" class="scroll-smooth" data-default-appearance="light"
  data-auto-appearance="true"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  
  <meta http-equiv="content-language" content="en-us" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>On the (F)utility of Extending the Molfile Format &middot; Depth-First</title>
  <meta name="title" content="On the (F)utility of Extending the Molfile Format &middot; Depth-First" />
  
  
  
  
  
  <link rel="canonical" href="http://localhost:1313/articles/2012/01/11/on-the-futility-of-extending-the-molfile-format/" />
  
  
  
  
  
  
  
  
  
  
  <link type="text/css" rel="stylesheet" href="/css/main.bundle.min.e27868ab1485f7ed7b06b122b4980bd38b19526eb8f7de885181204d28f04a0c47e9c334eff19a06c0278eb2ff8415b983a5d0fb80fd6b5680c926457cc61c57.css"
    integrity="sha512-4nhoqxSF9&#43;17BrEitJgL04sZUm64996IUYEgTSjwSgxH6cM07/GaBsAnjrL/hBW5g6XQ&#43;4D9a1aAySZFfMYcVw==" />
  
  
  <script type="text/javascript" src="/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js"
    integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj&#43;e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script>
  
  
  
  
  
  
  
  
  
  
  
  <script defer type="text/javascript" id="script-bundle" src="/js/main.bundle.min.c178288131a2f1ad46910438db47ac5f7e1c48cf949e49f6dc3310c8ec9660e23fe505805eba4e2e73711335808500360d773a2b64322feb35df52856edca286.js"
    integrity="sha512-wXgogTGi8a1GkQQ420esX34cSM&#43;Unkn23DMQyOyWYOI/5QWAXrpOLnNxEzWAhQA2DXc6K2QyL&#43;s131KFbtyihg==" data-copy="" data-copied=""></script>
  
  
  
  <script src="/lib/zoom/zoom.min.37d2094687372da3f7343a221a470f6b8806f7891aa46a5a03966af7f0ebd38b9fe536cb154e6ad28f006d184b294525a7c4054b6bbb4be62d8b453b42db99bd.js" integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S&#43;Yti0U7QtuZvQ=="></script>
  
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="manifest" href="/site.webmanifest" />
  
  
  
  
  
  
  
  
  <meta property="og:url" content="http://localhost:1313/articles/2012/01/11/on-the-futility-of-extending-the-molfile-format/">
  <meta property="og:site_name" content="Depth-First">
  <meta property="og:title" content="On the (F)utility of Extending the Molfile Format">
  <meta property="og:description" content="MDL V2000 molfile format is the closest thing cheminformatics has to a universally-adopted standard. First publicly described in depth in 1991 and developed over the previous 13 years, the molfile format is read and written by nearly all software doing anything significant with organic chemical structures today.
Think about this for a moment - the lingua franca of cheminformatics predates Windows 3.0 and the World Wide Web. And it continues to be used as first described, with a few changes along the way.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2012-01-11T00:00:00+00:00">
    <meta property="article:modified_time" content="2012-01-11T00:00:00+00:00">

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="On the (F)utility of Extending the Molfile Format">
  <meta name="twitter:description" content="MDL V2000 molfile format is the closest thing cheminformatics has to a universally-adopted standard. First publicly described in depth in 1991 and developed over the previous 13 years, the molfile format is read and written by nearly all software doing anything significant with organic chemical structures today.
Think about this for a moment - the lingua franca of cheminformatics predates Windows 3.0 and the World Wide Web. And it continues to be used as first described, with a few changes along the way.">

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "On the (F)utility of Extending the Molfile Format",
    "headline": "On the (F)utility of Extending the Molfile Format",
    
    "abstract": "\u003cp\u003e\u003ca href=\u0022http:\/\/accelrys.com\/products\/informatics\/cheminformatics\/ctfile-formats\/no-fee.php\u0022 target=\u0022_blank\u0022\u003eMDL V2000 molfile format\u003c\/a\u003e is the closest thing cheminformatics has to a universally-adopted standard. First publicly \u003ca href=\u0022http:\/\/dx.doi.org\/10.1021\/ci00007a012\u0022 target=\u0022_blank\u0022\u003edescribed in depth in 1991\u003c\/a\u003e and developed over the previous 13 years, the molfile format is read and written by nearly all software doing anything significant with organic chemical structures today.\u003c\/p\u003e\n\u003cp\u003eThink about this for a moment - the lingua franca of cheminformatics predates Windows 3.0 and the World Wide Web. And it continues to be used as first described, with a few changes along the way.\u003c\/p\u003e",
    "inLanguage": "en-us",
    "url" : "http:\/\/localhost:1313\/articles\/2012\/01\/11\/on-the-futility-of-extending-the-molfile-format\/",
    "author" : {
      "@type": "Person",
      "name": ""
    },
    "copyrightYear": "2012",
    "dateCreated": "2012-01-11T00:00:00\u002b00:00",
    "datePublished": "2012-01-11T00:00:00\u002b00:00",
    
    "dateModified": "2012-01-11T00:00:00\u002b00:00",
    
    
    
    "mainEntityOfPage": "true",
    "wordCount": "2531"
  }]
  </script>


  
  
  
  
  

<script src="/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js" integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj&#43;KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script>






















  
  



  
  
  <meta name="theme-color"/>
  
  
</head>
<body
  class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
  <div id="the-top" class="absolute flex self-center">
    <a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
      href="#main-content"><span
        class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a>
  </div>
  
  
  <div style="padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px"
    class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3">
    
    <div class="flex flex-1 items-center justify-between">
        <nav class="flex space-x-3">

            
            <a href="/" class="text-base font-medium text-gray-500 hover:text-gray-900">Depth-First</a>
            

        </nav>
        <nav class="hidden md:flex items-center space-x-5 md:ml-12 h-12">

            

            


            
            <button id="search-button" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            


            
            
            <div
                class="ltr:mr-14 rtl:ml-14 flex items-center">
                <button id="appearance-switcher" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400">
                    <div class="flex items-center justify-center dark:hidden">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                    </div>
                    <div class="items-center justify-center hidden dark:flex">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                    </div>
                </button>
            </div>
            

        </nav>
        <div class="flex md:hidden items-center space-x-5 md:ml-12 h-12">

            <span></span>

            


            
            <button id="search-button-mobile" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            

            
            
            <button id="appearance-switcher-mobile" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400" style="margin-right:5px">
                <div class="flex items-center justify-center dark:hidden">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                </div>
                <div class="items-center justify-center hidden dark:flex">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                </div>
            </button>
            

        </div>
    </div>
    <div class="-my-2 -mr-2 md:hidden">

        <label id="menu-button" class="block">
            

            </div>
        </label>
    </div>
</div>





  
  <div class="relative flex flex-col grow">
    <main id="main-content" class="grow">
      


<article>
  

  <header id="single_header" class="mt-5 max-w-prose">
    
    <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
      On the (F)utility of Extending the Molfile Format
    </h1>
    <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
      





  
  







  





  



  













<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2012-01-11T00:00:00&#43;00:00">January 11, 2012</time><span class="px-2 text-primary-500">&middot;</span><span>2531 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">12 mins</span>
  

  
  
</div>








    </div>

    
    
    
    
    

    

    
      
      
        
        
<div class="flex author">
  
  <div class="place-self-center">
    
    
    <div class="text-2xl sm:text-lg">
</div>
  </div>
</div>

      

      

      
      <div class="mb-5"></div>
      

    

  </header>
  
  <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
    
    

      <div class="min-w-0 min-h-0 max-w-fit">
        
        


        <div class="article-content max-w-prose mb-20">
          <p><a href="http://accelrys.com/products/informatics/cheminformatics/ctfile-formats/no-fee.php" target="_blank">MDL V2000 molfile format</a> is the closest thing cheminformatics has to a universally-adopted standard. First publicly <a href="http://dx.doi.org/10.1021/ci00007a012" target="_blank">described in depth in 1991</a> and developed over the previous 13 years, the molfile format is read and written by nearly all software doing anything significant with organic chemical structures today.</p>
<p>Think about this for a moment - the lingua franca of cheminformatics predates Windows 3.0 and the World Wide Web. And it continues to be used as first described, with a few changes along the way.</p>
<p>Reliance on an old standard is not necessarily a bad thing. But when that standard&rsquo;s limitations hinder progress, it&rsquo;s time to look for alternatives. Has the time come to say &lsquo;goodbye&rsquo; to the trusty V2000 molfile format, or does it still have plenty of life left?</p>


<h1 class="relative group">V3000 
    <div id="v3000" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#v3000" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>A major limitation of V2000 is its hard cap on the number of atoms and bonds - 999. V2000 is a file format rooted in a bad idea long since abandoned, and made painfully obvious in the wake of Y2K - fixed-width fields. If your molecule contains more than 999 atoms or bonds you&rsquo;ll overflow the &lsquo;atom counts&rsquo; field, and you&rsquo;ll be unable to specify a bond to the higher-numbered atoms.</p>
<p>Noting this and other problems, MDL (the originator of the V2000 spec) published a <a href="http://www.ccl.net/chemistry/resources/messages/2002/12/05.005-dir/index.html" target="_blank">next-generation format called V3000 in 1995</a>.</p>
<p>Over the course of the next fifteen years, V3000 went from merely being an option for large structures to the preferred format for encoding any structure, at least according to the molfile spec&rsquo;s authors. From the <a href="http://accelrys.com/products/informatics/cheminformatics/ctfile-formats/no-fee.php" target="_blank">most recent June 2010 update</a>:</p>
<blockquote>
<p>Current Symyx products support reading and writing of both V2000 and V3000 formats. These products continue to default to writing V2000 molfiles to maximize interoperability with third party applications. Future product versions might default to output of the preferred V3000 format.</p>
</blockquote>
<p>(Other changes were afoot as well: MDL was bought by Symyx, which was itself bought by Accelrys.)</p>
<p>Hard figures on the adoption of V3000 are difficult to come by. My sense in talking to others and reading the literature is that V3000 is being used internally by some large pharmaceutical companies - primarily for its ability to represent partially-defined stereochemistry.</p>
<p>However, when it comes to exchanging information between organizations, V2000 (in particular the V2000 Structure Data File) is the only game in town (SMILES files are a fallback, but that&rsquo;s a story for another time). For example, none of the <a href="/articles/2011/10/12/sixty-four-free-chemistry-databases/">Sixty-Four Free chemistry databases</a> offering bulk downloads provide a V3000 option. They all use V2000.</p>
<p>Looking at the advantages stated by Symyx itself for V3000 - it&rsquo;s not hard to see why most in cheminformatics see little to be gained by switching:</p>
<ul>
<li>&ldquo;Provides better support for new chemical properties or objects, and supports enhanced stereochemistry&rdquo; [Needed by a minority in cheminformatics, and practical only under well-designed validation protocols.]</li>
<li>&ldquo;Removes fixed field widths to support large structures. &hellip;&rdquo; [Cheminformatics has historically concerned itself with small molecules, so this has not been a major concern.]</li>
<li>&ldquo;Supports the use of templates in a template block, which is useful for representing large structures, such as biological molecules. &hellip;&rdquo; [This is where things get interesting - see below].</li>
<li>&ldquo;Uses free format and tagging of information for easier parsing.&rdquo; [Unfortunately, V3000 was introduced before XML, so parsing these tags actually requires a lot of work by comparison.]</li>
<li>&ldquo;Provides better backward compatibility through BEGIN/END blocks.&rdquo; [V3000 attempts to offer a nested file structure, but again without the convenience of tooling available from a modern file format. This means more work for developers, not less.]</li>
</ul>
<p>V3000 has so far failed to replace V2000 as an inter-organization exchange format. Furthermore, few software packages have fully implemented the V3000 spec (although the same could be argued for V2000 as well).</p>
<p>Is it possible that V3000, although solving some problems, didn&rsquo;t address enough of the right problems?</p>


<h1 class="relative group">Self-Contained Sequence Representation 
    <div id="self-contained-sequence-representation" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#self-contained-sequence-representation" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>The pharmaceutical industry&rsquo;s innovation problems are no secret. In looking for solutions, one avenue gaining some traction is biopolymer-based drugs such as <a href="http://pubs.acs.org/cen/coverstory/89/8922cover.html?featured=1" target="_blank">proteins</a>, carbohydrates, and polynucleotides.</p>
<p>This has led to a new problem in cheminformatics - the need to effectively deal with co-mingled small molecule and biopolymer structures in corporate registration systems.</p>
<p>The problem is that cheminformatics has traditionally been concerned with small molecules - those typically having fewer than 100 heavy atoms. But it&rsquo;s not uncommon for biopolymers to consist of structures of thousands of heavy atoms or more. The optimizations that work so well for encoding, displaying, editing, and algorithmically processing large collections of small molecules begin to break down when applied to these larger molecules.</p>
<p>Very recently, Accelrys published their solution to this problem, <a href="http://dx.doi.org/10.1021/ci2001988" target="_blank">Self-Contained Sequence Representation</a> (SCSR). Based on the V3000 molfile format, SCSR offers a common framework for encoding both small molecules and biopolymers. In a <a href="http://accelrys.com/products/pdf/challenges-representing-biopolymers.pdf" target="_blank">whitepaper</a> on this technology, Keith Taylor explains:</p>
<blockquote>
<p>The biochemistry industry needs a method of representation for large structures that is meaningful to biologists and chemists, reduces redundant information and enables structural features to be searched using a computer system.</p>
</blockquote>
<p>Remember those &ldquo;templates&rdquo; and &ldquo;template blocks&rdquo; touted as advantages for V3000 in the specification? This is where those data structures prove themselves.</p>
<p>In SCSR, atoms can define literal atomic species such as carbon or nitrogen. But atoms can also contain entire substructures, such as amino acid residues. Rather than repetitively encoding every atom in an alanine polypeptide residue, it&rsquo;s only necessary to give a pointer to a single instance of alanine encoded in the file - once per occurrence. This system saves considerable storage space, processing time, and leads to more more natural-looking depictions.</p>
<p>Chemically-modified residues and even polyvalent residues can both be handled using a consistent (if somewhat perplexing) notation system. Although focussed on biopolymers, this system could be adapted for use with any large molecule containing repeating subunits.</p>
<p><a href="http://dx.doi.org/10.1021/ci2001988" target="_blank">
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="/images/posts/scsr.png" alt="SCSR" />
      <figcaption>SCSR</figcaption>
    </figure>
</a></p>
<p>Points to note include:</p>
<ul>
<li>Self-Contained Sequence Representation is a V3000 extension only.</li>
<li>Although fully implemented in Accelrys products, adoption of SCSR by major software vendors remains an open question at this point.</li>
<li>SCSR is mainly a compression technology - it&rsquo;s possible to convert any V3000 SCSR file with complete fidelity into an expanded non-SCSR representation and vice versa.</li>
</ul>
<p>It will be interesting to see to what extent the drive to unify chemical and biological registration systems moves more organizations away from V2000 molfiles. Supporting two file formats does require overhead that most groups would rather avoid. On the other hand, the need to support V2000 as an interchange format (e.g., <a href="http://dx.doi.org/10.1021/ci200330x" target="_blank">chemical suppliers sending SD files to big pharmas</a>) will likely hinder this transition.</p>


<h1 class="relative group">V2000 Issues 
    <div id="v2000-issues" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#v2000-issues" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Anyone who has worked with V2000 molfiles in even a moderate-sized structure database has been hit at last once with one of the technology&rsquo;s most serious shortcomings - V2000 molfiles can&rsquo;t faithfully encode a large amount of interesting small molecule chemistry.</p>
<p>Over the course of a few years, I detailed some of these cases on Depth-First. Many of the structures that can&rsquo;t be represented at sufficient detail involve <a href="/articles/2009/03/27/a-comprehensive-guide-flexmol-a-modern-language-for-chemical-representation-part-2-real-world-problems/">multicenter bonding and axial chirality</a>. Molecules like <a href="/articles/2006/12/12/the-problem-with-ferrocene/">ferrocene</a> and <a href="/articles/2007/01/08/the-axial-chirality-problem/">binapthalene</a> are good representatives, but there are many others.</p>
<p>To be clear, these problems can be managed by applying ad-hoc fixes internally, but when it comes time for V2000 to play is star role as information exchange format, <a href="http://molmatinf.com/whynotmolsdf.html" target="_blank">things can get ugly</a>.</p>


<h1 class="relative group">Zero-Order Bonds and Explicit Hydrogen Count Extension to V2000 
    <div id="zero-order-bonds-and-explicit-hydrogen-count-extension-to-v2000" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#zero-order-bonds-and-explicit-hydrogen-count-extension-to-v2000" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Even simpler structures pose problems for V2000. Developing a solution by <a href="http://dx.doi.org/10.1021/ci200488k" target="_blank">extending V2000</a> was the focus of a recent paper by <a href="http://cheminf20.org/" target="_blank">Alex Clark</a>.</p>
<p>V2000 provides two conveniences that have no doubt contributed to the widespread adoption of the format: (1) all bonds must be single, double, or triple; and (2) assignment of hydrogens to heavy atoms is optional. However, these conveniences also lead directly to some troubling cases of mistaken molecular identity.</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="/images/posts/dimethyl-tin-tin-chloride.png" alt="Tin Chloride" />
      <figcaption>Tin Chloride</figcaption>
    </figure>
</p>
<p>Consider dimethyl tin and tin dichloride. The paper argues that file formats rooted in implicit hydrogen conventions make it impossible for software to determine how many hydrogens to assign to either species. It&rsquo;s implied that V2000 is such a format, and a proposed extension is detailed.</p>
<p>However, one of the lesser known features of the V2000 format is the atom <strong>valence</strong> field. In its typically terse way, the June 2010 release of CTfile Formats has this to say on the subject of the valence field:</p>
<blockquote>
<p>Shows number of bonds to this atom, including bonds to implied H&rsquo;s.</p>
</blockquote>
<p>Although sometimes considered a query-only feature, nothing in the V2000 specification supports this conclusion. On the contrary, V2000 defines another atom property called &ldquo;hydrogen count&rdquo; marked as &ldquo;[Query]&rdquo; (like bond topology and query bond types). The &ldquo;valence&rdquo; property is marked as &ldquo;[Generic]&rdquo; (like atom charge). Furthermore, V2000 supports an atom property in the properties block called &ldquo;Substitution Count&rdquo; that can be used with &ldquo;[Query]&rdquo; only and which does not override the atom &ldquo;valence&rdquo; property in the atom block (as other equivalent atom properties do). The terms &ldquo;[Query]&rdquo; and &ldquo;[Generic]&rdquo; are only ever defined in terms of the kinds of files that support them, so <a href="http://blueobelisk.shapado.com/questions/proper-mdl-molfile-atom-block-line-format" target="_blank">differences of opinion</a> on this point are to be expected.</p>
<p>Regardless, the V2000 format apparently already provides a mechanism to distinguish tin(II) and tin(IV) oxidation states in the two examples above. The solution would therefore be for software encoders to specify a valence of &ldquo;2&rdquo; for tin(II) species and a valence of &ldquo;4&rdquo; for tin(IV) species, and for software decoders to respect this convention.</p>
<p>The extent to which software vendors support the atom valence attribute is an interesting question. A quick look at the <a href="https://github.com/egonw/cdk" target="_blank">CDK GitHub repository</a> shows that <a href="https://github.com/egonw/cdk/blob/master/src/main/org/openscience/cdk/io/MDLV2000Reader.java" target="_blank">MDLV2000Reader</a> does in fact read the valence attribute, but this attribute is only assigned to instances of IPseudoAtom. The <a href="https://github.com/ghutchis/openbabel/" target="_blank">Open Babel GitHub repository</a> shows no indication that the atom valence property is either read or written at all (<a href="https://github.com/ghutchis/openbabel/blob/master/src/formats/mdlformat.cpp" target="_blank">mdlformat.cpp</a>).</p>
<p>This is a little odd. The two most widely-used open source cheminformatics toolkits both ignore a built-in solution to the problem of implicit hydrogen counts of di- and tetravelent tin in V2000 molfiles. (Full disclosure - my company&rsquo;s structure editor <a href="http://metamolecular.com/chemwriter/" target="_blank">ChemWriter</a> also ignores the valence atom attribute). It seems likely that more than a few commercial packages take the same approach. Now a recent paper proposes an extension that would at least in part replicate the functionality of the atom valence attribute.</p>
<p>Another problem described in Clark&rsquo;s paper is the limitation of bond orders to one, two or three. There is no zero bond order. Take for example, the cobalt complex below:</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="/images/posts/cobaltamine.png" alt="Cobaltamine" />
      <figcaption>Cobaltamine</figcaption>
    </figure>
</p>
<p>Cobalt is bonded to six amino groups, but in V2000 we&rsquo;re forced to give each bond a minimum order of 1. This leads to some strange conclusions. First, cobalt would have an implied formal charge of +9. Second, counting implicit hydrogens on each nitrogen atom (assuming we&rsquo;re not using the atom valence property) would lead to 2. We&rsquo;d mis-calculate the molecular mass by 6 AMU. The paper considers some alternative representations, but each suffers from limitations of its own.</p>
<p>The paper proposes an extension to V2000 to allow for zero-order bonds, enabling the following improved representation to be displayed and used for calculations:</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="/images/posts/zero-order-aminocobalt.png" alt="Aminocobalt" />
      <figcaption>Aminocobalt</figcaption>
    </figure>
</p>
<p>Although this solves the problem for certain classes of structure, it leaves others unsolved. For example, the zero-order bond representation of ferrocene below gives reasonably good calculations for formal charge, but it fails to capture the symmetry of the molecule, assigning significance to the two C-Fe bonds labeled as single where no significance is warranted and implying different bond types in each cyclopentyl ring, among other issues.</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="/images/posts/ferrocene-zero-order.png" alt="Ferrocene Zero Order" />
      <figcaption>Ferrocene Zero Order</figcaption>
    </figure>
</p>
<p>Finally, it&rsquo;s ironic that the proposed extensions apply to the much older V2000 format (the originator of which now claims will not be extended further). No mention is even made of the newer V3000 format that Accelrys says will be the basis of all future extensions.</p>


<h1 class="relative group">Multiplication of Errors 
    <div id="multiplication-of-errors" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#multiplication-of-errors" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>V2000 is based on a very limited chemistry model, and this is the root cause of most of the problems cited by critics.</p>
<p>One of the most egregious errors is in the elevation of side-effects - atomic charge and bond order - to the status of fundamental atomic and bonding properties.</p>
<p>Ask any knowledgeable chemists how to calculate atomic formal charge and they&rsquo;ll do so by counting valence electrons. Valence electron count is the property any robust chemical interchange format should be capturing, not formal charge. Formal charge is the side-effect of a well-defined electron count. In case you missed that, let me re-state it:</p>
<p><strong>Any chemical file format (or in-memory representation) that relies on charge as a fundamental atomic property is doomed to the same problems as V2000.</strong></p>
<p>Bond order calculations, like formal charge calculations, are made by counting electrons. As a result, bond order is a very limiting property to choose as a basis for a chemical representation system. Bond order is derived from electron count, not the other way around. In other words:</p>
<p><strong>Any chemical file format (or in-memory representation) that relies on bond order as a fundamental bond property is doomed to the same problems as V2000.</strong></p>
<p>My concern is that attempts to extend the V2000 format by adding new templates (e.g., zero-order bond, and not to be confused with &ldquo;templates&rdquo; discussed above) will alleviate only part of the problem, but leave the rest festering. The problem with V2000 is not the lack of templates (e.g., no zero-order bond), but the use of templates like bond types in the first place.</p>
<p>Templates can also be found in stereochemical definitions, both in V2000 and elsewhere. All of the problems encountered with using V2000 to represent, for example axial chirality, can be traced to the reliance on templates.</p>
<p>Clark offers the following tongue-in-cheek witticism:</p>
<blockquote>
<p>cheminformaticians do not know what molecule file format they will be using in 20 years, but they know it will be called MDL Molfile.</p>
</blockquote>
<p>I would counter with:</p>
<blockquote>
<p>cheminformaticians do not know what molecule file format will overcome the limitations of MDL Molfile, but they know it won&rsquo;t be based on templates.</p>
</blockquote>


<h1 class="relative group">Conclusions 
    <div id="conclusions" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#conclusions" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>No amount of retrofitting will solve the fundamental flaws of V2000 as a chemical representation and information exchange format. They are:</p>
<ol>
<li>Optional specification of implicit hydrogen counts.</li>
<li>Encoding the side effect properties of charge and bond order, rather than the fundamental property of electron count.</li>
<li>Elevation of bonding and stereochemistry templates to the status of fundamental properties.</li>
<li>Deeply-ingrained and restrictive notions of bonding that precludes multi-center bonds or bonds with odd electron counts.</li>
<li>Decades of inertia on the part of software providers and the cheminformatics community.</li>
</ol>
<p>V3000 offers some true innovations in the areas of partial stereochemistry definition and biopolymer encoding that are worth understanding. However, at its core V3000 relies on the same basic (flawed) model of chemistry as V2000.</p>
<p>It&rsquo;s tempting to continue ignoring molecular corner cases as they accumulate. After all, if the only structures a cheminformatics system sees are small organic molecules, V2000 works nearly flawlessly. And if this is the only kind of molecule chemists continue to make, there really is no problem to solve.</p>
<p>But I&rsquo;m optimistic about the future of chemical research and the creativity of chemists. It&rsquo;s time to retire both V2000 and V3000 molfile formats so that we in cheminformatics can stop making excuses and start keeping pace with advances in chemistry.</p>

          
          
          
        </div>
        
        

        
        

          
      </div>
     
      
      
        
        
          
          
        
      <script>
        var oid = "views_posts\/2012-01-11-on-the-futility-of-extending-the-molfile-format.md"
        var oid_likes = "likes_posts\/2012-01-11-on-the-futility-of-extending-the-molfile-format.md"
      </script>
      
      
      <script type="text/javascript" src="/js/page.min.0860cf4e04fa2d72cc33ddba263083464d48f67de06114529043cb4623319efed4f484fd7f1730df5abea0e2da6f3538855634081d02f2d6e920b956f063e823.js" integrity="sha512-CGDPTgT6LXLMM926JjCDRk1I9n3gYRRSkEPLRiMxnv7U9IT9fxcw31q&#43;oOLabzU4hVY0CB0C8tbpILlW8GPoIw=="></script>
      
  
    </section>
  <footer class="pt-8 max-w-prose print:hidden">

    
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group mr-3" href="/articles/2011/12/15/ibm-donates-large-collection-of-patent-chemical-structures-to-nih/pubchem/">
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >IBM Donates Large Collection of Patent Chemical Structures to NIH/PubChem</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2011-12-15T00:00:00&#43;00:00">December 15, 2011</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="flex text-right group ml-3" href="/articles/2012/01/18/digital-destruction-in-scientific-publishing-why-this-scientist-supports-the-research-works-act-hr-3699/">
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Digital Destruction in Scientific Publishing: Why This Scientist Supports the Research Works Act (HR 3699)</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2012-01-18T00:00:00&#43;00:00">January 18, 2012</time>
                  
                </span>
              </span>
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


    
  </footer>
</article>

      <div id="top-scroller" class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0">
  <a href="#the-top"
    class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top" title="Scroll to top">
    &uarr;
  </a>
</div>
    </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
  
  <div class="flex items-center justify-between">

    
    
    <p class="text-sm text-neutral-500 dark:text-neutral-400">
      &copy;
      2024
      
    </p>
    

    
    
    <p class="text-xs text-neutral-500 dark:text-neutral-400">
      
      
      Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a>
    </p>
    

  </div>
  <script>
    
    mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
      margin: 24,
      background: 'rgba(0,0,0,0.5)',
      scrollOffset: 0,
    })
    
  </script>
  
  
  <script type="text/javascript" src="/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js" integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]"
  data-url="http://localhost:1313/"
  style="z-index:500"
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)"
      >
        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

  </div>
</body>

</html>
