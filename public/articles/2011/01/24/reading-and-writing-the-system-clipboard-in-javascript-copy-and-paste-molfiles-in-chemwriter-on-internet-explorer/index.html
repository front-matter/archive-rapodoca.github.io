<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Reading and Writing the System Clipboard in JavaScript: Copy and Paste Molfiles in ChemWriter on Internet Explorer | Depth-First</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="Integrating the system clipboard with Web applications is no easy feat. For good reason, most browsers make it nearly impossible for client-side JavaScript to arbitrarily read and write the system clipboard. But as with all things relating to browsers, behavior does vary. This article describes how copy and paste between ChemWriter (my company&rsquo;s pure JavaScript chemical structure editor) and the Windows system clipboard was enabled in Internet Explorer (IE).
A Singular Innovation
Although not widely known, IE versions 6, 7, and 8 support read and write access to plain text data stored on the system clipboard from arbitrary JavaScript code. Whether you see this as a security hole or not depends on what you&rsquo;re trying to do. Different versions of IE support various levels of control over this behavior:">
    <meta name="generator" content="Hugo 0.139.4">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    

    
      

    

    

    
      <link rel="canonical" href="http://localhost:1313/articles/2011/01/24/reading-and-writing-the-system-clipboard-in-javascript-copy-and-paste-molfiles-in-chemwriter-on-internet-explorer/">
    

    <meta property="og:url" content="http://localhost:1313/articles/2011/01/24/reading-and-writing-the-system-clipboard-in-javascript-copy-and-paste-molfiles-in-chemwriter-on-internet-explorer/">
  <meta property="og:site_name" content="Depth-First">
  <meta property="og:title" content="Reading and Writing the System Clipboard in JavaScript: Copy and Paste Molfiles in ChemWriter on Internet Explorer">
  <meta property="og:description" content="Integrating the system clipboard with Web applications is no easy feat. For good reason, most browsers make it nearly impossible for client-side JavaScript to arbitrarily read and write the system clipboard. But as with all things relating to browsers, behavior does vary. This article describes how copy and paste between ChemWriter (my company’s pure JavaScript chemical structure editor) and the Windows system clipboard was enabled in Internet Explorer (IE).
A Singular Innovation Although not widely known, IE versions 6, 7, and 8 support read and write access to plain text data stored on the system clipboard from arbitrary JavaScript code. Whether you see this as a security hole or not depends on what you’re trying to do. Different versions of IE support various levels of control over this behavior:">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="articles">
    <meta property="article:published_time" content="2011-01-24T00:00:00+00:00">
    <meta property="article:modified_time" content="2011-01-24T00:00:00+00:00">

  <meta itemprop="name" content="Reading and Writing the System Clipboard in JavaScript: Copy and Paste Molfiles in ChemWriter on Internet Explorer">
  <meta itemprop="description" content="Integrating the system clipboard with Web applications is no easy feat. For good reason, most browsers make it nearly impossible for client-side JavaScript to arbitrarily read and write the system clipboard. But as with all things relating to browsers, behavior does vary. This article describes how copy and paste between ChemWriter (my company’s pure JavaScript chemical structure editor) and the Windows system clipboard was enabled in Internet Explorer (IE).
A Singular Innovation Although not widely known, IE versions 6, 7, and 8 support read and write access to plain text data stored on the system clipboard from arbitrary JavaScript code. Whether you see this as a security hole or not depends on what you’re trying to do. Different versions of IE support various levels of control over this behavior:">
  <meta itemprop="datePublished" content="2011-01-24T00:00:00+00:00">
  <meta itemprop="dateModified" content="2011-01-24T00:00:00+00:00">
  <meta itemprop="wordCount" content="624">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Reading and Writing the System Clipboard in JavaScript: Copy and Paste Molfiles in ChemWriter on Internet Explorer">
  <meta name="twitter:description" content="Integrating the system clipboard with Web applications is no easy feat. For good reason, most browsers make it nearly impossible for client-side JavaScript to arbitrarily read and write the system clipboard. But as with all things relating to browsers, behavior does vary. This article describes how copy and paste between ChemWriter (my company’s pure JavaScript chemical structure editor) and the Windows system clipboard was enabled in Internet Explorer (IE).
A Singular Innovation Although not widely known, IE versions 6, 7, and 8 support read and write access to plain text data stored on the system clipboard from arbitrary JavaScript code. Whether you see this as a security hole or not depends on what you’re trying to do. Different versions of IE support various levels of control over this behavior:">

	
  </head><body class="ma0 avenir bg-near-white development">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Depth-First
      
    </a>
    <div class="flex-l items-center">
      

      
      <div class="ananke-socials"></div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Articles
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1">Reading and Writing the System Clipboard in JavaScript: Copy and Paste Molfiles in ChemWriter on Internet Explorer</h1>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2011-01-24T00:00:00Z">January 24, 2011</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>Integrating the system clipboard with Web applications is no easy feat. For good reason, most browsers make it nearly impossible for client-side JavaScript to arbitrarily read and write the system clipboard. But as with all things relating to browsers, behavior does vary. This article describes how copy and paste between <a href="http;//chemwriter.com">ChemWriter</a> (my company&rsquo;s pure JavaScript chemical structure editor) and the Windows system clipboard was enabled in Internet Explorer (IE).</p>
<h1 id="a-singular-innovation">A Singular Innovation</h1>
<p>Although not widely known, <a href="http://msdn.microsoft.com/en-us/library/ms535220(v=vs.85).aspx">IE versions 6, 7, and 8 support read and write access to plain text data stored on the system clipboard from arbitrary JavaScript code</a>. Whether you see this as a <a href="http://www.zdnetasia.com/users-warned-over-ie-clipboard-exploit-39105357.htm">security hole</a> or not depends on what you&rsquo;re trying to do. Different versions of IE support various levels of control over this behavior:</p>
<ol>
<li><strong>Enable</strong> Allow any JavaScript to read and write the system clipboard without notifying the user.</li>
<li><strong>Prompt</strong> Allow any JavaScript to read and write the system clipboard, presenting a cancelable dialog first.</li>
<li><strong>Disable</strong> Never allow access to the system clipboard from JavaScript.</li>
</ol>
<p>These settings can be applied to security zones, like the other IE security settings.</p>
<p>Out of security concerns, no other browser vendor supports programmatic JavaScript clipboard access out of the box. There have been numerous <a href="http://almaer.com/blog/supporting-the-system-clipboard-in-your-web-applications-what-a-pain">legitimate, white-hat attempts to get around this situation</a>, an indication that this feature is in high demand from many sectors of Web development.</p>
<h1 id="how-it-works">How It Works</h1>
<p>We wanted a simple way for chemists copy and paste <a href="/articles/2010/06/28/latest-ctfile-formats-specification-available-now-from-symyx/">molfiles</a> (a text-based file format) to/from their system clipboards and a ChemWriter instance deployed in a Web page. This is currently supported through separate text area import dialogs, but we wanted to offer something more streamlined. We also wanted a solution that would enable chemists to use the familiar ctrl-c and ctrl-v keyboard shortcuts in an intuitive way.</p>
<p>Visiting the <a href="http://chemwriter.com">chemwriter.com homepage</a>, you&rsquo;ll see an example of this new feature in action. Place a molfile onto your system clipboard and either press ctrl-v or use the &lsquo;Import Molfile&rsquo; button at the bottom of the editor.</p>
<p>Depending on your security settings, you&rsquo;ll see one of three behaviors:</p>
<ul>
<li><strong>Enable</strong> An interactive, graphical representation of your molfile will appear in the editor window.</li>
<li><strong>Prompt</strong> A consent dialog will appear, asking permission to access the clipboard:</li>
</ul>
<p><img src="/images/posts/chemwriter_clipboard_prompt.png" alt="ChemWriter Clipboard Prompt" title="ChemWriter Clipboard Prompt"></p>
<ul>
<li><strong>Disable</strong> If your clipboard access setting is &lsquo;Disable&rsquo;, or you refuse access to your clipboard from the dialog, the editor falls back to presenting the default import molfile dialog, from which you can paste the molfile and then dismiss the dialog.</li>
</ul>
<p>It should be emphasized that the consent dialog only appears at the moment a script attempts to access the system clipboard.</p>
<p>You can test clipboard access on IE in your own scripts (or interactively with the &lsquo;Developer Tools&rsquo; console). To read the clipboard:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> window.<span style="color:#a6e22e">clipboardData</span>.<span style="color:#a6e22e">getData</span>(<span style="color:#e6db74">&#39;Text&#39;</span>);
</span></span></code></pre></div><p>To write the clipboard:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span>window.<span style="color:#a6e22e">clipboardData</span>.<span style="color:#a6e22e">setData</span>(<span style="color:#e6db74">&#39;Text&#39;</span>, <span style="color:#e6db74">&#39;this is a test&#39;</span>);
</span></span></code></pre></div><h1 id="ie-quirks">IE Quirks</h1>
<p>As might be expected, the user experience for this feature varies according to the version of IE being used. Given a setting of &lsquo;Prompt&rsquo; for clipboard access, here&rsquo;s a summary of what we&rsquo;ve found:</p>
<ul>
<li><strong>IE6</strong> Always prompts with dialog for clipboard access.</li>
<li><strong>IE7</strong> Prompts with dialog on first clipboard access. All other accesses on the same page without intervening page jumps proceed without consent dialog. Loading another page and then re-visiting the original presents a new consent dialog.</li>
<li><strong>IE8</strong> Same as IE7.</li>
</ul>
<h1 id="conclusions">Conclusions</h1>
<p>Integration with the system clipboard is one of the most difficult things to achieve in current Web development. We&rsquo;ve used the capability offered by Internet Explorer as one solution that, we think, may offer a good tradeoff between convenience and security in some situations.</p>
<p>Are there other, better ways to enable well-integrated system clipboard access in client-side JavaScript? Yes, I think so. But that&rsquo;s a story for another time.</p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://localhost:1313/" >
    &copy;  Depth-First 2024 
  </a>
    <div><div class="ananke-socials"></div>
</div>
  </div>
</footer>

  </body>
</html>
