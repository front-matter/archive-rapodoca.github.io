<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>A Simple Vector Graphics API for Chemical Structure Output Part 1 - In Search of a Simplifying Approach for ChemPhoto | Depth-First</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="One of the main design goals of ChemPhoto, the chemical structure imaging application, was to support all Web-relevant image output formats, both vector-based and pixel-based. Like most things in software development, there are far more approaches that add complexity to this problem than there are approaches that remove it. And for some reason, the complexity-reducing methods tend to be the last to be considered. This article, the first in a series, will discuss how ChemPhoto simplifies the problem of supporting multiple chemical structure image output formats from a common representation.">
    <meta name="generator" content="Hugo 0.139.4">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    

    
      

    

    

    
      <link rel="canonical" href="http://localhost:1313/articles/2008/10/a-simple-vector-graphics-api-for-chemical-structure-output-part-1-in-search-of-a-simplifying-approach-for-chemphoto/">
    

    <meta property="og:url" content="http://localhost:1313/articles/2008/10/a-simple-vector-graphics-api-for-chemical-structure-output-part-1-in-search-of-a-simplifying-approach-for-chemphoto/">
  <meta property="og:site_name" content="Depth-First">
  <meta property="og:title" content="A Simple Vector Graphics API for Chemical Structure Output Part 1 - In Search of a Simplifying Approach for ChemPhoto">
  <meta property="og:description" content="One of the main design goals of ChemPhoto, the chemical structure imaging application, was to support all Web-relevant image output formats, both vector-based and pixel-based. Like most things in software development, there are far more approaches that add complexity to this problem than there are approaches that remove it. And for some reason, the complexity-reducing methods tend to be the last to be considered. This article, the first in a series, will discuss how ChemPhoto simplifies the problem of supporting multiple chemical structure image output formats from a common representation.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="articles">
    <meta property="article:published_time" content="2008-10-31T00:00:00+00:00">
    <meta property="article:modified_time" content="2008-10-31T00:00:00+00:00">

  <meta itemprop="name" content="A Simple Vector Graphics API for Chemical Structure Output Part 1 - In Search of a Simplifying Approach for ChemPhoto">
  <meta itemprop="description" content="One of the main design goals of ChemPhoto, the chemical structure imaging application, was to support all Web-relevant image output formats, both vector-based and pixel-based. Like most things in software development, there are far more approaches that add complexity to this problem than there are approaches that remove it. And for some reason, the complexity-reducing methods tend to be the last to be considered. This article, the first in a series, will discuss how ChemPhoto simplifies the problem of supporting multiple chemical structure image output formats from a common representation.">
  <meta itemprop="datePublished" content="2008-10-31T00:00:00+00:00">
  <meta itemprop="dateModified" content="2008-10-31T00:00:00+00:00">
  <meta itemprop="wordCount" content="715">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="A Simple Vector Graphics API for Chemical Structure Output Part 1 - In Search of a Simplifying Approach for ChemPhoto">
  <meta name="twitter:description" content="One of the main design goals of ChemPhoto, the chemical structure imaging application, was to support all Web-relevant image output formats, both vector-based and pixel-based. Like most things in software development, there are far more approaches that add complexity to this problem than there are approaches that remove it. And for some reason, the complexity-reducing methods tend to be the last to be considered. This article, the first in a series, will discuss how ChemPhoto simplifies the problem of supporting multiple chemical structure image output formats from a common representation.">

	
  </head><body class="ma0 avenir bg-near-white development">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Depth-First
      
    </a>
    <div class="flex-l items-center">
      

      
      <div class="ananke-socials"></div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Articles
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1">A Simple Vector Graphics API for Chemical Structure Output Part 1 - In Search of a Simplifying Approach for ChemPhoto</h1>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2008-10-31T00:00:00Z">October 31, 2008</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>One of the main design goals of <a href="http://metamolecular.com/chemphoto">ChemPhoto</a>, the <a href="/articles/2008/09/08/smarter-cheminformatics-from-sd-file-to-image-collection-with-chemphoto">chemical structure imaging application</a>, was to support all Web-relevant image output formats, both vector-based and pixel-based. Like most things in software development, there are far more approaches that add complexity to this problem than there are approaches that remove it. And for some reason, the complexity-reducing methods tend to be the last to be considered. This article, the first in a series, will discuss how ChemPhoto simplifies the problem of supporting multiple chemical structure image output formats from a common representation.</p>
<h1 id="the-problem-in-a-nutshell">The Problem in a Nutshell</h1>
<p>ChemPhoto uses an internal representation of molecular structure based closely on the industry-standard <a href="http://www.mdl.com/downloads/public/ctfile/ctfile.pdf">MDL molfile format</a>. Given this representation, ChemPhoto needs to be able to write a variety of vector- and raster-based image formats. Raster formats are fortunately limited to PNG and JPG, which are supported directly by the standard Java library.</p>
<p>Vector formats, on the other hand are more diverse and less accessible. Currently, ChemPhoto supports Scalable Vector Graphics (SVG) and Encapsulated PostScript (EPS). Complete support for Adobe Flash (SWF) output is expected soon. Proof of concept for Microsoft&rsquo;s Vector Markup Language (VML) <a href="/articles/2008/07/22/vector-markup-language-for-cheminformatics">has already been demonstrated</a>. Support for Adobe Acrobat format, through the <a href="http://www.lowagie.com/iText/">iText library</a> is anticipated. Last but not least is Java2D itself for use in Swing components such as <a href="http://metamolecular.com/chemwriter">renderers and editors</a>.</p>
<p>Clearly, supporting all of these formats requires rendering code that is minimally coupled to the underlying display system. But how to do this in practice?</p>
<h1 id="the-batik-approach-extend-graphics2d">The Batik Approach: Extend Graphics2D</h1>
<p><a href="http://xmlgraphics.apache.org/batik/">Batik</a> is a widely-used library for creating and processing SVG in Java. At its core is the <a href="http://xmlgraphics.apache.org/batik/using/svg-generator.html">SVGGraphics2D class</a> which extends <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/awt/Graphics2D.html">Graphics2D</a>, overriding many of its methods in the process. The idea seems simple enough - create your drawing code using the Java2D API like you normally would. When you want to generate SVG, just pass an instance of <!-- raw HTML omitted -->SVGGraphics2D<!-- raw HTML omitted --> and then read out the SVG document using <!-- raw HTML omitted -->stream<!-- raw HTML omitted --> method.</p>
<p>The problem with this approach is that every new image output format to be supported needs to extend Graphics2D and essentially re-implement most of its methods. Graphics2D is a large and complex class with many associated helper classes. Just knowing when you&rsquo;ve completely covered the API is a major challenge, aside from the even bigger challenge of implementing the overridden methods.</p>
<p>Fine, you might say, given that so many SVG interconverters exist, why not just use SVG (created by Batik) as the universal interconversion format and get a third-party-library to convert SVG into other vector formats?</p>
<p>This approach is appealing in principle, but fails in practice. Many SVG implementations are partial at best - and many lack the documentation that would warn that a problem might exist with the exact form of SVG you&rsquo;re using. For example, in an early iteration of ChemPhoto, Batik was used to create SVG from some representative chemical structures. Unfortunately, the way Batik represented path data was not fully interpreted by any of the SVG-&gt;SWF converters that were examined. The result was bumpy instead of smooth curves for atom labels, and other unacceptable abnormalities.</p>
<p>Finally, after spending some time reading J. David Eisenberg&rsquo;s <a href="http://oreilly.com/catalog/9780596002237/toc.html">excellent book about SVG</a>, it became clear that for drawing 2D chemical structures and even reactions and reaction schemes, only a fraction of the SVG specification was relevant.</p>
<p>In this case, Batik, and its approach of extending Graphics2D was simply overkill that made the problem more complex than it needed to be.</p>
<h1 id="a-better-approach-create-a-custom-vector-graphics-interface">A Better Approach: Create a Custom Vector Graphics Interface</h1>
<p>Batik has the right idea: isolate drawing code from the specific format being generated. The problem is that the Graphics2D class wasn&rsquo;t really designed for this purpose. For one thing, it&rsquo;s a concrete class that inherits from another concrete class. And as mentioned before, Graphics2D a very complex class with many dependencies.</p>
<p>How can we create a simple vector graphics API tailored to chemical structure image creation, which is easily re-implemented, and which works with the existing Java2D API?</p>
<p>Part 2 of this series will describe one approach.</p>
<h1 id="conclusions">Conclusions</h1>
<p>Creating the ChemPhoto rendering engine has been an evolutionary process. It started with the idea of directly using the Graphics2D class in rendering code, but has since moved on to the definition of a vector graphics abstraction layer to simplify the addition of new image formats.</p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://localhost:1313/" >
    &copy;  Depth-First 2024 
  </a>
    <div><div class="ananke-socials"></div>
</div>
  </div>
</footer>

  </body>
</html>
