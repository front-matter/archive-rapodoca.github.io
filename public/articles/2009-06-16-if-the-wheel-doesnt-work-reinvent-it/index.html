<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>If the Wheel Doesn&#39;t Work, Reinvent it | Depth-First</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="Chris Steinbeck has an interesting post on the CDK code review process that discusses a new VF implementation. In it, he notes:

I checked it out and looked at the code, which looked horrible because it was a 1:1 translation of a horrible looking C code. Clearly,  a decent naming of the variables would greatly improve the code but I remember a statement that the translator himself could not make sense out of this, so the original author is to blame :-) . I do not get the impression that this problem can be rectified quickly. In fact, it took Mark a few days to debug this code by adding a rich collection of debug messages. I’m not sure that this is how it should be. The code is essentially unreadable.">
    <meta name="generator" content="Hugo 0.139.4">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    

    
      

    

    

    
      <link rel="canonical" href="http://localhost:1313/articles/2009-06-16-if-the-wheel-doesnt-work-reinvent-it/">
    

    <meta property="og:url" content="http://localhost:1313/articles/2009-06-16-if-the-wheel-doesnt-work-reinvent-it/">
  <meta property="og:site_name" content="Depth-First">
  <meta property="og:title" content="If the Wheel Doesn&#39;t Work, Reinvent it">
  <meta property="og:description" content="Chris Steinbeck has an interesting post on the CDK code review process that discusses a new VF implementation. In it, he notes:
I checked it out and looked at the code, which looked horrible because it was a 1:1 translation of a horrible looking C code. Clearly, a decent naming of the variables would greatly improve the code but I remember a statement that the translator himself could not make sense out of this, so the original author is to blame :-) . I do not get the impression that this problem can be rectified quickly. In fact, it took Mark a few days to debug this code by adding a rich collection of debug messages. I’m not sure that this is how it should be. The code is essentially unreadable.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="articles">
    <meta property="article:published_time" content="2009-06-16T00:00:00+00:00">
    <meta property="article:modified_time" content="2009-06-16T00:00:00+00:00">

  <meta itemprop="name" content="If the Wheel Doesn&#39;t Work, Reinvent it">
  <meta itemprop="description" content="Chris Steinbeck has an interesting post on the CDK code review process that discusses a new VF implementation. In it, he notes:
I checked it out and looked at the code, which looked horrible because it was a 1:1 translation of a horrible looking C code. Clearly, a decent naming of the variables would greatly improve the code but I remember a statement that the translator himself could not make sense out of this, so the original author is to blame :-) . I do not get the impression that this problem can be rectified quickly. In fact, it took Mark a few days to debug this code by adding a rich collection of debug messages. I’m not sure that this is how it should be. The code is essentially unreadable.">
  <meta itemprop="datePublished" content="2009-06-16T00:00:00+00:00">
  <meta itemprop="dateModified" content="2009-06-16T00:00:00+00:00">
  <meta itemprop="wordCount" content="399">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="If the Wheel Doesn&#39;t Work, Reinvent it">
  <meta name="twitter:description" content="Chris Steinbeck has an interesting post on the CDK code review process that discusses a new VF implementation. In it, he notes:
I checked it out and looked at the code, which looked horrible because it was a 1:1 translation of a horrible looking C code. Clearly, a decent naming of the variables would greatly improve the code but I remember a statement that the translator himself could not make sense out of this, so the original author is to blame :-) . I do not get the impression that this problem can be rectified quickly. In fact, it took Mark a few days to debug this code by adding a rich collection of debug messages. I’m not sure that this is how it should be. The code is essentially unreadable.">

	
  </head><body class="ma0 avenir bg-near-white development">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Depth-First
      
    </a>
    <div class="flex-l items-center">
      

      
      <div class="ananke-socials"></div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Articles
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1">If the Wheel Doesn&#39;t Work, Reinvent it</h1>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2009-06-16T00:00:00Z">June 16, 2009</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p><a href="http://www.steinbeck-molecular.de/steinblog">Chris Steinbeck</a> has an interesting post on the <a href="http://www.steinbeck-molecular.de/steinblog/index.php/2009/06/16/reviewing-the-cdk-vflib-patch/">CDK code review process that discusses a new VF implementation</a>. In it, he notes:</p>
<blockquote>
<p>I checked it out and looked at the code, which looked horrible because it was a 1:1 translation of a horrible looking C code. Clearly,  a decent naming of the variables would greatly improve the code but I remember a statement that the translator himself could not make sense out of this, so the original author is to blame :-) . I do not get the impression that this problem can be rectified quickly. In fact, it took Mark a few days to debug this code by adding a rich collection of debug messages. I’m not sure that this is how it should be. The code is essentially unreadable.</p>
</blockquote>
<p>For the unfamiliar, VF is a subgraph matching algorithm that has been shown to <a href="amalfi.dis.unina.it/people/vento/lavori/gbr01bm.pdf">perform better</a> than <a href="http://doi.acm.org/10.1145/321921.321925">Ullmann</a> for small graphs, and much better than Ullmann for large graphs.</p>
<p>Faced with essentially the same problem of implementing VF in Java for <a href="http://metamolecular.com/mx">MX</a>, I abandoned my early efforts to port the <a href="http://amalfi.dis.unina.it/graph/db/vflib-2.0/doc/vflib.html">VFlib C++ implementation</a>. The C++ implementation may make sense to a C++ programmer, but directly porting it to Java was judged as not being a good long-term move.</p>
<p>The problem was maintenance.</p>
<p>Although opinions on the subject vary, maintainable Java code to me has a few easily-identifiable characteristics. Among them are:</p>
<ol>
<li>Descriptive variable and method names.</li>
<li>Limited use of deep nesting (&gt; 3 levels) within methods.</li>
<li>Stateful objects.</li>
<li>Use of collections over primitives.</li>
<li>Few methods over ten lines long.</li>
</ol>
<p>The VF Java port that I created failed on just about every count - and failed consistently.</p>
<p>It turned out that <a href="amalfi.dis.unina.it/graph/db/papers/vf-algorithm.pdf">a short description of the VF algorithm</a> was remarkably clear, lending itself well to a <a href="/articles/2008/11/17/substructure-search-from-scratch-in-java-part-1-the-atom-mapping-problem">Java-centric, object-oriented implementation</a> that was <a href="/articles/2008/11/21/introducing-mx-lightweight-and-free-cheminformatics-tools-for-java">successfully integrated into MX</a>.</p>
<p>As a bonus, because test-driven development was used from the start for the MX implementation of VF, not only is the code maintainable, but it can be refactored and recasted with higher confidence due to the tests that are now present. This was used to great effect during a recent large-scale refactoring of the MX code to support arbitrary Query Atoms.</p>
<p>Would you consider bolting a bicycle wheel onto your new Kawasaki? Of course not. Why do the same with your software?</p>
<p>Reuse whenever it&rsquo;s consistent with your goals. When it&rsquo;s not, then reinvent.</p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://localhost:1313/" >
    &copy;  Depth-First 2024 
  </a>
    <div><div class="ananke-socials"></div>
</div>
  </div>
</footer>

  </body>
</html>
