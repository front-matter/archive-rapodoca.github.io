<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>From SMILES to InChI with OBRuby | Depth-First</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="SMILES and InChI are two commonly-used molecular line notations. Although each has its advantages and limitations, the novelty of InChI and the ubiquity of SMILES makes the SMILES to InChI conversion especially useful. Many of the situations in which the need for this conversion will arise are particularly well-suited for the Ruby programming language. A recent article described how RCDK and Rino could be used to accomplish this conversion. This article will show how Open Babel can be used from Ruby to effect the same conversion.">
    <meta name="generator" content="Hugo 0.139.4">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    

    
      

    

    

    
      <link rel="canonical" href="http://localhost:1313/articles/2006-11-03-from-smiles-to-inchi-with-obruby/">
    

    <meta property="og:url" content="http://localhost:1313/articles/2006-11-03-from-smiles-to-inchi-with-obruby/">
  <meta property="og:site_name" content="Depth-First">
  <meta property="og:title" content="From SMILES to InChI with OBRuby">
  <meta property="og:description" content="SMILES and InChI are two commonly-used molecular line notations. Although each has its advantages and limitations, the novelty of InChI and the ubiquity of SMILES makes the SMILES to InChI conversion especially useful. Many of the situations in which the need for this conversion will arise are particularly well-suited for the Ruby programming language. A recent article described how RCDK and Rino could be used to accomplish this conversion. This article will show how Open Babel can be used from Ruby to effect the same conversion.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="articles">
    <meta property="article:published_time" content="2006-11-03T00:00:00+00:00">
    <meta property="article:modified_time" content="2006-11-03T00:00:00+00:00">

  <meta itemprop="name" content="From SMILES to InChI with OBRuby">
  <meta itemprop="description" content="SMILES and InChI are two commonly-used molecular line notations. Although each has its advantages and limitations, the novelty of InChI and the ubiquity of SMILES makes the SMILES to InChI conversion especially useful. Many of the situations in which the need for this conversion will arise are particularly well-suited for the Ruby programming language. A recent article described how RCDK and Rino could be used to accomplish this conversion. This article will show how Open Babel can be used from Ruby to effect the same conversion.">
  <meta itemprop="datePublished" content="2006-11-03T00:00:00+00:00">
  <meta itemprop="dateModified" content="2006-11-03T00:00:00+00:00">
  <meta itemprop="wordCount" content="449">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="From SMILES to InChI with OBRuby">
  <meta name="twitter:description" content="SMILES and InChI are two commonly-used molecular line notations. Although each has its advantages and limitations, the novelty of InChI and the ubiquity of SMILES makes the SMILES to InChI conversion especially useful. Many of the situations in which the need for this conversion will arise are particularly well-suited for the Ruby programming language. A recent article described how RCDK and Rino could be used to accomplish this conversion. This article will show how Open Babel can be used from Ruby to effect the same conversion.">

	
  </head><body class="ma0 avenir bg-near-white development">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Depth-First
      
    </a>
    <div class="flex-l items-center">
      

      
      <div class="ananke-socials"></div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Articles
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1">From SMILES to InChI with OBRuby</h1>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2006-11-03T00:00:00Z">November 3, 2006</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p><!-- raw HTML omitted -->SMILES<!-- raw HTML omitted --> and <!-- raw HTML omitted -->InChI<!-- raw HTML omitted --> are two commonly-used <!-- raw HTML omitted -->molecular line notations<!-- raw HTML omitted -->. Although each has its advantages and limitations, the novelty of InChI and the ubiquity of SMILES makes the SMILES to InChI conversion especially useful. Many of the situations in which the need for this conversion will arise are particularly well-suited for the <!-- raw HTML omitted -->Ruby<!-- raw HTML omitted --> programming language. A <!-- raw HTML omitted -->recent article<!-- raw HTML omitted --> described how <!-- raw HTML omitted -->RCDK<!-- raw HTML omitted --> and <!-- raw HTML omitted -->Rino<!-- raw HTML omitted --> could be used to accomplish this conversion. This article will show how Open Babel can be used from Ruby to effect the same conversion.</p>
<h1 id="obruby">OBRuby</h1>
<p><!-- raw HTML omitted -->OBRuby<!-- raw HTML omitted --> is a SWIG-generated Ruby interface to the <!-- raw HTML omitted -->Open Babel<!-- raw HTML omitted --> library. Although OBRuby doesn&rsquo;t expose all aspects of the Open Babel API, nearly everything that can be done in C++ Open Babel can now be done in Ruby. For example, all <!-- raw HTML omitted -->OBConversion<!-- raw HTML omitted --> permutations should be available, including SMILES to InChI.</p>
<h1 id="a-small-ruby-library">A Small Ruby Library</h1>
<p>Let&rsquo;s create a small Ruby library for converting SMILES strings into InChI identifiers. Save the following into a file called <!-- raw HTML omitted -->convert.rb<!-- raw HTML omitted -->:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span>require <span style="color:#e6db74">&#39;openbabel&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Convertor</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">initialize</span>
</span></span><span style="display:flex;"><span>    @conv <span style="color:#f92672">=</span> <span style="color:#66d9ef">OpenBabel</span><span style="color:#f92672">::</span><span style="color:#66d9ef">OBConversion</span><span style="color:#f92672">.</span>new
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @conv<span style="color:#f92672">.</span>set_in_and_out_formats(<span style="color:#e6db74">&#39;smi&#39;</span>, <span style="color:#e6db74">&#39;inchi&#39;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_inchi</span>(smiles)
</span></span><span style="display:flex;"><span>    mol <span style="color:#f92672">=</span> <span style="color:#66d9ef">OpenBabel</span><span style="color:#f92672">::</span><span style="color:#66d9ef">OBMol</span><span style="color:#f92672">.</span>new
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @conv<span style="color:#f92672">.</span>read_string(mol, smiles)
</span></span><span style="display:flex;"><span>    @conv<span style="color:#f92672">.</span>write_string(mol)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><p>There&rsquo;s nothing tricky here. We&rsquo;ve simply created a Ruby class that makes the SMILES to InChI conversion as simple as one method call to an instance.</p>
<h1 id="testing-the-library">Testing the Library</h1>
<p>A good way to test this library is through Interactive Ruby (irb). For example, to find the InChI of caffeine:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span>require <span style="color:#e6db74">&#39;convert&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>c <span style="color:#f92672">=</span> <span style="color:#66d9ef">Convertor</span><span style="color:#f92672">.</span>new
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>puts c<span style="color:#f92672">.</span>get_inchi(<span style="color:#e6db74">&#39;Cn1cnc2c1c(=O)n(C)c(=O)n2C&#39;</span>) <span style="color:#75715e"># caffeine</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># =&gt;InChI=1/C8H10N4O2/c1-10-4-9-6-5(10)7(13)12(3)8(14)11(6)2/h4H,1-3H3</span>
</span></span></code></pre></div><h1 id="chiral-smiles">Chiral SMILES</h1>
<p>I applied this simple Ruby conversion library to the <!-- raw HTML omitted -->(S)-methamphetamine record in PubChem<!-- raw HTML omitted -->:</p>
<ul>
<li>Isomeric SMILES: C<a href="CC1=CC=CC=C1">C@@H</a>NC</li>
<li>PubChem InChI: InChI=1/C10H15N/c1-9(11-2)8-10-6-4-3-5-7-10/h3-7,9,11H,8H2,1-2H3/t9-/m0/s1</li>
</ul>
<p>My results were:</p>
<ul>
<li>Isomeric SMILES: C<a href="CC1=CC=CC=C1">C@@H</a>NC</li>
<li>OBRuby InChI: InChI=1/C10H15N/c1-9(11-2)8-10-6-4-3-5-7-10/h3-7,9,11H,8H2,1-2H3/t9-/m1/s1</li>
</ul>
<p>As you can see, there is a discrepancy in the two stereo layers (<code>m0</code> vs. <code>m1</code>). The same InChI is generated by Open Babel using either OBRuby or the <!-- raw HTML omitted -->Worldwide Molecular Matrix<!-- raw HTML omitted -->. Substituting the SMILES string representing the opposite configuration at carbon generates the InChI with opposite configuration (R), which again is opposite to that of <!-- raw HTML omitted -->(R)-methamphetamine in PubChem<!-- raw HTML omitted -->.</p>
<p>At this point, it is unclear whether Open Babel or PubChem is producing the correct InChI for the methamphetamine enantiomers. I suspect Open Babel is correct. By creating a molfile of (S)-methamphetamine with <!-- raw HTML omitted -->JME<!-- raw HTML omitted --> and running cInChI over it, I got the same output as with the Open Babel conversions. I&rsquo;ve found similar differences between PubChem and Open Babel InChIs in every chiral molecule I&rsquo;ve looked at.</p>
<h1 id="conclusions">Conclusions</h1>
<p>The conversion of SMILES, and other molecular languages, into InChI identifiers can be expected to become a recurring need as the popularity of InChI increases. Combining the formidable translation capabilities of Open Babel with the comfort and convenience of Ruby offers a powerful new technique for doing so.</p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://localhost:1313/" >
    &copy;  Depth-First 2024 
  </a>
    <div><div class="ananke-socials"></div>
</div>
  </div>
</footer>

  </body>
</html>
