<!DOCTYPE html>
<html lang="en-us" dir="ltr" class="scroll-smooth" data-default-appearance="light"
  data-auto-appearance="true"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  
  <meta http-equiv="content-language" content="en-us" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>Of Zero-Order Bonds and Bonding Systems &middot; Depth-First</title>
  <meta name="title" content="Of Zero-Order Bonds and Bonding Systems &middot; Depth-First" />
  
  <meta name="description" content="In search of a backward-compatible upgrade path to multi-atom bonding." />
  
  
  
  <link rel="canonical" href="http://localhost:1313/articles/2021/05/05/of-zero-order-bonds-and-bonding-systems/" />
  
  
  
  
  
  
  
  
  
  
  <link type="text/css" rel="stylesheet" href="/css/main.bundle.min.e27868ab1485f7ed7b06b122b4980bd38b19526eb8f7de885181204d28f04a0c47e9c334eff19a06c0278eb2ff8415b983a5d0fb80fd6b5680c926457cc61c57.css"
    integrity="sha512-4nhoqxSF9&#43;17BrEitJgL04sZUm64996IUYEgTSjwSgxH6cM07/GaBsAnjrL/hBW5g6XQ&#43;4D9a1aAySZFfMYcVw==" />
  
  
  <script type="text/javascript" src="/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js"
    integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj&#43;e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script>
  
  
  
  
  
  
  
  
  
  
  
  <script defer type="text/javascript" id="script-bundle" src="/js/main.bundle.min.c178288131a2f1ad46910438db47ac5f7e1c48cf949e49f6dc3310c8ec9660e23fe505805eba4e2e73711335808500360d773a2b64322feb35df52856edca286.js"
    integrity="sha512-wXgogTGi8a1GkQQ420esX34cSM&#43;Unkn23DMQyOyWYOI/5QWAXrpOLnNxEzWAhQA2DXc6K2QyL&#43;s131KFbtyihg==" data-copy="" data-copied=""></script>
  
  
  
  <script src="/lib/zoom/zoom.min.37d2094687372da3f7343a221a470f6b8806f7891aa46a5a03966af7f0ebd38b9fe536cb154e6ad28f006d184b294525a7c4054b6bbb4be62d8b453b42db99bd.js" integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S&#43;Yti0U7QtuZvQ=="></script>
  
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="manifest" href="/site.webmanifest" />
  
  
  
  
  
  
  
  
  <meta property="og:url" content="http://localhost:1313/articles/2021/05/05/of-zero-order-bonds-and-bonding-systems/">
  <meta property="og:site_name" content="Depth-First">
  <meta property="og:title" content="Of Zero-Order Bonds and Bonding Systems">
  <meta property="og:description" content="In search of a backward-compatible upgrade path to multi-atom bonding.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2021-05-05T18:00:00+00:00">
    <meta property="article:modified_time" content="2021-05-05T18:00:00+00:00">

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Of Zero-Order Bonds and Bonding Systems">
  <meta name="twitter:description" content="In search of a backward-compatible upgrade path to multi-atom bonding.">

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "Of Zero-Order Bonds and Bonding Systems",
    "headline": "Of Zero-Order Bonds and Bonding Systems",
    
    "abstract": "In search of a backward-compatible upgrade path to multi-atom bonding.",
    "inLanguage": "en-us",
    "url" : "http:\/\/localhost:1313\/articles\/2021\/05\/05\/of-zero-order-bonds-and-bonding-systems\/",
    "author" : {
      "@type": "Person",
      "name": ""
    },
    "copyrightYear": "2021",
    "dateCreated": "2021-05-05T18:00:00\u002b00:00",
    "datePublished": "2021-05-05T18:00:00\u002b00:00",
    
    "dateModified": "2021-05-05T18:00:00\u002b00:00",
    
    
    
    "mainEntityOfPage": "true",
    "wordCount": "2801"
  }]
  </script>


  
  
  
  
  

<script src="/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js" integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj&#43;KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script>






















  
  



  
  
  <meta name="theme-color"/>
  
  
</head>
<body
  class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
  <div id="the-top" class="absolute flex self-center">
    <a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
      href="#main-content"><span
        class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a>
  </div>
  
  
  <div style="padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px"
    class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3">
    
    <div class="flex flex-1 items-center justify-between">
        <nav class="flex space-x-3">

            
            <a href="/" class="text-base font-medium text-gray-500 hover:text-gray-900">Depth-First</a>
            

        </nav>
        <nav class="hidden md:flex items-center space-x-5 md:ml-12 h-12">

            

            


            
            <button id="search-button" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            


            
            
            <div
                class="ltr:mr-14 rtl:ml-14 flex items-center">
                <button id="appearance-switcher" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400">
                    <div class="flex items-center justify-center dark:hidden">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                    </div>
                    <div class="items-center justify-center hidden dark:flex">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                    </div>
                </button>
            </div>
            

        </nav>
        <div class="flex md:hidden items-center space-x-5 md:ml-12 h-12">

            <span></span>

            


            
            <button id="search-button-mobile" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            

            
            
            <button id="appearance-switcher-mobile" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400" style="margin-right:5px">
                <div class="flex items-center justify-center dark:hidden">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                </div>
                <div class="items-center justify-center hidden dark:flex">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                </div>
            </button>
            

        </div>
    </div>
    <div class="-my-2 -mr-2 md:hidden">

        <label id="menu-button" class="block">
            

            </div>
        </label>
    </div>
</div>





  
  <div class="relative flex flex-col grow">
    <main id="main-content" class="grow">
      


<article>
  

  <header id="single_header" class="mt-5 max-w-prose">
    
    <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
      Of Zero-Order Bonds and Bonding Systems
    </h1>
    <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
      





  
  







  





  



  













<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2021-05-05T18:00:00&#43;00:00">May 5, 2021</time><span class="px-2 text-primary-500">&middot;</span><span>2801 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">14 mins</span>
  

  
  
</div>








    </div>

    
    
    
    
    

    

    
      
      
        
        
<div class="flex author">
  
  <div class="place-self-center">
    
    
    <div class="text-2xl sm:text-lg">
</div>
  </div>
</div>

      

      

      
      <div class="mb-5"></div>
      

    

  </header>
  
  <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
    
    

      <div class="min-w-0 min-h-0 max-w-fit">
        
        


        <div class="article-content max-w-prose mb-20">
          <p>Cheminformatics and chemistry don&rsquo;t always move in tandem. A case in point is <a href="/articles/2020/04/27/multi-atom-bonding-in-cheminformatics/">multi-atom bonding</a>. Organometallic species, which have been made, characterized, and used for decades serve as the most obvious example. But there are more subtle cases as well, such as tautomers and mesomers. These species all highlight the problems of building cheminformatics on the shaky ground of <a href="https://en.wikipedia.org/wiki/Valence_bond_theory" target="_blank">valence bond theory</a>.</p>
<p>Useful thought it may be for certain molecules, the two-atom valence bond is too restrictive for general use. What&rsquo;s needed is a more generalized concept for bonding. Many articles on this blog have documented the problem and possible solutions. See, for example <em><a href="/articles/2020/04/27/multi-atom-bonding-in-cheminformatics/">Multi-Atom Bonding in Cheminformatics</a></em>. A deep-rooted overhaul like this is bound to be disruptive, which in part explains the relative lack of progress.</p>
<p>Instead of a giant leap, is it possible to take baby steps? If so, what form might those steps take? This article describes one possibility.</p>


<h1 class="relative group">The Zero-Order Bond 
    <div id="the-zero-order-bond" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#the-zero-order-bond" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>In 2010, <a href="https://cheminf20.org/about/" target="_blank">Alex Clark</a> proposed <a href="https://pubs.acs.org/doi/10.1021/ci200488k" target="_blank">an approach</a> to the problem of multi-atom bonding. Its purpose was to accomplish three goals:</p>
<ol>
<li>Capture all meaningful pairwise atomic interactions.</li>
<li>Ensure the accuracy of implicit hydrogen counts.</li>
<li>Enable maximum backward-compatibility with existing tools and practices.</li>
</ol>
<p>To accomplish these goals, the proposal updates the molecular data structure in the following two ways:</p>
<ol>
<li>Each bond has a <code>bond_order</code> property that can assume one value chosen from the set { 0, 1, 2, 3 }.</li>
<li>Each atom has a <code>hydrogens</code> property that can assume one value chosen from the set { <code>automatic</code>, 0, 1, 2, &hellip; }.</li>
</ol>
<p>The assignment of the <code>bond_order</code> property is restricted in the sense that a value of zero <em>must</em> be used if either of the following is true:</p>
<ul>
<li>The bond is dative, without atomic charge correction. In other words, it is a single bond in which both electrons come from the same atom, and atomic charges don&rsquo;t reflect that fact.</li>
<li>The bond order is any value other than 1, 2, or 3.</li>
</ul>
<p>Only the elements C, N, P, O, and S are eligible for <code>automatic</code> hydrogen counting. Atoms containing any other element must use a numerical value. The following formulas are used to compute an automatic hydrogen count:</p>
<ul>
<li>carbon: 4 - |<code>charge</code>| - <code>unused_electrons</code> - <code>valence</code>;</li>
<li>nitrogen and phosphorous: 3 - |<code>charge</code>| - <code>unused_electrons</code> - <code>valence</code>;</li>
<li>oxygen and sulfur: 2 + |<code>charge</code>| - <code>unused_electrons</code> - <code>valence</code>;</li>
</ul>
<p>where:</p>
<ul>
<li><code>unused_electrons</code> is the number of unused bonding electrons, which will be non-zero for radicals and carbenes;</li>
<li><code>valence</code> is the sum of bond orders.</li>
</ul>
<p>Readers of this blog will recognize the <code>hydrogens</code> property as a form of <a href="/articles/2020/05/18/hydrogen-suppression-in-cheminformatics/">hydrogen suppression</a>. The <code>automatic</code> setting corresponds to implicit hydrogen, whereas a numerical value corresponds to <a href="/articles/2019/11/06/virtual-hydrogens/">virtual hydrogens</a>.</p>
<p>In this article, I&rsquo;ll use the abbreviation ZOB (&ldquo;zero-order bond&rdquo;) when referring to this proposal, but the part about counting hydrogens is crucial. Having laid out the rules for the ZOB proposal, let&rsquo;s have a look at how to use it in practice.</p>


<h1 class="relative group">Examples 
    <div id="examples" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#examples" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>The <a href="https://en.wikipedia.org/wiki/Coordinate_covalent_bond" target="_blank">coordinate covalent bond</a> (i.e., &ldquo;dative bonding&rdquo;) is a type of single bond in which one atom contributes both electrons. A simple example is the ammonia-borane adduct. The B-N bond can be thought of as containing <em>two</em> electrons drawn from nitrogen and <em>zero</em> electrons drawn from boron.</p>
<p>Applying a zero-order bond representation to this case is straightforward. We start with hydrogen count, noting that nitrogen can use <code>automatic</code> counting but boron can not. The B-N bond is dative, so its order is set to 0. The implicit hydrogen count on nitrogen is computed to be 3 (3 - 0 - 0 - 0). This representation succeeds in capturing the important B-N dative bond while also yielding an accurate hydrogen count for all atoms.</p>
<!-- raw HTML omitted -->
<p>Alternatively, the bond between nitrogen and boron could be single, with atomic charges modified to ensure correct implicit hydrogen counts. This is the most likely representation today.</p>
<!-- raw HTML omitted -->
<p>Zero-order bonds can be generalized to many other kinds of metal complexes. For example, the ZOB paper notes the advantages of using zero-order bonds with complexes such as [Co(NH<!-- raw HTML omitted -->3<!-- raw HTML omitted -->)<!-- raw HTML omitted -->6<!-- raw HTML omitted -->]<!-- raw HTML omitted -->3+<!-- raw HTML omitted -->: human-readability; the charge on the metal is unsurprising; implicit (<code>automatic</code>) hydrogen counting on nitrogen just works; and the important interaction between the metal and the nitrogen atoms is captured. Other representations using charge separation, a plain single bond, or even double bonds don&rsquo;t work as well.</p>
<!-- raw HTML omitted -->
<p>Multi-centered bonding like the kind found in organometallics poses especially tough challenges in cheminformatics. The very nature of the phenomenon is precluded by the two-atom valence bond model ubiquitous in file formats, drawing tools, and toolkits. Zero-order bonds can be used here as well, as illustrated by the <a href="https://en.wikipedia.org/wiki/Allylpalladium_chloride_dimer" target="_blank">allylpalladium chloride dimer</a>.</p>
<!-- raw HTML omitted -->
<p>Notice the mixed use of single and zero-order bonds between Pd-C and Pd-Cl pairs. This allows all meaningful interactions between atom pairs to be recorded, without distorting implicit hydrogen counts. Similar considerations apply with more complex examples, including metallocenes and cage compounds. However, the approach does introduce artificially asymmetrical bonding relationships. We&rsquo;ll return to this point later.</p>


<h1 class="relative group">Implementation 
    <div id="implementation" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#implementation" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Backward-compatibility is an important design goal with the ZOB proposal. To illustrate, the paper explains how to retrofit the properties block of the V2000 molfile format to support zero-order bonding. Three new properties are added:</p>
<ul>
<li><code>M  ZCH</code>. Overrides the built-in charge property (<code>M  CHG</code>).</li>
<li><code>M  HYD</code>. The <code>hydrogens</code> atomic property as defined above. If this property is not set for an atom, then it defaults to <code>automatic</code>.</li>
<li><code>M  ZBO</code>. Overrides bond order given in the bond block.</li>
</ul>
<p>The example of the borane-ammonia complex discussed above would be represented in a ZBO-aware V2000 molfile as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>Molecule Name
</span></span><span style="display:flex;"><span>File Descriptor
</span></span><span style="display:flex;"><span>Comments
</span></span><span style="display:flex;"><span>  2  1  0  0  0  0  0  0  0  0999 V2000
</span></span><span style="display:flex;"><span>    0.0000    0.0000    0.0000 B   0  5  0  0  0  0  0  0  0  0  0  0
</span></span><span style="display:flex;"><span>    1.5000    0.0000    0.0000 N   0  3  0  0  0  0  0  0  0  0  0  0
</span></span><span style="display:flex;"><span>  1  2  1  0  0  0  0
</span></span><span style="display:flex;"><span>M  CHG  2   1  -1   2   1
</span></span><span style="display:flex;"><span>M  ZCH  2   1   0   2   0
</span></span><span style="display:flex;"><span>M  HYD  1   1   3
</span></span><span style="display:flex;"><span>M  ZBO  1   1   0
</span></span><span style="display:flex;"><span>M  END
</span></span></code></pre></div><p>Backward-compatibility with non-ZBO implementations is possible because the V2000 specification states that unrecognized properties are ignored. This means that a reader that doesn&rsquo;t understand ZBO will interpret the file as a charge-separated, single bond representation.</p>
<p>But ZBO-aware implementations will behave differently. Noting the <code>M  ZCH</code> property, the charges on each atom will be set to zero. The <code>M  HYD</code> property will set the hydrogen count on boron (Atom 1) to 3. Finally, the <code>M  ZBO</code> property will set the order of the B-N bond to zero.</p>
<p>What this treatment ignores is the somewhat obscure fact that <a href="/articles/2020/04/13/hydrogen-suppression-in-molfiles/">V2000 defines its own rules for hydrogen counting</a>. Both implicit and virtual hydrogens are supported. The way this works is neither intuitive nor easy to explain. For details, see the linked article. The system is arcane enough that I suspect it would be non-trivial to implement and test an extension that correctly handled every possible way in which native and ZBO hydrogen suppression could interact.</p>


<h1 class="relative group">Applications 
    <div id="applications" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#applications" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Although first described ten years ago, the ZBO proposal has gained renewed current relevance as a possible way to extend InChI for use with organometallics. The idea is covered in at least five public documents:</p>
<ul>
<li><a href="https://github.com/aclarkxyz/data_coordinchi" target="_blank">Coordination Complexes for InChI: preliminary study</a>. A validation set and an interactive tool with a proof-of-concept for organometallic InChI. The README explains the theory behind the implementation.</li>
<li><a href="https://github.com/aclarkxyz/data_coordinchi/blob/master/READMEph2.md" target="_blank">Coordination Complexes for InChI: phase 2 study</a>. Addresses comments and issues raised in response to Phase 1, in particular ways to address stereochemistry.</li>
<li><a href="https://cheminf20.org/2020/10/18/coordination-inchi-for-inorganics-now-with-stereochemistry/" target="_blank">Coordination InChI for inorganics: now with stereochemistry</a>. Discusses non-traditional stereochemistry and InChI in the context of inorganics and organometallics.</li>
<li><a href="https://cheminf20.org/2019/09/10/inchi-for-inorganics/" target="_blank">InChI for inorganics</a>. Explains the method used to obtain real-world examples of organometallics from the <a href="https://www.ccdc.cam.ac.uk/solutions/csd-core/components/csd/" target="_blank">CCCD</a>.</li>
<li><a href="https://www.slideshare.net/aclarkxyz/coordination-inchi-2019" target="_blank">Coordination InChI: Preliminary survey of organic compounds</a>. A slide deck from 2019 that sets the stage for adapting InChI for organometallics.</li>
</ul>
<p>The ZBO proposal factors prominently in each of these documents, if not explicitly.</p>


<h1 class="relative group">Tradeoffs 
    <div id="tradeoffs" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#tradeoffs" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>There are reasons that cheminformatics lags chemistry when it comes to the representation of bonding in organometallics: the problem is very hard and current solutions are entrenched. Every new solution brings with it tradeoffs of one kind or another. Finding a representational system is only one part of the problem because any new system has the potential to break what currently works. The ZBO proposal is no different.</p>
<p>An obvious tradeoff of using ZBO is that in some cases, formal charge and bond order become meaningless. Sometimes this won&rsquo;t matter, but sometimes it will. Knowing the difference can be extraordinarily difficult without in-depth knowledge of exactly how bonds are being used.</p>
<p>Take molecular descriptors, for example. Many of them rely on bond orders. What should happen when a descriptor calculation encounters a zero-order bond? Should it be ignored? Should it be flagged and/or logged? Should an attempt be made to compute a fractional bond order? What changes if the computation only uses atomic degree (number of attached atoms) rather than valence? These are not easy questions.</p>
<p>Similarly, zero-order bonds can complicate certain kinds of database queries. For example, a query requesting all cases of nitrogen bound to boron may fail if zero-order bonds are disregarded by the algorithm prior to search.</p>
<!-- raw HTML omitted -->
<p>Another tradeoff is asymmetry. Specifically, zero-order bonds introduce <em>artificial</em> asymmetry. Consider once again the representation of allylpalladium chloride dimer. Organometallic chemists would be quick to point out that the symmetry of the two terminal carbon atoms is artificially broken when implementing the ZOB proposal. Sometimes distinctions like this will not matter, but sometimes they&rsquo;ll matter a lot.</p>
<p>Notice, however, that these tradeoffs are beyond the scope of the ZOB proposal&rsquo;s goals, which to re-iterate are capturing all meaningful pairwise atomic interactions; ensuring correct hydrogen counts; and backward-compatibility.</p>


<h1 class="relative group">The Bigger Picture 
    <div id="the-bigger-picture" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#the-bigger-picture" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>In some ways, the tradeoffs of the ZOB proposal merely reflect the problems of the status quo reliance on the two-atom valence bond model.</p>
<p>To understand the underlying problem and its solutions, it&rsquo;s helpful to define two terms in the context of molecular representations:</p>
<ul>
<li><strong>attribute</strong>: An assignable value. The term is derived from the French for &ldquo;to assign&rdquo;.</li>
<li><strong>computation</strong>: A mathematical operation over one or more molecular attributes.</li>
</ul>
<p>Both ZOB and the status quo view bonder order and formal charge as attributes. This means that both values are assignable values within a molecular graph. Finding the order of a bond means looking up the value assigned to that property. Likewise, to get an atom&rsquo;s formal charge, read the charge value.</p>
<p>In an earlier article, <em><a href="/articles/2020/03/16/formal-charge-and-bond-order-are-side-effects/">Formal Charge and Bond Order are Side Effects</a></em>, I explained some of the problems with this model. I also described a system that eliminates these problems. Rather than viewing bond order as an assignable property, it is better viewed as computation.  Likewise, formal charge results from a computation. In other words, formal charge and bond order are computed from molecular attributes.</p>
<p>It may not be obvious, but this alternative view places particle counts at the center of focus. If a value does not represent a particle count, it&rsquo;s likely to be a computation. Viewed from this perspective it&rsquo;s clear why both formal charge and bond order would be considered computations, not attributes. It&rsquo;s also clear why proton count, neutron count, electron count, and virtual hydrogen count would all be considered attributes.</p>
<p>Although the ZOB proposal does not share this particle-centric perspective, it does offer qualities that could be complementary.</p>


<h1 class="relative group">Welcome to Electron Delocalization Island 
    <div id="welcome-to-electron-delocalization-island" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#welcome-to-electron-delocalization-island" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>One of the topics covered in <em><a href="https://github.com/aclarkxyz/data_coordinchi" target="_blank">Coordination Complexes for InChI: preliminary study</a></em> is how to translate ZOB representations into something that can be processed by InChI software. In doing so, the concept of <em>electron delocalization island</em> is introduced:</p>
<blockquote>
<p>The concept of an electron delocalisation island is that each of these marks a subgraph whereby electrons can freely equilibrate. Making use of this idea is best done by enumerating the exceptions: for simple cheminformatics purposes, it is a reasonable working rule that electrons do not jump between connected components; and, heavily saturated main group atoms with no pi-bonds, or charges, or Lewis acid/base characteristics, generally do not allow electrons to pass. The most common example is sp3 carbon, but there are other judgment calls that can also be made about when an atom is considered &ldquo;blocking&rdquo;.</p>
</blockquote>
<p>The document then offers some graphical examples with electron delocalization islands in gray:</p>
<!-- raw HTML omitted -->
<p>Confusingly, the same concept also appears to go by other names, including <a href="https://github.com/aclarkxyz/data_coordinchi/blob/master/READMEph2.md#dotpath" target="_blank">&ldquo;dot paths&rdquo;</a> and &ldquo;islands of resonance:&rdquo;</p>
<blockquote>
<p>The first stage of creating the coordination layer involves processing the molecule by distilling the atom and bond properties into a limited form. When valence counting rules are applied to a hydrogen-suppressed organic structure, having bond orders, charges, radicals and hydrogen counts is an overspecification: one or two of these properties can be removed with most information still intact. The standard InChI algorihm [sic] emits a graph that lacks bond order and radical status, but includes charges and hydrogens. The &ldquo;DotPath&rdquo; algorithm takes a similar approach, except that it takes into account the fact that the realm of inorganic chemistry does not provide for any reasonable set of rules to localise charges on specific atoms. It is, however, possible to identify &ldquo;islands of resonance&rdquo; within graph components, sum up the formal charges within each of these islands, and treat the charge as being delocalised within that scope.</p>
</blockquote>
<p>Although the document doesn&rsquo;t describe the algorithm for finding electron delocalization islands in detail, the texts hint at how this might be accomplished. An implementation can be found within a separate <a href="https://github.com/aclarkxyz/web_molkit/blob/master/src/data/DotPath.ts" target="_blank">source code repository</a>. A <a href="https://molmatinf.com/coordinchi/" target="_blank">working demonstration</a> of the dot path algorithm is available online.</p>
<!-- raw HTML omitted -->
<p>Electron delocalization islands may bring to mind a related concept: <a href="/articles/2020/02/10/a-comprehensive-treatment-of-aromaticity-in-the-smiles-language/">Kekulé structures and aromaticity</a>. An aromatic bond is a multi-atom arrangement that can only be represented as a superposition of valence bonds. To address this problem, the aromatic bond is &ldquo;Kekulized&rdquo; to yield a single arbitrary Kekulé form consisting of only two-centered bonds. The Kekulé form makes it possible to deal with aromatic bonding at the expense of introducing artificial asymmetry. In a similar way, zero-order bonds could allow file formats and toolkits to work with organometallics, but at the cost of introducing artificial asymmetry, and possibly rendering the concepts of bond order and formal charge meaningless.</p>


<h1 class="relative group">Bonding System 
    <div id="bonding-system" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#bonding-system" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Electron delocalization islands bear a striking similarity to a concept known as <em>bonding system</em> first described by Andreas Dietz in his paper <em><a href="https://doi.org/10.1021/ci00027a001" target="_blank">Yet Another Representation of Molecular Structure</a></em>.</p>
<p>In a nutshell, a bonding system is a connected molecular subgraph of degree two or higher with an associated electron count attribute. In other words, a bond is merely a special case of a bonding system, but restricted to a single edge. Bonding systems generalize the traditional two-atom bond to multiple atoms. Fractional bond orders and formal charges fall out naturally from a suitably configured molecular graph. Organometallics, inorganics, mesomers, and tautomers can all be handled by a single, uniform abstraction, with no need to identify or separately treat special cases.</p>
<p>Given a molecular graph with atomic attributes and all bonding systems, the exact formal charge for any atom and the exact formal bond order across any edge can be computed. The computation is described in detail in both Dietz&rsquo;s paper and <a href="/articles/2020/03/16/formal-charge-and-bond-order-are-side-effects/">my writeup</a>.</p>
<p>The main tradeoff when using bonding systems is complexity. Representation is more complex because bonding systems have many edges rather than just one. Analysis is more complex because calculations of formal charge, valence, and bond order need to account for the possibility of multi-atom bonding systems.</p>
<p>In practice, I&rsquo;ve developed an optimization that eliminates a lot of the complexity. A <a href="/articles/2020/04/06/a-minimal-molecule-api/">molecular API</a> can be crafted that simplifies implementation for traditional bonds while hiding the fact that this optimization has taken place.</p>


<h1 class="relative group">Outlook 
    <div id="outlook" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#outlook" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Perhaps the biggest headwind facing any attempt to upgrade molecular representation is inertia. Chemists must be made aware of the problem and how it affects them. Toolkit vendors must recognize the problem and move to address it. Algorithms previously written for two-centered non-dative bonds need to be upgraded. End user tools must change the ways that user interfaces work. Change is never easy, and the status quo has served chemistry well over the years.</p>
<p>Even so, a growing number of chemists understand the problem and are starting to take steps to address it. The work on zero-order bonds speaks to this, as do the 20+ chemists in attendance at the last <a href="http://www-jmg.ch.cam.ac.uk/inchi/" target="_blank">InChI working group on organometallics</a> in April.</p>


<h1 class="relative group">Conclusion 
    <div id="conclusion" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#conclusion" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>The Zero-Order Bond (ZOB) proposal offer a pragmatic solution to the problem of accurately encoding extended bonding arrangements. To the extent that the idea can be retrofitted onto current tools and practices, ZOB may eventually gain widespread adoption, at least incrementally. Zero-order bonds could also serve as a bridge between today&rsquo;s molecular representations and more generalized representations, such as those based on bonding systems that offer greater expressiveness.</p>

          
          
          
        </div>
        
        

        
        

          
      </div>
     
      
      
        
        
          
          
        
      <script>
        var oid = "views_posts\/2021-05-04-of-zero-order-bonds-and-bonding-systems.md"
        var oid_likes = "likes_posts\/2021-05-04-of-zero-order-bonds-and-bonding-systems.md"
      </script>
      
      
      <script type="text/javascript" src="/js/page.min.0860cf4e04fa2d72cc33ddba263083464d48f67de06114529043cb4623319efed4f484fd7f1730df5abea0e2da6f3538855634081d02f2d6e920b956f063e823.js" integrity="sha512-CGDPTgT6LXLMM926JjCDRk1I9n3gYRRSkEPLRiMxnv7U9IT9fxcw31q&#43;oOLabzU4hVY0CB0C8tbpILlW8GPoIw=="></script>
      
  
    </section>
  <footer class="pt-8 max-w-prose print:hidden">

    
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group mr-3" href="/articles/2021/04/21/inchi-syntax/">
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >InChI Syntax</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2021-04-21T15:30:00&#43;00:00">April 21, 2021</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="flex text-right group ml-3" href="/articles/2021/05/19/standard-inchi/">
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Standard InChI</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2021-05-19T20:00:00&#43;00:00">May 19, 2021</time>
                  
                </span>
              </span>
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


    
  </footer>
</article>

      <div id="top-scroller" class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0">
  <a href="#the-top"
    class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top" title="Scroll to top">
    &uarr;
  </a>
</div>
    </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
  
  <div class="flex items-center justify-between">

    
    
    <p class="text-sm text-neutral-500 dark:text-neutral-400">
      &copy;
      2024
      
    </p>
    

    
    
    <p class="text-xs text-neutral-500 dark:text-neutral-400">
      
      
      Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a>
    </p>
    

  </div>
  <script>
    
    mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
      margin: 24,
      background: 'rgba(0,0,0,0.5)',
      scrollOffset: 0,
    })
    
  </script>
  
  
  <script type="text/javascript" src="/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js" integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]"
  data-url="http://localhost:1313/"
  style="z-index:500"
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)"
      >
        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

  </div>
</body>

</html>
