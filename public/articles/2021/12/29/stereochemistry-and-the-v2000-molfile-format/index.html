<!DOCTYPE html>
<html lang="en-us" dir="ltr" class="scroll-smooth" data-default-appearance="light"
  data-auto-appearance="true"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  
  <meta http-equiv="content-language" content="en-us" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>Stereochemistry and the V2000 Molfile Format &middot; Depth-First</title>
  <meta name="title" content="Stereochemistry and the V2000 Molfile Format &middot; Depth-First" />
  
  <meta name="description" content="Making sense of some confusing but core features in a de facto standard." />
  
  
  
  <link rel="canonical" href="http://localhost:1313/articles/2021/12/29/stereochemistry-and-the-v2000-molfile-format/" />
  
  
  
  
  
  
  
  
  
  
  <link type="text/css" rel="stylesheet" href="/css/main.bundle.min.e27868ab1485f7ed7b06b122b4980bd38b19526eb8f7de885181204d28f04a0c47e9c334eff19a06c0278eb2ff8415b983a5d0fb80fd6b5680c926457cc61c57.css"
    integrity="sha512-4nhoqxSF9&#43;17BrEitJgL04sZUm64996IUYEgTSjwSgxH6cM07/GaBsAnjrL/hBW5g6XQ&#43;4D9a1aAySZFfMYcVw==" />
  
  
  <script type="text/javascript" src="/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js"
    integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj&#43;e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script>
  
  
  
  
  
  
  
  
  
  
  
  <script defer type="text/javascript" id="script-bundle" src="/js/main.bundle.min.c178288131a2f1ad46910438db47ac5f7e1c48cf949e49f6dc3310c8ec9660e23fe505805eba4e2e73711335808500360d773a2b64322feb35df52856edca286.js"
    integrity="sha512-wXgogTGi8a1GkQQ420esX34cSM&#43;Unkn23DMQyOyWYOI/5QWAXrpOLnNxEzWAhQA2DXc6K2QyL&#43;s131KFbtyihg==" data-copy="" data-copied=""></script>
  
  
  
  <script src="/lib/zoom/zoom.min.37d2094687372da3f7343a221a470f6b8806f7891aa46a5a03966af7f0ebd38b9fe536cb154e6ad28f006d184b294525a7c4054b6bbb4be62d8b453b42db99bd.js" integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S&#43;Yti0U7QtuZvQ=="></script>
  
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="manifest" href="/site.webmanifest" />
  
  
  
  
  
  
  
  
  <meta property="og:url" content="http://localhost:1313/articles/2021/12/29/stereochemistry-and-the-v2000-molfile-format/">
  <meta property="og:site_name" content="Depth-First">
  <meta property="og:title" content="Stereochemistry and the V2000 Molfile Format">
  <meta property="og:description" content="Making sense of some confusing but core features in a de facto standard.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2021-12-29T20:00:00+00:00">
    <meta property="article:modified_time" content="2021-12-29T20:00:00+00:00">

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Stereochemistry and the V2000 Molfile Format">
  <meta name="twitter:description" content="Making sense of some confusing but core features in a de facto standard.">

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "Stereochemistry and the V2000 Molfile Format",
    "headline": "Stereochemistry and the V2000 Molfile Format",
    
    "abstract": "Making sense of some confusing but core features in a de facto standard.",
    "inLanguage": "en-us",
    "url" : "http:\/\/localhost:1313\/articles\/2021\/12\/29\/stereochemistry-and-the-v2000-molfile-format\/",
    "author" : {
      "@type": "Person",
      "name": ""
    },
    "copyrightYear": "2021",
    "dateCreated": "2021-12-29T20:00:00\u002b00:00",
    "datePublished": "2021-12-29T20:00:00\u002b00:00",
    
    "dateModified": "2021-12-29T20:00:00\u002b00:00",
    
    
    
    "mainEntityOfPage": "true",
    "wordCount": "1844"
  }]
  </script>


  
  
  
  
  

<script src="/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js" integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj&#43;KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script>






















  
  



  
  
  <meta name="theme-color"/>
  
  
</head>
<body
  class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
  <div id="the-top" class="absolute flex self-center">
    <a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
      href="#main-content"><span
        class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a>
  </div>
  
  
  <div style="padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px"
    class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3">
    
    <div class="flex flex-1 items-center justify-between">
        <nav class="flex space-x-3">

            
            <a href="/" class="text-base font-medium text-gray-500 hover:text-gray-900">Depth-First</a>
            

        </nav>
        <nav class="hidden md:flex items-center space-x-5 md:ml-12 h-12">

            

            


            
            <button id="search-button" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            


            
            
            <div
                class="ltr:mr-14 rtl:ml-14 flex items-center">
                <button id="appearance-switcher" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400">
                    <div class="flex items-center justify-center dark:hidden">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                    </div>
                    <div class="items-center justify-center hidden dark:flex">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                    </div>
                </button>
            </div>
            

        </nav>
        <div class="flex md:hidden items-center space-x-5 md:ml-12 h-12">

            <span></span>

            


            
            <button id="search-button-mobile" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            

            
            
            <button id="appearance-switcher-mobile" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400" style="margin-right:5px">
                <div class="flex items-center justify-center dark:hidden">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                </div>
                <div class="items-center justify-center hidden dark:flex">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                </div>
            </button>
            

        </div>
    </div>
    <div class="-my-2 -mr-2 md:hidden">

        <label id="menu-button" class="block">
            

            </div>
        </label>
    </div>
</div>





  
  <div class="relative flex flex-col grow">
    <main id="main-content" class="grow">
      


<article>
  

  <header id="single_header" class="mt-5 max-w-prose">
    
    <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
      Stereochemistry and the V2000 Molfile Format
    </h1>
    <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
      





  
  







  





  



  













<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2021-12-29T20:00:00&#43;00:00">December 29, 2021</time><span class="px-2 text-primary-500">&middot;</span><span>1844 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">9 mins</span>
  

  
  
</div>








    </div>

    
    
    
    
    

    

    
      
      
        
        
<div class="flex author">
  
  <div class="place-self-center">
    
    
    <div class="text-2xl sm:text-lg">
</div>
  </div>
</div>

      

      

      
      <div class="mb-5"></div>
      

    

  </header>
  
  <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
    
    

      <div class="min-w-0 min-h-0 max-w-fit">
        
        


        <div class="article-content max-w-prose mb-20">
          <p>A previous article offered some <a href="/articles/2021/11/17/ten-reasons-to-adopt-the-v3000-molfile-format/">reasons to adopt the V3000 molfile format</a>. Although there are several, the one that gets the most attention is &ldquo;enhanced stereochemistry&rdquo; support. It should come as no surprise that the cost of this enhancement is increased complexity. Fortunately, V3000&rsquo;s stereochemistry model extends the one used in V2000. Unfortunately, the V2000 stereochemistry model is not exactly simple. This article explains V2000 stereochemistry in detail, both as a way to avoid data loss when working with the format, and as a way to understand what V3000 brings to the table.</p>


<h1 class="relative group">Source Documentation 
    <div id="source-documentation" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#source-documentation" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>The following discussion is based on two documents published by the molfile format&rsquo;s corporate sponsor: <a href="https://discover.3ds.com/sites/default/files/2020-08/biovia_ctfileformats_2020.pdf" target="_blank">CTFile Formats BIOVIA Databases 2020</a>; and <a href="http://help.accelrysonline.com/insight/2018/content/pdf_files/bioviachemicalrepresentation.pdf" target="_blank">Chemical Representation 2018 SP1</a> (&ldquo;the Guide&rdquo;). The former covers syntax and the later covers semantics. I&rsquo;ll sometimes refer to both documents collectively as &ldquo;the specification.&rdquo; The two documents must be read together and in their entirety to untangle the many nuances of the molfile format.</p>


<h1 class="relative group">Defined and Undefined Stereocenters 
    <div id="defined-and-undefined-stereocenters" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#defined-and-undefined-stereocenters" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Two concepts underpin the specification&rsquo;s treatment of stereochemistry: <em>defined stereocenters</em> and <em>undefined stereocenters</em>. The underlying concept, &ldquo;stereocenter,&rdquo; was defined in 1983 <a href="https://doi.org/10.1021/ja00323a043" target="_blank">by Mislow and Siegel</a> as an atom whose &ldquo;ligand permutation produces stereoisomers.&rdquo; For example, the tertiary carbon atom in alanine is a stereocenter because permutation of its ligands results in stereoisomers (specifically, enantiomers). The designations &ldquo;defined&rdquo; and &ldquo;undefined&rdquo; refer to whether or not a molfile notes the presence of a stereocenter.</p>
<p>A stereocenter is said to be &ldquo;defined&rdquo; if placed &ldquo;at the narrow end&rdquo; of an &ldquo;Up or Down stereo bond&rdquo; (Guide, p 9). Syntactically, a defined stereocenter is an atom connected to at least one bond whose &ldquo;bond stereo&rdquo; (<code>sss</code>) attribute is 1 (&ldquo;Up&rdquo;) or 6 (&ldquo;Down&rdquo;), and whose &ldquo;first atom number&rdquo; (<code>111</code>) attribute equals the atom&rsquo;s identifier.</p>
<p>The Guide goes on to muddy the waters with one additional apparent restriction on an atom&rsquo;s &ldquo;atom symbol&rdquo; (<code>aaa</code>) property:</p>
<blockquote>
<p>You can specify the stereoconfiguration at asymmetric tetrahedral centers (chirality centers) solely if the atom is one of the following: C, N, Si, P, As, S, Se or Te or any of their isoelectric equivalents (e.g. B-). [p 225]</p>
</blockquote>
<p>This restriction occurs in the context of the section titled &ldquo;Perception of Stereoconfiguration at Tetrahedral Centers.&rdquo; Similar language can be found in the 2011 version of the Guide:</p>
<blockquote>
<p>You can specify the stereoconfiguration at asymmetric tetrahedral centers (chirality centers) at the following atom types: C, N, O, Si, P, or S. [p 24]</p>
</blockquote>
<p>Here, atoms bearing both Se, Te appear to be disqualified as defined stereocenters, and there is no exception for isoelectronic equivalents. A previous article talked about <a href="/articles/2021/12/01/mdl-valence-mageddon/">other important changes to the molfile format</a> that occurred after the 2011 revision.</p>
<p>Assuming that all conditions are met, a defined stereocenter implies that:</p>
<blockquote>
<p>&hellip; something is known about the configuration at that center; either its absolute configuration, or its configuration relative to other stereogenic centers that are marked with stereo bonds. &hellip; [p 9]</p>
</blockquote>
<p>In other words, a defined stereocenter presents readers with a choice: interpret the stereocenter as <em>either</em> an absolute or relative configuration.The next section explains a deciding factor.</p>
<p>If a stereocenter does not sit at the thin end of an Up or Down stereobond, it is considered undefined. An undefined stereocenter implies that:</p>
<blockquote>
<p>&hellip; no information is known about the configuration of that stereogenic center. It could be either of two stereoisomers, or a mixture of the two. [p 9]</p>
</blockquote>
<p>It&rsquo;s easy to miss the subtlety here. An undefined stereocenter represents one of <em>three</em> possibilities: an arbitrary configuration; the opposite configuration; or a mixture of both configurations. We&rsquo;ll return to this point later.</p>


<h1 class="relative group">Atom Stereo Parity 
    <div id="atom-stereo-parity" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#atom-stereo-parity" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>The Guide talks at length about stereo parity, but this concept plays no role in V2000 molfiles. As noted by <em>CTFile Formats</em>, this atomic attribute (<code>sss</code>) is &ldquo;ignored when read&rdquo; (p 44). This lack of V2000 support for atom parity extends back to at least 2005. The only way to produce a defined stereocenter in V2000 files is to point the thin end of an Up or Down bond at it.</p>


<h1 class="relative group">Chiral Flag 
    <div id="chiral-flag" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#chiral-flag" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>The interpretation of defined stereocenters is governed by the global <em>chiral flag</em> attribute. Syntactically, this attribute appears in a V2000 molfile&rsquo;s counts line (the fourth) from the 13th to 15th columns, inclusive. A value of 0 leaves the flag unset (&ldquo;Off&rdquo;) and a value of 1 sets it (&ldquo;On&rdquo;). For example, a molfile with six atoms and five bonds whose chiral flag is set might have the following counts line:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>  6  5  0  0  1  0  0  0  0  0999 v2000
</span></span></code></pre></div><p>The purpose of the chiral flag is to convey to readers that the absolute configurations of all defined stereocenters is both known and defined as depicted. Setting the chiral flag has no effect on the interpretation of undefined stereocenters. The Guide uses the following language:</p>
<blockquote>
<p>Setting the chiral flag to On indicates that the structure as drawn represents a single stereoisomer whose absolute stereochemistry is known. [p 225]</p>
</blockquote>
<p>The Guide offers the example of (1R,2S)-(-)-<em>trans</em>-2-phenyl-1-cyclohexanol, encoded within a molfile whose chiral flag is set:</p>
<!-- raw HTML omitted -->
<p>A molfile whose chiral flag is Off conveys to readers that no information is available on the absolute configuration at any defined stereocenter. They must only be interpreted as relative configurations. The Guide uses the following language:</p>
<blockquote>
<p>Setting the chiral flag to Off indicates that the absolute configuration of the structure is unknown, but that the relative configurations of the stereogenic centers are known. The structure might represent either a single diastereomer or a mixture of the two stereoisomers.</p>
</blockquote>
<p>The Guide goes on to consider the example of <em>trans</em>-2-phenyl-1-cyclohexanol, this time encoded within a molfile whose chiral flag is not set:</p>
<!-- raw HTML omitted -->
<p>Because the chiral flag is Off, this molfile&rsquo;s defined stereocenters can only be interpreted in the relative sense. Futhermore, no information exists about the absolute configuration at either stereocenter. The molfile must therefore be interpreted in one of three possible ways: as one pure enantiomer; as the other pure enantiomer; or as a mixture of both enantiomers. The information needed to distinguish these possibilities does not exist.</p>
<p>The subtlety here bears repeating. The molfile very clearly does not encode a mixture of two enantiomers. Instead, it encodes three distinct possibilities: a single enantiomer; its antipode; or a mixture of the two.</p>
<p>Confusion on this point is not hard to find. <a href="https://www.inchi-trust.org/wp/wp-content/uploads/2017/11/11.-InChI-Stereo-Yerin-201708.pdf" target="_blank">A 2017 presentation on InChI</a>, for example, makes the following statements that conflict with the Guide:</p>
<!-- raw HTML omitted -->
<p>What about molfiles whose chiral flag is Off but which encode a single defined stereocenter? According to the Guide, such molfiles must be interpreted as encoding a <strong>mixture of enantiomers</strong>:</p>
<blockquote>
<p>For structures with only one stereogenic center, a structure with stereo bonds but without the chiral flag represents a mixture of enantiomers [p 256]</p>
</blockquote>
<p>Notice how this guidance contrasts with the way molfiles with two or more defined stereocenters are treated. Consider a molfile encoding alanine using one defined stereocenter, but with a chiral flag set to Off. This molfile must be interpreted as a mixture of enantiomers exclusively! The analogous <em>trans</em>-2-phenyl-1-cyclohexanol example was interpreted as one of three cases of which an enantiomeric mixture was one possibility, but the alanine example is a mixture only.</p>
<p>The following table summarizes the possible combinations of stereocenter type and chiral flag settings.</p>
<!-- raw HTML omitted -->
<p>The Guide does not discuss the case of a molfile having both defined and undefined stereocenters. The simplest interpretation would be that each type of stereocenter contributes independently. Consider a molfile whose chiral flag is Off and which encodes one defined stereocenter (A) and one undefined stereocenter (B). This molfile encodes the combinatorial result of applying the appropriate boolean logic in the table above. In other words, ONE of the following possibilities is encoded:</p>
<ul>
<li>AB + A&rsquo;B</li>
<li>AB&rsquo; + A&rsquo;B'</li>
<li>AB + AB&rsquo; + A&rsquo;B + A&rsquo;B'</li>
</ul>
<p>Similar considerations would apply for a molfile whose chiral flag is Off and which encodes two defined stereocenters and one undefined stereocenter. And so on.</p>


<h1 class="relative group">Mixture, not Racemate 
    <div id="mixture-not-racemate" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#mixture-not-racemate" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>The use of the term &ldquo;mixture&rdquo; is deliberate, both here and in the guide. The Guide uses the term in its traditional sense to denote the presence of two or more constituents. Notice, however, that the term implies nothing about the ratio of these constituents. Several sources incorrectly interpret the Guide&rsquo;s use of the term &ldquo;mixture&rdquo; to be equivalent to &ldquo;racemate&rdquo; or 50:50 mixture. This is not supported by my reading of the Guide, nor by the common use of the term &ldquo;mixture.&rdquo;</p>


<h1 class="relative group">Limitations 
    <div id="limitations" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#limitations" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>The Guide notes three main limitations with the V2000 stereochemistry model:</p>
<ol>
<li>There is no way to distinguish a stereochemical mixture from a single enantiomer in which all relative configurations are known.</li>
<li>The chiral flag applies to the entire molfile. Even if multiple molecules (connected components) are present, they can not be treated differently.</li>
<li>It&rsquo;s not possible to convey different levels of stereochemical uncertainty within the same molecule.</li>
</ol>
<p>These specific limitations motivated the development of V3000&rsquo;s enhanced stereochemistry support.</p>


<h1 class="relative group">Impedance Mismatch 
    <div id="impedance-mismatch" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#impedance-mismatch" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>The combination of defined/undefined stereocenters and chiral flag notation is somewhat unique to V2000 molfile. This idiosyncrasy can complicate the format&rsquo;s interconversion. For example, SMILES is a widely-used format devoid of the concept of chiral flag. What protocol should be used to translate a molfile containing multiple defined stereocenters, but with a chiral flag set to Off? Similar considerations apply when generating <a href="/articles/2021/05/19/standard-inchi/">Standard InChIs</a>, and many other formats.</p>
<p>This problem is compounded by the V2000 semantics around undefined stereocenters. Recall that these must be interpreted as one of three possibilities: pure isomer A; pure isomer B; or a mixture of both configurations. The SMILES documentation is silent on the meaning of stereocenters whose configuration is not defined. Although one organization might choose to use the same semantics, another organization might choose another interpretation. And things can get really dicey should a third format such as <a href="/articles/2021/04/07/an-introduction-to-the-chemdraw-cdxml-format/">CDXML</a> or <a href="https://www.xml-cml.org" target="_blank">CML</a> become involved.</p>
<p>For some real-world examples of the trouble that can arise through simple conversions of SMILES and V2000 molfile, see:</p>
<ul>
<li><a href="https://openmolecules.org/forum/index.php?t=msg&amp;goto=361&amp;" target="_blank">Chrial drawn structures in dwar / sdf different</a></li>
<li><a href="https://github.com/Actelion/openchemlib/issues/61" target="_blank">Different IDCodes for SMILES and MDL MOL</a></li>
</ul>
<p>It is likely that each organization facing this problem will arrive at its own solution. Although these solutions may be internally consistent in the short run, they can become internally inconsistent over the long run through turnover and loss of institutional memory. And it&rsquo;s extremely unlikely that two organizations will choose exactly the same solutions. The net effect will be data loss and confusion when organizations attempt to collaborate with each other, and even when an organization attempts to collaborate with its future self.</p>


<h1 class="relative group">Conclusion 
    <div id="conclusion" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#conclusion" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>V2000 supports stereochemical configuration through two features: stereocenters and the chiral flag. Stereocenters are defined by pointing the narrow end of a stereobond at them. Otherwise, a stereocenter will be undefined. The global chiral flag attribute only modifies the interpretation of defined stereocenters, but in subtle and easily misinterpreted ways. These stereochemical idiosyncrasies are likely to cause data loss during interconversion of certain kinds of V2000 files with other formats, especially those involving vague semantics around undefined or partially-defined configurations.</p>

          
          
          
        </div>
        
        

        
        

          
      </div>
     
      
      
        
        
          
          
        
      <script>
        var oid = "views_posts\/2021-12-29-stereochemistry-and-the-v2000-molfile-format.md"
        var oid_likes = "likes_posts\/2021-12-29-stereochemistry-and-the-v2000-molfile-format.md"
      </script>
      
      
      <script type="text/javascript" src="/js/page.min.0860cf4e04fa2d72cc33ddba263083464d48f67de06114529043cb4623319efed4f484fd7f1730df5abea0e2da6f3538855634081d02f2d6e920b956f063e823.js" integrity="sha512-CGDPTgT6LXLMM926JjCDRk1I9n3gYRRSkEPLRiMxnv7U9IT9fxcw31q&#43;oOLabzU4hVY0CB0C8tbpILlW8GPoIw=="></script>
      
  
    </section>
  <footer class="pt-8 max-w-prose print:hidden">

    
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group mr-3" href="/articles/2021/12/16/a-beginners-guide-to-parsing-in-rust/">
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >A Beginner's Guide to Parsing in Rust</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2021-12-16T18:00:00&#43;00:00">December 16, 2021</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="flex text-right group ml-3" href="/articles/2022/01/12/penny-codes/">
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Penny Codes</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2022-01-12T14:00:00&#43;00:00">January 12, 2022</time>
                  
                </span>
              </span>
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


    
  </footer>
</article>

      <div id="top-scroller" class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0">
  <a href="#the-top"
    class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top" title="Scroll to top">
    &uarr;
  </a>
</div>
    </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
  
  <div class="flex items-center justify-between">

    
    
    <p class="text-sm text-neutral-500 dark:text-neutral-400">
      &copy;
      2024
      
    </p>
    

    
    
    <p class="text-xs text-neutral-500 dark:text-neutral-400">
      
      
      Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a>
    </p>
    

  </div>
  <script>
    
    mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
      margin: 24,
      background: 'rgba(0,0,0,0.5)',
      scrollOffset: 0,
    })
    
  </script>
  
  
  <script type="text/javascript" src="/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js" integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]"
  data-url="http://localhost:1313/"
  style="z-index:500"
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)"
      >
        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

  </div>
</body>

</html>
