<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>PubCouch: Create Your Own Custom PubChem Subset | Depth-First</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="If you&rsquo;ve ever worked with the PubChem dataset, you may have found yourself wanting to create a custom subset that filters out certain records. This article, the fourth in a continuing series, shows a very simple way to create a custom PubChem dataset using PubCouch.
The Problem
I really like PubChem. It&rsquo;s the world&rsquo;s largest collection of freely-downloadable chemical structures and an excellent use of taxpayer dollars.
But PubChem has faced some tough tradeoffs over the years., one of the foremost being how inclusive it should be. In other words, when to say &rsquo;no&rsquo; to a substance depositor. I won&rsquo;t rehash the details here, but suffice it to say that the technologies on which PubChem is based are limited in important ways (for example: organometallics).">
    <meta name="generator" content="Hugo 0.139.4">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    
      <meta name="author" content = "Richard L. Apodaca">
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    

    
      

    

    

    
      <link rel="canonical" href="http://localhost:1313/articles/2010/02/04/pubcouch-create-your-own-custom-pubchem-subset/">
    

    <meta property="og:url" content="http://localhost:1313/articles/2010/02/04/pubcouch-create-your-own-custom-pubchem-subset/">
  <meta property="og:site_name" content="Depth-First">
  <meta property="og:title" content="PubCouch: Create Your Own Custom PubChem Subset">
  <meta property="og:description" content="If you’ve ever worked with the PubChem dataset, you may have found yourself wanting to create a custom subset that filters out certain records. This article, the fourth in a continuing series, shows a very simple way to create a custom PubChem dataset using PubCouch.
The Problem I really like PubChem. It’s the world’s largest collection of freely-downloadable chemical structures and an excellent use of taxpayer dollars.
But PubChem has faced some tough tradeoffs over the years., one of the foremost being how inclusive it should be. In other words, when to say ’no’ to a substance depositor. I won’t rehash the details here, but suffice it to say that the technologies on which PubChem is based are limited in important ways (for example: organometallics).">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2010-02-04T00:00:00+00:00">
    <meta property="article:modified_time" content="2010-02-04T00:00:00+00:00">

  <meta itemprop="name" content="PubCouch: Create Your Own Custom PubChem Subset">
  <meta itemprop="description" content="If you’ve ever worked with the PubChem dataset, you may have found yourself wanting to create a custom subset that filters out certain records. This article, the fourth in a continuing series, shows a very simple way to create a custom PubChem dataset using PubCouch.
The Problem I really like PubChem. It’s the world’s largest collection of freely-downloadable chemical structures and an excellent use of taxpayer dollars.
But PubChem has faced some tough tradeoffs over the years., one of the foremost being how inclusive it should be. In other words, when to say ’no’ to a substance depositor. I won’t rehash the details here, but suffice it to say that the technologies on which PubChem is based are limited in important ways (for example: organometallics).">
  <meta itemprop="datePublished" content="2010-02-04T00:00:00+00:00">
  <meta itemprop="dateModified" content="2010-02-04T00:00:00+00:00">
  <meta itemprop="wordCount" content="514">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="PubCouch: Create Your Own Custom PubChem Subset">
  <meta name="twitter:description" content="If you’ve ever worked with the PubChem dataset, you may have found yourself wanting to create a custom subset that filters out certain records. This article, the fourth in a continuing series, shows a very simple way to create a custom PubChem dataset using PubCouch.
The Problem I really like PubChem. It’s the world’s largest collection of freely-downloadable chemical structures and an excellent use of taxpayer dollars.
But PubChem has faced some tough tradeoffs over the years., one of the foremost being how inclusive it should be. In other words, when to say ’no’ to a substance depositor. I won’t rehash the details here, but suffice it to say that the technologies on which PubChem is based are limited in important ways (for example: organometallics).">

	
  </head><body class="ma0 avenir bg-near-white development">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Depth-First
      
    </a>
    <div class="flex-l items-center">
      

      
      <div class="ananke-socials"></div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Posts
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1">PubCouch: Create Your Own Custom PubChem Subset</h1>
      
      <p class="tracked">
        By <strong>Richard L. Apodaca</strong>
      </p>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2010-02-04T00:00:00Z">February 4, 2010</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>If you&rsquo;ve ever worked with the PubChem dataset, you may have found yourself wanting to create a custom subset that filters out certain records. This article, the fourth in a <a href="http://depth-first.com/articles/2010/01/20/pubcouch-a-couchdb-interface-to-pubchem">continuing series</a>, shows a very simple way to create a custom PubChem dataset using <a href="http://github.com/metamolecular/pubcouch">PubCouch</a>.</p>
<h1 id="the-problem">The Problem</h1>
<p>I really like PubChem. It&rsquo;s the world&rsquo;s largest collection of freely-downloadable chemical structures and an excellent use of taxpayer dollars.</p>
<p>But PubChem has faced some tough tradeoffs over the years., one of the foremost being how inclusive it should be. In other words, when to say &rsquo;no&rsquo; to a substance depositor. I won&rsquo;t rehash the details here, but suffice it to say that the technologies on which PubChem is based are limited in important ways (for example: <a href="http://depth-first.com/articles/2006/12/12/the-problem-with-ferrocene">organometallics</a>).</p>
<p>As part of ongoing work to expand <a href="http://chempedia.com">Chempedia</a>, the free chemical substance registry, I became interested in the possibility of building a subset of the PubChem Compound registry that only contained structures that could be safely encoded by the MDL Molfile specification. Call it &ldquo;PubChem: The Good Parts.&rdquo;</p>
<p>This database was likely to be huge and pretty non-relational. It looked like a perfect job for PubCouch.</p>
<h1 id="a-solution">A Solution</h1>
<p>The software to solve this problem has been built into PubCouch. There are a couple of ways to run it, but I find one of the simplest is to use JRuby:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git clone git@github.com:metamolecular/pubcouch.git
</span></span><span style="display:flex;"><span>cd pubcouch
</span></span><span style="display:flex;"><span>ant jar
</span></span><span style="display:flex;"><span>jruby -S rake compounds:snapshot
</span></span></code></pre></div><p>To get that last part working, you&rsquo;ll need to <a href="http://jruby.org/getting-started">install JRuby</a>. This is optional; you could also create an Ant task or use some other script. The point is that we&rsquo;re running a pre-packaged PubCouch task called &ldquo;Compounds&rdquo;.</p>
<p>There&rsquo;s one more thing - you&rsquo;ll obviously need CouchDB installed, and you&rsquo;ll need an empty database called &ldquo;compounds&rdquo;. The database name can be changed to fit your preferences.</p>
<p>Finally, the way this works is likely to change in the future. To be sure you&rsquo;ll be able to access the code describe here, please use <a href="http://github.com/metamolecular/pubcouch/commit/8208a82f42815c15b8a5207db91725bb97e01242">this commit</a>.</p>
<h1 id="filtering">Filtering</h1>
<p>After running the snapshot task, you&rsquo;ll see some output indicating Compound IDs being checked and written.</p>
<p>Not every compound is being written. Only those passing a specific set of requirements will end up in CouchDB:</p>
<ol>
<li>No bond annotations other than &lsquo;aromatic&rsquo;.</li>
<li>No multicomponent (disconnected) Compounds.</li>
<li>No undefined stereochemistry.</li>
<li>No charged species.</li>
</ol>
<p>These happen to be my requirements - yours will probably differ somewhat. To change the applied filter, simply change the method Compounds.StrictFilter.pass. It&rsquo;s that simple.</p>
<h1 id="fine-tuning">Fine-Tuning</h1>
<p>This is all pretty rough at this point. There are many opportunities to refine the code for flexibility and performance. For example, I initially experimented with CouchDB&rsquo;s <a href="http://wiki.apache.org/couchdb/HTTP_Bulk_Document_API">bulk update</a> capability, which compresses multiple writes into a single HTTP request. But this actually resulted in more memory/processor usage. My guess is that this was probably less due to CouchDB than it was to the JSON overhead in the <a href="http://code.google.com/p/jcouchdb/">JCouchDB</a> library I&rsquo;m using to talk to CouchDB. Your results may vary.</p>
<h1 id="conclusions">Conclusions</h1>
<p>PubChem is an excellent free resource for raw chemical structures, if filtered correctly. This article showed how to create your own personal subset of PubChem using PubCouch.</p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://localhost:1313/" >
    &copy;  Depth-First 2024 
  </a>
    <div><div class="ananke-socials"></div>
</div>
  </div>
</footer>

  </body>
</html>
