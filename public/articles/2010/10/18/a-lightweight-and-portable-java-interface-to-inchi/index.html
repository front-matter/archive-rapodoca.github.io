<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>A Lightweight and Portable Java Interface to InChI | Depth-First</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="If you work in cheminformatics and you use Java, you&rsquo;ll eventually face the problem of how to generate InChIs in Java. This blog has covered a few approaches to integrating InChI over the years, including the use of SWIG to statically link to the InChI code and NestedVM to compile the InChI C source into Java bytecode. NestedVM ports much better than SWIG, but at the price of a  performance penalty on the order of 10-20 fold. What if we could have the best of both performance and portability when using InChI with Java? This article shows one way to do it.">
    <meta name="generator" content="Hugo 0.139.4">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    

    
      

    

    

    
      <link rel="canonical" href="http://localhost:1313/articles/2010/10/18/a-lightweight-and-portable-java-interface-to-inchi/">
    

    <meta property="og:url" content="http://localhost:1313/articles/2010/10/18/a-lightweight-and-portable-java-interface-to-inchi/">
  <meta property="og:site_name" content="Depth-First">
  <meta property="og:title" content="A Lightweight and Portable Java Interface to InChI">
  <meta property="og:description" content="If you work in cheminformatics and you use Java, you’ll eventually face the problem of how to generate InChIs in Java. This blog has covered a few approaches to integrating InChI over the years, including the use of SWIG to statically link to the InChI code and NestedVM to compile the InChI C source into Java bytecode. NestedVM ports much better than SWIG, but at the price of a performance penalty on the order of 10-20 fold. What if we could have the best of both performance and portability when using InChI with Java? This article shows one way to do it.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2010-10-18T00:00:00+00:00">
    <meta property="article:modified_time" content="2010-10-18T00:00:00+00:00">

  <meta itemprop="name" content="A Lightweight and Portable Java Interface to InChI">
  <meta itemprop="description" content="If you work in cheminformatics and you use Java, you’ll eventually face the problem of how to generate InChIs in Java. This blog has covered a few approaches to integrating InChI over the years, including the use of SWIG to statically link to the InChI code and NestedVM to compile the InChI C source into Java bytecode. NestedVM ports much better than SWIG, but at the price of a performance penalty on the order of 10-20 fold. What if we could have the best of both performance and portability when using InChI with Java? This article shows one way to do it.">
  <meta itemprop="datePublished" content="2010-10-18T00:00:00+00:00">
  <meta itemprop="dateModified" content="2010-10-18T00:00:00+00:00">
  <meta itemprop="wordCount" content="554">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="A Lightweight and Portable Java Interface to InChI">
  <meta name="twitter:description" content="If you work in cheminformatics and you use Java, you’ll eventually face the problem of how to generate InChIs in Java. This blog has covered a few approaches to integrating InChI over the years, including the use of SWIG to statically link to the InChI code and NestedVM to compile the InChI C source into Java bytecode. NestedVM ports much better than SWIG, but at the price of a performance penalty on the order of 10-20 fold. What if we could have the best of both performance and portability when using InChI with Java? This article shows one way to do it.">

	
  </head><body class="ma0 avenir bg-near-white development">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Depth-First
      
    </a>
    <div class="flex-l items-center">
      

      
      <div class="ananke-socials"></div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Posts
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1">A Lightweight and Portable Java Interface to InChI</h1>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2010-10-18T00:00:00Z">October 18, 2010</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>If you work in cheminformatics and you use Java, you&rsquo;ll eventually face the problem of <a href="http://depth-first.com/articles/2008/12/10/mr-inchi-tear-down-this-wall">how to generate InChIs in Java</a>. This blog has covered a few approaches to integrating InChI over the years, including the use of <a href="http://depth-first.com/articles/2006/09/16/taking-a-swig-of-inchi">SWIG to statically link to the InChI code</a> and <a href="http://depth-first.com/articles/2007/12/03/from-c-source-code-to-platform-independent-executable-jarfile-using-nestedvm-to-build-jinchi">NestedVM to compile the InChI C source into Java bytecode</a>. NestedVM ports much better than SWIG, but at the price of a  performance penalty on the order of 10-20 fold. What if we could have the best of both performance and portability when using InChI with Java? This article shows one way to do it.</p>
<h1 id="adapting-a-solution">Adapting a Solution</h1>
<p>The approach we&rsquo;ll take in this article is based on <a href="http://depth-first.com/articles/2008/05/30/a-simple-and-portable-ruby-interface-to-inchi-part-2-silencing-console-output">a portable interface to InChI in Ruby</a> that was presented here a while back. That solution was based on using an operating system shell to invoke the InChI executable from Ruby.</p>
<h1 id="a-lightweight-java-interface-to-inchi">A Lightweight Java Interface to InChI</h1>
<p>Java has long had the ability to execute arbitrary binaries through <!-- raw HTML omitted -->Runtime.getRuntime().exec()<!-- raw HTML omitted -->. We can even execute these binaries within a shell environment, giving the ability to use pipes and other high-level features. The only prerequisite is to have the InChI command-line program accessible on our path.</p>
<p>Putting <!-- raw HTML omitted -->Runtime.getRuntime().exec()<!-- raw HTML omitted --> together with some syntactic sugar gives the Java class below:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">import</span> java.io.InputStreamReader;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.io.BufferedReader;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.io.FileReader;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.io.IOException;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">InChI</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> BufferedReader <span style="color:#a6e22e">runInChI</span>(String molfile) <span style="color:#66d9ef">throws</span> IOException {
</span></span><span style="display:flex;"><span>    String<span style="color:#f92672">[]</span> command <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;/bin/sh&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;-c&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;echo \&#34;&#34;</span> <span style="color:#f92672">+</span> molfile <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;\&#34; | inchi -STDIO -AuxNone -NoLabels -Key 2&gt;/dev/null&#34;</span>
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>    Process inchi <span style="color:#f92672">=</span> Runtime.<span style="color:#a6e22e">getRuntime</span>().<span style="color:#a6e22e">exec</span>(command);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> BufferedReader(<span style="color:#66d9ef">new</span> InputStreamReader(inchi.<span style="color:#a6e22e">getInputStream</span>()));
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> String <span style="color:#a6e22e">getInChIFromMolfile</span>(String molfile) <span style="color:#66d9ef">throws</span> IOException {
</span></span><span style="display:flex;"><span>    BufferedReader input <span style="color:#f92672">=</span> runInChI(molfile);
</span></span><span style="display:flex;"><span>    String result <span style="color:#f92672">=</span> input.<span style="color:#a6e22e">readLine</span>();      
</span></span><span style="display:flex;"><span>    input.<span style="color:#a6e22e">close</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> result <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">?</span> <span style="color:#e6db74">&#34;&#34;</span> : result;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> String <span style="color:#a6e22e">getInChIKeyFromMolfile</span>(String molfile) <span style="color:#66d9ef">throws</span> IOException {
</span></span><span style="display:flex;"><span>    BufferedReader input <span style="color:#f92672">=</span> runInChI(molfile);
</span></span><span style="display:flex;"><span>    input.<span style="color:#a6e22e">readLine</span>();
</span></span><span style="display:flex;"><span>    String result <span style="color:#f92672">=</span> input.<span style="color:#a6e22e">readLine</span>();
</span></span><span style="display:flex;"><span>    input.<span style="color:#a6e22e">close</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> result <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">?</span> <span style="color:#e6db74">&#34;&#34;</span> : result.<span style="color:#a6e22e">substring</span>(9);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> String <span style="color:#a6e22e">readFile</span>(String filename) <span style="color:#66d9ef">throws</span> IOException {
</span></span><span style="display:flex;"><span>    BufferedReader in <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> BufferedReader(<span style="color:#66d9ef">new</span> FileReader(filename));
</span></span><span style="display:flex;"><span>    String str <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>    String molfile <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> ((str <span style="color:#f92672">=</span> in.<span style="color:#a6e22e">readLine</span>()) <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>      molfile <span style="color:#f92672">=</span> molfile <span style="color:#f92672">+</span> str <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;\n&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    in.<span style="color:#a6e22e">close</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> molfile;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String<span style="color:#f92672">[]</span> args) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>      String molfile <span style="color:#f92672">=</span> readFile(args<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(getInChIFromMolfile(molfile));
</span></span><span style="display:flex;"><span>      System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(getInChIKeyFromMolfile(molfile));
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> (IOException ignore) {
</span></span><span style="display:flex;"><span>      ignore.<span style="color:#a6e22e">printStackTrace</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }  
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>You can test this code by saving it to a file called <strong>InChI.java</strong> and compiling it:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>javac InChI.java
</span></span></code></pre></div><p>and then running it:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>java InChI path/to/molfile
</span></span></code></pre></div><h1 id="caveats">Caveats</h1>
<p>Lightweight and (mostly) portable though it may be, the approach described here does have limitations. First, if you&rsquo;re on Windows, you&rsquo;ll need to adapt it. The change shouldn&rsquo;t be difficult and we could even add runtime platform detection to decide whether to run the Unix or Windows flavor of <!-- raw HTML omitted -->Runtime.getRuntime().exec()<!-- raw HTML omitted -->. Another limitation is that this code should never be used to run untrusted input files. A few properly placed characters would be enough for an attacker to run arbitrary commands. One solution would be to apply a character whitelist for molfile input. Another limitation: this approach will not work in sandboxed environments such as a browser running the Java Plugin.</p>
<h1 id="conclusions">Conclusions</h1>
<p>With a few lines of Java we&rsquo;ve created a lightweight interface to the InChI library. Although not without limitations, it offers the quickest and easiest way to begin working with InChI in Java. But why bother? Future articles will offer some ideas.</p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://localhost:1313/" >
    &copy;  Depth-First 2024 
  </a>
    <div><div class="ananke-socials"></div>
</div>
  </div>
</footer>

  </body>
</html>
