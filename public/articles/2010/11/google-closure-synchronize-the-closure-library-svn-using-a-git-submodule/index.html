<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Google Closure - Synchronize the Closure Library SVN Using a Git Submodule | Depth-First</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="The last post in this series introduced Google Closure, a suite of JavaScript tools for building and maintaining complex JavaScript projects. Whether you&rsquo;re just starting out with Closure or have been using it awhile, an important problem you&rsquo;ll have to solve is how to keep your copy of the Closure Library up-to-date with the Google Closure SVN. This article describes one method for doing so using git.
All Articles in this Series

Google Closure - Building Complex Applications with JavaScript
Synchronize the Closure Library SVN Using a Git Submodule

A Little About the Closure Library
Google Closure goes beyond any JavaScript toolkit in its functionality and scope. Many JavaScript libraries such as jQuery, Dojo, and Prototype are mainly just that - libraries. In addition to offering library functionality more advanced than most other JavaScript toolkits, Closure offers two other components that set it apart: the Closure Compiler and Soy Templates. This article will only discuss creating and maintaining a copy of the Closure Library. Future articles may discuss working with these other tools.">
    <meta name="generator" content="Hugo 0.139.4">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    

    
      

    

    

    
      <link rel="canonical" href="http://localhost:1313/articles/2010/11/google-closure-synchronize-the-closure-library-svn-using-a-git-submodule/">
    

    <meta property="og:url" content="http://localhost:1313/articles/2010/11/google-closure-synchronize-the-closure-library-svn-using-a-git-submodule/">
  <meta property="og:site_name" content="Depth-First">
  <meta property="og:title" content="Google Closure - Synchronize the Closure Library SVN Using a Git Submodule">
  <meta property="og:description" content="The last post in this series introduced Google Closure, a suite of JavaScript tools for building and maintaining complex JavaScript projects. Whether you’re just starting out with Closure or have been using it awhile, an important problem you’ll have to solve is how to keep your copy of the Closure Library up-to-date with the Google Closure SVN. This article describes one method for doing so using git.
All Articles in this Series Google Closure - Building Complex Applications with JavaScript Synchronize the Closure Library SVN Using a Git Submodule A Little About the Closure Library Google Closure goes beyond any JavaScript toolkit in its functionality and scope. Many JavaScript libraries such as jQuery, Dojo, and Prototype are mainly just that - libraries. In addition to offering library functionality more advanced than most other JavaScript toolkits, Closure offers two other components that set it apart: the Closure Compiler and Soy Templates. This article will only discuss creating and maintaining a copy of the Closure Library. Future articles may discuss working with these other tools.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="articles">
    <meta property="article:published_time" content="2010-11-29T00:00:00+00:00">
    <meta property="article:modified_time" content="2010-11-29T00:00:00+00:00">

  <meta itemprop="name" content="Google Closure - Synchronize the Closure Library SVN Using a Git Submodule">
  <meta itemprop="description" content="The last post in this series introduced Google Closure, a suite of JavaScript tools for building and maintaining complex JavaScript projects. Whether you’re just starting out with Closure or have been using it awhile, an important problem you’ll have to solve is how to keep your copy of the Closure Library up-to-date with the Google Closure SVN. This article describes one method for doing so using git.
All Articles in this Series Google Closure - Building Complex Applications with JavaScript Synchronize the Closure Library SVN Using a Git Submodule A Little About the Closure Library Google Closure goes beyond any JavaScript toolkit in its functionality and scope. Many JavaScript libraries such as jQuery, Dojo, and Prototype are mainly just that - libraries. In addition to offering library functionality more advanced than most other JavaScript toolkits, Closure offers two other components that set it apart: the Closure Compiler and Soy Templates. This article will only discuss creating and maintaining a copy of the Closure Library. Future articles may discuss working with these other tools.">
  <meta itemprop="datePublished" content="2010-11-29T00:00:00+00:00">
  <meta itemprop="dateModified" content="2010-11-29T00:00:00+00:00">
  <meta itemprop="wordCount" content="1037">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Google Closure - Synchronize the Closure Library SVN Using a Git Submodule">
  <meta name="twitter:description" content="The last post in this series introduced Google Closure, a suite of JavaScript tools for building and maintaining complex JavaScript projects. Whether you’re just starting out with Closure or have been using it awhile, an important problem you’ll have to solve is how to keep your copy of the Closure Library up-to-date with the Google Closure SVN. This article describes one method for doing so using git.
All Articles in this Series Google Closure - Building Complex Applications with JavaScript Synchronize the Closure Library SVN Using a Git Submodule A Little About the Closure Library Google Closure goes beyond any JavaScript toolkit in its functionality and scope. Many JavaScript libraries such as jQuery, Dojo, and Prototype are mainly just that - libraries. In addition to offering library functionality more advanced than most other JavaScript toolkits, Closure offers two other components that set it apart: the Closure Compiler and Soy Templates. This article will only discuss creating and maintaining a copy of the Closure Library. Future articles may discuss working with these other tools.">

	
  </head><body class="ma0 avenir bg-near-white development">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Depth-First
      
    </a>
    <div class="flex-l items-center">
      

      
      <div class="ananke-socials"></div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Articles
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1">Google Closure - Synchronize the Closure Library SVN Using a Git Submodule</h1>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2010-11-29T00:00:00Z">November 29, 2010</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>The last post in this series <a href="/articles/2010/11/22/google-closure-building-complex-applications-with-javascript/">introduced Google Closure</a>, a suite of JavaScript tools for building and maintaining complex JavaScript projects. Whether you&rsquo;re just starting out with Closure or have been using it awhile, an important problem you&rsquo;ll have to solve is how to keep your copy of the Closure Library up-to-date with the Google Closure SVN. This article describes one method for doing so using git.</p>
<h1 id="all-articles-in-this-series">All Articles in this Series</h1>
<ol>
<li><a href="/articles/2010/11/22/google-closure-building-complex-applications-with-javascript/">Google Closure - Building Complex Applications with JavaScript</a></li>
<li>Synchronize the Closure Library SVN Using a Git Submodule</li>
</ol>
<h1 id="a-little-about-the-closure-library">A Little About the Closure Library</h1>
<p>Google Closure goes beyond any JavaScript toolkit in its functionality and scope. Many JavaScript libraries such as <a href="http://jquery.com/">jQuery</a>, <a href="http://www.dojotoolkit.org/">Dojo</a>, and <a href="http://www.prototypejs.org/">Prototype</a> are mainly just that - libraries. In addition to offering library functionality more advanced than most other JavaScript toolkits, Closure offers two other components that set it apart: the <a href="http://code.google.com/closure/compiler/">Closure Compiler</a> and <a href="http://code.google.com/closure/templates">Soy Templates</a>. This article will only discuss creating and maintaining a copy of the Closure Library. Future articles may discuss working with these other tools.</p>
<h1 id="use-case">Use Case</h1>
<p><a href="http://chemwriter.com/signups/new">ChemWriter 2</a> is a rewrite of my company&rsquo;s web-based chemical structure editor from Java to JavaScript.  When it became clear that we&rsquo;d be using Closure to create ChemWriter 2, we know we&rsquo;d need a way to continuously merge changes to the Closure Library into our source tree.</p>
<p>The Closure Library is enormous. We didn&rsquo;t want to directly keep the Closure source in the ChemWriter repository due to its size. We also knew we&rsquo;d be using git, whereas the Closure Library team uses Subversion as its public-facing version control system.</p>
<p>We needed a way to do the following:</p>
<ol>
<li>Use the Closure Library from within the ChemWriter project without committing and tracking the Closure Library source directly.</li>
<li>Synchronize the Closure Library SVN repository with our own clone of the Closure Library maintained with git.</li>
</ol>
<p>To my knowledge, the Closure team has not yet produced a release of either the Closure Library or other tools, so for now pulling source directly from repositories is the only way to go.</p>
<h1 id="submodules-to-the-rescue">Submodules to the Rescue</h1>
<p>Git submodules turned out to the be answer to the biggest part of the problems above. For the unfamiliar, a submodule enables one repository to be embedded within another repository. From <a href="http://www.kernel.org/pub/software/scm/git/docs/git-submodule.html">the documentation</a>:</p>
<blockquote>
<p>Submodules allow foreign repositories to be embedded within a dedicated subdirectory of the source tree, always pointed at a particular commit.</p>
<p>They are not to be confused with remotes, which are meant mainly for branches of the same project; submodules are meant for different projects you would like to make part of your source tree, while the history of the two projects still stays completely independent and you cannot modify the contents of the submodule from within the main project. If you want to merge the project histories and want to treat the aggregated whole as a single project from then on, you may want to add a remote for the other project and use the subtree merge strategy, instead of treating the other project as a submodule. Directories that come from both projects can be cloned and checked out as a whole if you choose to go that route.</p>
</blockquote>
<p>Great - we&rsquo;ve got a way to track changes to the Closure Library without bloating our own repository with all that foreign code. But how do we create and maintain an up-to-date git repository containing the Closure Library to start with?</p>
<h1 id="forking-the-closure-library">Forking the Closure Library</h1>
<p>Fortunately, StackOverflow helps out with an <a href="http://stackoverflow.com/questions/796991/fork-and-sync-google-code-svn-into-github">answer to the question of how to fork and sync a Google Code Subversion repository using Git</a>. We&rsquo;re going to use Git&rsquo;s built-in ability to manipulate SVN repositories by creating our own fork.</p>
<p>Pick a place to host the Closure Library fork. Then:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git svn clone http://closure-library.googlecode.com/svn/trunk/ closure-library -s
</span></span></code></pre></div><p>It&rsquo;s that simple. My company uses a <a href="https://github.com/metamolecular/closure-library">public-facing Closure Library clone</a>. We set it up with two commands:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git remote add origin git@github.com:metamolecular/closure-library.git
</span></span><span style="display:flex;"><span>git push origin master
</span></span></code></pre></div><p>As you can see, all changes to our public Closure Library clone track the changes to the original SVN repo maintained by Google itself.</p>
<h1 id="updating-your-closure-library-git-clone">Updating Your Closure Library Git Clone</h1>
<p>The same StackOverflow question that discusses forking an SVN repo into Git also reveals how to push changes to it. We simply change into our local closure-library directory and execute:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git svn rebase
</span></span><span style="display:flex;"><span>git push
</span></span></code></pre></div><p>We synchronize our public Closure Library git repo with the official Google SVN weekly using the above two commands. Doing so regularly helps to ensure that we&rsquo;re always compiling and testing ChemWriter against an up-to-date version of the Closure Library.</p>
<p>So far, we haven&rsquo;t had the need (or desire) to alter the Closure Library ourselves. But should the need arise, we can use this system to push any changes we make out to our public git repo.</p>
<h1 id="a-closure-library-submodule">A Closure Library Submodule</h1>
<p>We have a synchronized git clone of the Closure Library. Now we need to create a submodule from it in a test project. Let&rsquo;s start out by creating an empty git repository:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir test
</span></span><span style="display:flex;"><span>cd test
</span></span><span style="display:flex;"><span>git init .
</span></span></code></pre></div><p>We can now add the closure-library submodule:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git submodule add git@github.com:metamolecular/closure-library.git lib/closure
</span></span></code></pre></div><p>This tells git to store our submodule in lib/closure at the top level of our project. To store it elsewhere, replace the last argument with your path of choice. Remember, although git will know about this submodule, the Closure Library files themselves will not be stored in our project repository.</p>
<p>When cloning this project, it will be necessary to pull in and configure the closure-library submodule with:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git submodule init
</span></span><span style="display:flex;"><span>git submodule update
</span></span></code></pre></div><p>We&rsquo;ve created a Closure Library submodule, but how do we propagate changes from our cloned git repository?</p>
<h1 id="synchronizing-the-submodule">Synchronizing the Submodule</h1>
<p>After synchronizing our git clone of the Closure Library SVN repository, we&rsquo;ll need to pull those changes into our closure-library submodule. Fortunately, there&rsquo;s nothing tricky here, although the solution may not be at first glance obvious. From within our test project:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd lib/closure
</span></span><span style="display:flex;"><span>git pull
</span></span><span style="display:flex;"><span>cd ../..
</span></span></code></pre></div><h1 id="conclusions">Conclusions</h1>
<p>The article has described one way to set up and synchronize the Google Closure Library in your own JavaScript project. But how do we actually code against this library in our project? Future articles will show one way by describing up a build system.</p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://localhost:1313/" >
    &copy;  Depth-First 2024 
  </a>
    <div><div class="ananke-socials"></div>
</div>
  </div>
</footer>

  </body>
</html>
