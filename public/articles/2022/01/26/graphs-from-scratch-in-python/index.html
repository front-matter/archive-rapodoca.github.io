<!DOCTYPE html>
<html lang="en-us" dir="ltr" class="scroll-smooth" data-default-appearance="light"
  data-auto-appearance="true"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  
  <meta http-equiv="content-language" content="en-us" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>Graphs from Scratch in Python &middot; Depth-First</title>
  <meta name="title" content="Graphs from Scratch in Python &middot; Depth-First" />
  
  <meta name="description" content="Boiling the complexity of graphs down to a few methods, then implementing them." />
  
  
  
  <link rel="canonical" href="http://localhost:1313/articles/2022/01/26/graphs-from-scratch-in-python/" />
  
  
  
  
  
  
  
  
  
  
  <link type="text/css" rel="stylesheet" href="/css/main.bundle.min.e27868ab1485f7ed7b06b122b4980bd38b19526eb8f7de885181204d28f04a0c47e9c334eff19a06c0278eb2ff8415b983a5d0fb80fd6b5680c926457cc61c57.css"
    integrity="sha512-4nhoqxSF9&#43;17BrEitJgL04sZUm64996IUYEgTSjwSgxH6cM07/GaBsAnjrL/hBW5g6XQ&#43;4D9a1aAySZFfMYcVw==" />
  
  
  <script type="text/javascript" src="/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js"
    integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj&#43;e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script>
  
  
  
  
  
  
  
  
  
  
  
  <script defer type="text/javascript" id="script-bundle" src="/js/main.bundle.min.c178288131a2f1ad46910438db47ac5f7e1c48cf949e49f6dc3310c8ec9660e23fe505805eba4e2e73711335808500360d773a2b64322feb35df52856edca286.js"
    integrity="sha512-wXgogTGi8a1GkQQ420esX34cSM&#43;Unkn23DMQyOyWYOI/5QWAXrpOLnNxEzWAhQA2DXc6K2QyL&#43;s131KFbtyihg==" data-copy="" data-copied=""></script>
  
  
  
  <script src="/lib/zoom/zoom.min.37d2094687372da3f7343a221a470f6b8806f7891aa46a5a03966af7f0ebd38b9fe536cb154e6ad28f006d184b294525a7c4054b6bbb4be62d8b453b42db99bd.js" integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S&#43;Yti0U7QtuZvQ=="></script>
  
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="manifest" href="/site.webmanifest" />
  
  
  
  
  
  
  
  
  <meta property="og:url" content="http://localhost:1313/articles/2022/01/26/graphs-from-scratch-in-python/">
  <meta property="og:site_name" content="Depth-First">
  <meta property="og:title" content="Graphs from Scratch in Python">
  <meta property="og:description" content="Boiling the complexity of graphs down to a few methods, then implementing them.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2022-01-26T17:30:00+00:00">
    <meta property="article:modified_time" content="2022-01-26T17:30:00+00:00">

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Graphs from Scratch in Python">
  <meta name="twitter:description" content="Boiling the complexity of graphs down to a few methods, then implementing them.">

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "Graphs from Scratch in Python",
    "headline": "Graphs from Scratch in Python",
    
    "abstract": "Boiling the complexity of graphs down to a few methods, then implementing them.",
    "inLanguage": "en-us",
    "url" : "http:\/\/localhost:1313\/articles\/2022\/01\/26\/graphs-from-scratch-in-python\/",
    "author" : {
      "@type": "Person",
      "name": ""
    },
    "copyrightYear": "2022",
    "dateCreated": "2022-01-26T17:30:00\u002b00:00",
    "datePublished": "2022-01-26T17:30:00\u002b00:00",
    
    "dateModified": "2022-01-26T17:30:00\u002b00:00",
    
    
    
    "mainEntityOfPage": "true",
    "wordCount": "2826"
  }]
  </script>


  
  
  
  
  

<script src="/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js" integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj&#43;KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script>






















  
  



  
  
  <meta name="theme-color"/>
  
  
</head>
<body
  class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
  <div id="the-top" class="absolute flex self-center">
    <a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
      href="#main-content"><span
        class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a>
  </div>
  
  
  <div style="padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px"
    class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3">
    
    <div class="flex flex-1 items-center justify-between">
        <nav class="flex space-x-3">

            
            <a href="/" class="text-base font-medium text-gray-500 hover:text-gray-900">Depth-First</a>
            

        </nav>
        <nav class="hidden md:flex items-center space-x-5 md:ml-12 h-12">

            

            


            
            <button id="search-button" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            


            
            
            <div
                class="ltr:mr-14 rtl:ml-14 flex items-center">
                <button id="appearance-switcher" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400">
                    <div class="flex items-center justify-center dark:hidden">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                    </div>
                    <div class="items-center justify-center hidden dark:flex">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                    </div>
                </button>
            </div>
            

        </nav>
        <div class="flex md:hidden items-center space-x-5 md:ml-12 h-12">

            <span></span>

            


            
            <button id="search-button-mobile" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            

            
            
            <button id="appearance-switcher-mobile" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400" style="margin-right:5px">
                <div class="flex items-center justify-center dark:hidden">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                </div>
                <div class="items-center justify-center hidden dark:flex">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                </div>
            </button>
            

        </div>
    </div>
    <div class="-my-2 -mr-2 md:hidden">

        <label id="menu-button" class="block">
            

            </div>
        </label>
    </div>
</div>





  
  <div class="relative flex flex-col grow">
    <main id="main-content" class="grow">
      


<article>
  

  <header id="single_header" class="mt-5 max-w-prose">
    
    <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
      Graphs from Scratch in Python
    </h1>
    <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
      





  
  







  





  



  













<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2022-01-26T17:30:00&#43;00:00">January 26, 2022</time><span class="px-2 text-primary-500">&middot;</span><span>2826 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">14 mins</span>
  

  
  
</div>








    </div>

    
    
    
    
    

    

    
      
      
        
        
<div class="flex author">
  
  <div class="place-self-center">
    
    
    <div class="text-2xl sm:text-lg">
</div>
  </div>
</div>

      

      

      
      <div class="mb-5"></div>
      

    

  </header>
  
  <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
    
    

      <div class="min-w-0 min-h-0 max-w-fit">
        
        


        <div class="article-content max-w-prose mb-20">
          <p>Graphs are central to many areas of programming, so it&rsquo;s not surprising to find many general-purpose graph libraries. But these ready-made solutions sometimes lack the focus needed to solve specific problem well. Having hit this problem several times, I recently proposed a solution in the form of a <a href="/articles/2020/01/06/a-minimal-graph-api/">minimal graph API</a> with a <a href="/articles/2020/02/17/graphs-in-rust-introducting-graphcore/">Rust implementation</a>. The idea is to maximize reusability by distilling a graph&rsquo;s essence to the smallest possible set of methods.</p>
<p>This article extends the idea to Python. Because graphs draw from so many areas of computer science, they make excellent test subjects for the intermediate-level programming language student. Along these lines, this article touches on concepts including the Python data model, iterators, generators, list comprehension, abstract base classes, protocols, complexity analysis, and type hints. For those interested in code first, <a href="https://github.com/rapodaca/pygraph" target="_blank">a companion repository</a> is available at GitHub.</p>


<h1 class="relative group">A Minimal Graph API 
    <div id="a-minimal-graph-api" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#a-minimal-graph-api" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>A graph can be viewed as a set of nodes and a set of pairwise relationships, or edges, between them. The simplest possible API for a graph would therefore contain just two operations: iterate all nodes and iterate all edges. However, such a spartan API would not support doing any of the things that make graphs interesting. What&rsquo;s needed in addition are operations for counting, testing membership, and testing connectivity. The following minimal set of graph operations is based on the one I <a href="/articles/2020/01/06/a-minimal-graph-api/">previously proposed</a>.</p>
<ol>
<li>Iterate all nodes.</li>
<li>Return the node count (&ldquo;order&rdquo;).</li>
<li>Test whether any nodes are present (&ldquo;empty&rdquo;).</li>
<li>Test whether a node is a present (&ldquo;membership&rdquo;).</li>
<li>Iterate all edges.</li>
<li>Return the edge count (&ldquo;size&rdquo;).</li>
<li>Test whether an edge exists (&ldquo;connectivity&rdquo;).</li>
<li>Iterate the nodes connected to a given node (&ldquo;neighborhood&rdquo;).</li>
<li>Return the count of nodes attached to a given node (&ldquo;degree&rdquo;).</li>
<li>Return a debugging string.</li>
</ol>
<p>This set is provably complete in the sense that it supports the two fundamental operations: iterating nodes (1) and iterating edges (5). The set also includes convenience operations for counting items, testing connectivity, and membership. A Python object mapping the above operations to methods could be used within any solvable graph problem.</p>
<p>But isn&rsquo;t this API too narrow? Popular libraries offer graphs with far more than just ten methods. Keep in mind that the ten operations can be composed limitlessly. Especially useful combinations can be bundled into functions and distributed as a library.</p>
<p>Some problem domains require graphs with special capabilities. In my field, chemistry, graphs model molecular structure with nodes modeling atoms and edges modeling bonding relationships. In such applications, the minimal API can be extended. Restricting methods to those fundamental to the problem domain will yield a flexible, but lean result.</p>
<p>The idea of a &ldquo;lean,&rdquo; or minimal, API may not seem important. After all, what difference does it make whether a function is attached to a class (as a method) or accepts a class instance (as a function)? That distinction will become clearer after addressing the question of reducing the minimal graph API to practice.</p>


<h1 class="relative group">A Graph Protocol 
    <div id="a-graph-protocol" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#a-graph-protocol" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Python has been described as a &ldquo;protocol-oriented&rdquo; language. A <em>protocol</em> is a collection of methods useful for some purpose. A similar idea can be found in many languages: Java has interfaces, C++ has abstract classes, and Rust has traits.</p>
<p>A protocol can be implicit in the sense that a function might assume that an argument supports a specific set of methods. This assumption might even be stated in the documentation, but that&rsquo;s the extent of it. The function behaves as if the methods are present. If they&rsquo;re not the interpreter raises a runtime error. This is called &ldquo;<a href="https://en.wikipedia.org/wiki/Duck_typing" target="_blank">duck typing</a>.&rdquo;</p>
<p>It&rsquo;s also possible to define a protocol explicitly using the <code>Protocol</code> <a href="https://docs.python.org/3/library/typing.html" target="_blank">type hint</a>. This approach makes it easier to structure documentation. But more than this, an explicit protocol can be analyzed by Python type checkers. These type checkers can themselves be integrated into developer tools to reveal type errors before runtime. This way of working has a lot in common with <a href="/articles/2021/11/03/typed-javascript/">Typed Javascript</a>.</p>
<p>The following <code>Protocol</code> translates the minimum graph API to a Python Protocol.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> typing <span style="color:#f92672">import</span> Iterator, Protocol, Tuple
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">graph</span>(Protocol):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __len__(self) <span style="color:#f92672">-&gt;</span> int:
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Return the node count.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __contains__(self, id: int) <span style="color:#f92672">-&gt;</span> bool:
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Test whether a node is present.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __iter__(self) <span style="color:#f92672">-&gt;</span> Iterator[int]:
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Iterate all nodes.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __repr__(self) <span style="color:#f92672">-&gt;</span> str:
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Return a debugging string.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">iteredges</span>(self) <span style="color:#f92672">-&gt;</span> Iterator[Tuple[int, int]]:
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Iterate all edges.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">size</span>(self) <span style="color:#f92672">-&gt;</span> int:
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Return the edge count.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">iterneighbors</span>(self, id: int) <span style="color:#f92672">-&gt;</span> Iterator[int]:
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Iterate the neighbors of a node.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">degree</span>(self, id: int) <span style="color:#f92672">-&gt;</span> int:
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Return the count of nodes attached to a node.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">has_edge</span>(self, sid: int, tid: int) <span style="color:#f92672">-&gt;</span> bool:
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Test whether an edge exists.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">...</span>
</span></span></code></pre></div><p>This protocol reflects a collection-centric view in which a <code>Graph</code> contains zero or more integer node identifiers (&ldquo;ids&rdquo;). Ids can be counted, tested for membership, and iterated by virtue of the <a href="https://docs.python.org/3/reference/datamodel.html#special-method-names" target="_blank">special methods</a> <code>__len__</code>, <code>__contains__</code>, and <code>__iter__</code>, respectively. A debug string is available through <code>__repr__</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test_graph</span>(graph: Graph):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> id <span style="color:#f92672">in</span> graph:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;Found node id&#34;</span>, id)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Sorted node list&#34;</span>, sorted(graph))
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Unsorted node list&#34;</span>, [id <span style="color:#66d9ef">for</span> id <span style="color:#f92672">in</span> graph])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> graph:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;Graph is not empty.&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;Graph is empty.&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#ae81ff">42</span> <span style="color:#f92672">in</span> graph:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;So special!&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;Not so special.&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Here I am&#34;</span>, repr(graph))
</span></span></code></pre></div><p>This concept goes by the name of &ldquo;data model.&rdquo; The Python data model links classes, special methods, built-in functions and types, and protocols into a cohesive whole. For an excellent treatment of this topic see this talk by <a href="https://twitter.com/dontusethiscode" target="_blank">James Powell</a>.</p>
<!-- raw HTML omitted -->
<p>What remains of the <code>Graph</code> protocol is implemented without special methods, but with Python idioms and conventions in mind. For example, a simple way to reveal edges would be to return a list of tuples. But that&rsquo;s not what <code>Graph</code> does. Instead, it returns an iterator of tuples. As we&rsquo;ll see, this offers flexibility to implementors of <code>Graph</code>, without restricting the uses of the return value:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">report_edges</span>(graph: Graph):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> sid, tid <span style="color:#f92672">in</span> graph<span style="color:#f92672">.</span>iteredges():
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Found edge (</span><span style="color:#e6db74">{</span>sid<span style="color:#e6db74">}</span><span style="color:#e6db74">, </span><span style="color:#e6db74">{</span>tid<span style="color:#e6db74">}</span><span style="color:#e6db74">).&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;A list of bonds:&#34;</span>, list(graph<span style="color:#f92672">.</span>iteredges()))
</span></span></code></pre></div><p>The same applies to reporting neighbors:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">report_neighbors</span>(id: int, graph: Graph):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> tid <span style="color:#f92672">in</span> graph<span style="color:#f92672">.</span>iterneighbors(id):
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Found neighbor </span><span style="color:#e6db74">{</span>tid<span style="color:#e6db74">}</span><span style="color:#e6db74">.&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;A list of neighbors:&#34;</span>, list(graph<span style="color:#f92672">.</span>iterneighbors(id)))
</span></span></code></pre></div><p>Bundled with <code>Graph</code> are five custom exceptions that are raised either in the context of constructing or using a <code>Graph</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DuplicateNode</span>(<span style="color:#a6e22e">Exception</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Raised when building a graph with duplicate nodes.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DuplicateEdge</span>(<span style="color:#a6e22e">Exception</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Raised when building a graph with duplicate edges.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Loop</span>(<span style="color:#a6e22e">Exception</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Raised when building a graph with with a loop.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UnknownNode</span>(<span style="color:#a6e22e">Exception</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Raised when accessing a node whose id is not found.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">HalfEdge</span>(<span style="color:#a6e22e">Exception</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Raised when building an adjacency-style graph without a back edge.&#34;&#34;&#34;</span>
</span></span></code></pre></div><p>Let&rsquo;s make this discussion of the <code>Graph</code> protocol more concrete with an implementation.</p>


<h1 class="relative group">AdjacencyList 
    <div id="adjacencylist" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#adjacencylist" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>An <a href="https://en.wikipedia.org/wiki/Adjacency_list" target="_blank">adjacency list</a> is a graph implementation that associates each node with a list of neighbors. This pattern is implemented by the <code>AdjacencyList</code> class.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> typing <span style="color:#f92672">import</span> Iterator, Tuple
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> pygraph.graph <span style="color:#f92672">import</span> DuplicateEdge, HalfEdge, Loop, UnknownNode
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AdjacencyList</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, adjacency: dict[int, list[int]]):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> sid, tids <span style="color:#f92672">in</span> adjacency<span style="color:#f92672">.</span>items():
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> tid <span style="color:#f92672">in</span> tids:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>                    sids <span style="color:#f92672">=</span> adjacency[tid]
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">KeyError</span>:
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">raise</span> UnknownNode
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> sid <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> sids:
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">raise</span> HalfEdge
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">elif</span> tids<span style="color:#f92672">.</span>count(tid) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">raise</span> DuplicateEdge
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">elif</span> tid <span style="color:#f92672">==</span> sid:
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">raise</span> Loop
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_adjacency <span style="color:#f92672">=</span> dict(adjacency)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __len__(self) <span style="color:#f92672">-&gt;</span> int:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> len(self<span style="color:#f92672">.</span>_adjacency)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __contains__(self, id: int) <span style="color:#f92672">-&gt;</span> bool:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> id <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>_adjacency
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __iter__(self) <span style="color:#f92672">-&gt;</span> Iterator[int]:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> iter(self<span style="color:#f92672">.</span>_adjacency<span style="color:#f92672">.</span>keys())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __repr__(self) <span style="color:#f92672">-&gt;</span> str:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;AdjacencyList(</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">)&#39;</span><span style="color:#f92672">.</span>format(self<span style="color:#f92672">.</span>_adjacency)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">iteredges</span>(self) <span style="color:#f92672">-&gt;</span> Iterator[Tuple[int, int]]:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> sid, tids <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>_adjacency<span style="color:#f92672">.</span>items():
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> tid <span style="color:#f92672">in</span> tids:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> sid <span style="color:#f92672">&lt;</span> tid:
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">yield</span> (sid, tid)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">iterneighbors</span>(self, id: int) <span style="color:#f92672">-&gt;</span> Iterator[int]:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> iter(self<span style="color:#f92672">.</span>_neighbors(id))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">size</span>(self) <span style="color:#f92672">-&gt;</span> int:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> sum(<span style="color:#ae81ff">1</span> <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>iteredges())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">degree</span>(self, id: int) <span style="color:#f92672">-&gt;</span> int:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> len(self<span style="color:#f92672">.</span>_neighbors(id))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">has_edge</span>(self, sid: int, tid: int) <span style="color:#f92672">-&gt;</span> bool:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> tid <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> self:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">raise</span> UnknownNode
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> tid <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>_neighbors(sid)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_neighbors</span>(self, id: int) <span style="color:#f92672">-&gt;</span> list[int]:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>            result <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_adjacency[id]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">KeyError</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">raise</span> UnknownNode
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> result
</span></span></code></pre></div><p><code>AdjacencyList</code> is backed by a <code>dict[int, list[int]]</code>, or a mapping of node id to neighbor list. This data structure by itself offers a remarkably good match to the minimal graph API, as can be seen from the delegated methods <code>__len__</code>, <code>__contains__</code>, <code>__iter__</code>, <code>iterneighbors</code>, and <code>degree</code>.</p>
<p>The remaining methods illustrate mismatches between a raw dict and the minimal graph API. Take, for example, <code>iteredges</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">iteredges</span>(self) <span style="color:#f92672">-&gt;</span> Iterator[Tuple[int, int]]:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> sid, tids <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>_adjacency<span style="color:#f92672">.</span>items():
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> tid <span style="color:#f92672">in</span> tids:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> sid <span style="color:#f92672">&lt;</span> tid:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">yield</span> (sid, tid)
</span></span></code></pre></div><p>The backing dict doesn&rsquo;t offer a direct method for edge iteration. Fortunately, a short <a href="https://wiki.python.org/moin/Generators" target="_blank">generator</a> can be used instead. No temporary collections (e.g, list or set) are required to avoid iterating non-unique edges. Instead, we use a trick that simply checks that the source id is less than the target id before yielding. This approach has the added advantage of always iterating edges in the same sense and direction.</p>
<p>Given that <code>AdjacencyList</code> uses a clone of the dict passed to it through the constructor, the <code>__init__</code> method may seem overly busy. What&rsquo;s happening here is a check to ensure that the dict does not contain any of the following bad encodings: a non-member neighbor; a half-edge (sid-&gt;tid without tid-&gt;sid); a duplicate edge; or a loop (edge to self).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> __init__(self, adjacency: dict[int, list[int]]):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> sid, tids <span style="color:#f92672">in</span> adjacency<span style="color:#f92672">.</span>items():
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> tid <span style="color:#f92672">in</span> tids:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>                sids <span style="color:#f92672">=</span> adjacency[tid]
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">KeyError</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">raise</span> UnknownNode
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> sid <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> sids:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">raise</span> HalfEdge
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">elif</span> tids<span style="color:#f92672">.</span>count(tid) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">raise</span> DuplicateEdge
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">elif</span> tid <span style="color:#f92672">==</span> sid:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">raise</span> Loop
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    self<span style="color:#f92672">.</span>_adjacency <span style="color:#f92672">=</span> dict(adjacency)
</span></span></code></pre></div><p>Three methods, <code>iterneighbors</code>, <code>degree</code>, and <code>has_edge</code> call a private helper method, <code>_neighbors</code>. The sole purpose of doing so is to avoid the duplication that would result from transforming the built-in <code>KeyError</code> into the custom <code>UnknownNode</code> exception.</p>
<p>The sailing has been pretty smooth with <code>AdjacencyList</code>. Now let&rsquo;s consider an implementation that trades a simpler backing data type for a more complex implementation.</p>


<h1 class="relative group">EdgeList 
    <div id="edgelist" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#edgelist" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>An <a href="https://en.wikipedia.org/wiki/Edge_list" target="_blank">edge list</a> views a graph as a list of edges. <code>EdgeList</code> implements this idea.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> typing <span style="color:#f92672">import</span> Iterator, Tuple
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> pygraph.graph <span style="color:#f92672">import</span> DuplicateEdge, Loop, UnknownNode
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">EdgeList</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, edges: list[Tuple[int, int]]):
</span></span><span style="display:flex;"><span>        seen <span style="color:#f92672">=</span> set()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (sid, tid) <span style="color:#f92672">in</span> edges:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (sid, tid) <span style="color:#f92672">in</span> seen <span style="color:#f92672">or</span> (tid, sid) <span style="color:#f92672">in</span> seen:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">raise</span> DuplicateEdge
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">elif</span> sid <span style="color:#f92672">==</span> tid:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">raise</span> Loop
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            seen<span style="color:#f92672">.</span>add((sid, tid))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_edges <span style="color:#f92672">=</span> list(edges)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __len__(self) <span style="color:#f92672">-&gt;</span> int:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> sum(<span style="color:#ae81ff">1</span> <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>_nodes())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __contains__(self, id: int) <span style="color:#f92672">-&gt;</span> bool:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> sid, tid <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>_edges:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> id <span style="color:#f92672">==</span> sid <span style="color:#f92672">or</span> id <span style="color:#f92672">==</span> tid:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __iter__(self) <span style="color:#f92672">-&gt;</span> Iterator[int]:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> iter(self<span style="color:#f92672">.</span>_nodes())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __repr__(self) <span style="color:#f92672">-&gt;</span> str:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;EdgeList(</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">)&#39;</span><span style="color:#f92672">.</span>format(self<span style="color:#f92672">.</span>_edges)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">iteredges</span>(self) <span style="color:#f92672">-&gt;</span> Iterator[Tuple[int, int]]:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> iter(self<span style="color:#f92672">.</span>_edges)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">size</span>(self) <span style="color:#f92672">-&gt;</span> int:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> len(self<span style="color:#f92672">.</span>_edges)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">iterneighbors</span>(self, id: int) <span style="color:#f92672">-&gt;</span> Iterator[int]:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> iter(self<span style="color:#f92672">.</span>_neighbors(id))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">degree</span>(self, id: int) <span style="color:#f92672">-&gt;</span> int:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> sum(<span style="color:#ae81ff">1</span> <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>_neighbors(id))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">has_edge</span>(self, sid: int, tid: int) <span style="color:#f92672">-&gt;</span> bool:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> sid <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> self <span style="color:#f92672">or</span> tid <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> self:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">raise</span> UnknownNode
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> edge <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>_edges:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> edge[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> sid <span style="color:#f92672">and</span> edge[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">==</span> tid:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">elif</span> edge[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">==</span> sid <span style="color:#f92672">and</span> edge[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> tid:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_neighbors</span>(self, id: int) <span style="color:#f92672">-&gt;</span> Iterator[int]:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> id <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> self:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">raise</span> UnknownNode
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>_mates(id)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_mates</span>(self, id: int) <span style="color:#f92672">-&gt;</span> Iterator[int]:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> sid, tid <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>_edges:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> id <span style="color:#f92672">==</span> sid:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">yield</span> tid
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">elif</span> id <span style="color:#f92672">==</span> tid:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">yield</span> sid
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_nodes</span>(self) <span style="color:#f92672">-&gt;</span> Iterator[int]:
</span></span><span style="display:flex;"><span>        seen <span style="color:#f92672">=</span> set()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> sid, tid <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>_edges:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> sid <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> seen:
</span></span><span style="display:flex;"><span>                seen<span style="color:#f92672">.</span>add(sid)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">yield</span> sid
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> tid <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> seen:
</span></span><span style="display:flex;"><span>                seen<span style="color:#f92672">.</span>add(tid)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">yield</span> tid
</span></span></code></pre></div><p>The main advantage of <code>EdgeList</code> is the simplicity and low cost of its backing store, which is just a <code>list[Tuple[int, int]]</code>. The main disadvantage is almost everything else. Although edges can be iterated and counted with pure delegation, the remaining methods require greater computational complexity.</p>
<p>These difficulties are such that <code>EdgeList</code> defines two private helper methods: <code>_neighbors</code>, a two part function-generator pair to to iterate the neighbors of a node; and <code>_nodes</code> to iterate the set of <code>Graph</code> member node ids.</p>
<p>The result is that certain method calls are more inefficient than they aught to be. Consider <code>__len__</code>. Just counting member nodes or testing membership has a time complexity of <em>O(n)</em>, where <em>n</em> is the number of edges.</p>
<p>Still, <code>EdgeList</code> offers the advantage of efficient operations over the set of all edges. Recall that this was something <code>AdjacencyList</code> wasn&rsquo;t very good at. Maybe it&rsquo;s possible to get the best of both worlds.</p>


<h1 class="relative group">Hybrid 
    <div id="hybrid" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#hybrid" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>The node-centered efficiency of <code>AdjacencyList</code> can be combined with the edge-centered efficiency of <code>EdgeList</code> with <code>Hybrid</code>. An instance of this class will be backed by both an adjacency list and an edge list generated from it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> typing <span style="color:#f92672">import</span> Iterator, Tuple
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> pygraph.graph <span style="color:#f92672">import</span> HalfEdge, Loop, UnknownNode
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Hybrid</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, adjacency: dict[int, list[int]]):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_edges <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> sid, tids <span style="color:#f92672">in</span> adjacency<span style="color:#f92672">.</span>items():
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> tid <span style="color:#f92672">in</span> tids:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>                    sids <span style="color:#f92672">=</span> adjacency[tid]
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">KeyError</span>:
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">raise</span> UnknownNode
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> sid <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> sids:
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">raise</span> HalfEdge
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">elif</span> sid <span style="color:#f92672">==</span> tid:
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">raise</span> Loop
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">elif</span> sid <span style="color:#f92672">&lt;</span> tid:
</span></span><span style="display:flex;"><span>                    self<span style="color:#f92672">.</span>_edges<span style="color:#f92672">.</span>append((sid, tid))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_adjacency <span style="color:#f92672">=</span> dict(adjacency)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __len__(self) <span style="color:#f92672">-&gt;</span> int:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> len(self<span style="color:#f92672">.</span>_adjacency)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __contains__(self, id: int) <span style="color:#f92672">-&gt;</span> bool:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> id <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>_adjacency
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __iter__(self) <span style="color:#f92672">-&gt;</span> Iterator[int]:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> iter(self<span style="color:#f92672">.</span>_adjacency<span style="color:#f92672">.</span>keys())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __repr__(self) <span style="color:#f92672">-&gt;</span> str:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;Hybrid(</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">)&#39;</span><span style="color:#f92672">.</span>format(self<span style="color:#f92672">.</span>_adjacency)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">iteredges</span>(self) <span style="color:#f92672">-&gt;</span> Iterator[Tuple[int, int]]:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> iter(self<span style="color:#f92672">.</span>_edges)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">size</span>(self) <span style="color:#f92672">-&gt;</span> int:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> len(self<span style="color:#f92672">.</span>_edges)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">iterneighbors</span>(self, id: int) <span style="color:#f92672">-&gt;</span> Iterator[int]:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> iter(self<span style="color:#f92672">.</span>_neighbors(id))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">degree</span>(self, id: int) <span style="color:#f92672">-&gt;</span> int:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> len(self<span style="color:#f92672">.</span>_neighbors(id))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">has_edge</span>(self, sid: int, tid: int) <span style="color:#f92672">-&gt;</span> bool:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> tid <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> self:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">raise</span> UnknownNode
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> tid <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>_neighbors(sid)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_neighbors</span>(self, id: int) <span style="color:#f92672">-&gt;</span> list[int]:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>            result <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_adjacency[id]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">KeyError</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">raise</span> UnknownNode
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> result
</span></span></code></pre></div><p>The main difference with <code>AdjacencyList</code> is that <code>Hybrid</code> stores a list of edges, simplifying the implementation of <code>iteredges</code> and <code>size</code>, and decreasing the time complexity of <code>size</code> to <em>O(1)</em>.</p>


<h1 class="relative group">Whither Abstract Base Classes? 
    <div id="whither-abstract-base-classes" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#whither-abstract-base-classes" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>There&rsquo;s one other way to make a protocol explicit: an <a href="https://docs.python.org/3/library/abc.html" target="_blank">Abstract Base Class</a> (ABC). An ABC is a class that defines one or more abstract methods to be implemented by subclasses.</p>
<p>It&rsquo;s possible to declare <code>Graph</code> as an ABC like so.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> abc <span style="color:#f92672">import</span> ABC
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Graph</span>(ABC):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pass</span>
</span></span></code></pre></div><p>The distinction between <code>Protocol</code> and <code>ABC</code> is both subtle and important. A <code>Protocol</code> requires nothing from a conforming class other than a set of methods. An ABC, on the other hand, requires an inheritance relationship.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pygraph <span style="color:#f92672">import</span> Graph
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ConcreteGraph</span>(Graph):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># method overrides</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pass</span>
</span></span></code></pre></div><p>Under ABC, a class can implement all <code>Graph</code> methods and still be rejected by the type checker if it fails to also inherit from <code>Graph</code>. Using Protocol, however, any class with a conforming interface will be considered a valid <code>Graph</code>.</p>
<p>I bring this up because of the unfortunate fact of graph life that many algorithms are computationally demanding. One way to improve performance is to implement those algorithms in a fast language such as C, C++, or Rust. (I&rsquo;ll have more to say about <code>Graph</code> and Rust in future articles.) Depending on the tooling around that low-level implementation, it may not be feasible to ensure an inheritance relationship with a <code>graph</code> ABC. For now, the advantage goes to Protocol.</p>


<h1 class="relative group">Other Graph Implementations 
    <div id="other-graph-implementations" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#other-graph-implementations" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>It may not seem like it, but there&rsquo;s a lot more to implementing <code>Graph</code> than what&rsquo;s been discussed here. That&rsquo;s because there are so many different kinds of graphs. Consider a <a href="/articles/2019/04/02/the-maximum-matching-problem/">matching</a>, which is a graph in which every node has degree one. An <code>AdjacencyList</code> would certainly do the job, but it would be overkill. A backing <code>dict[int, int]</code> would do the job more efficiently and simply. Similar considerations apply for other specialized graphs.</p>
<p>Higher complexity is also possible. This article doesn&rsquo;t deal with the topic of loops, parallel edges or directed edges. Although the minimal graph API is compatible with them, concrete implementations may not be. This can lead to conflict should, for example, a function accepting a <code>Graph</code> as an argument assume that loops are disallowed whereas an implementation does not. For this reason, a <code>Graph</code> Protocol must declare its assumptions about disallowed graph features so that subclasses can behave accordingly.</p>


<h1 class="relative group">Consistency and Cohesion 
    <div id="consistency-and-cohesion" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#consistency-and-cohesion" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>The existence of a <code>Graph</code> Protocol makes it possible to write code that works with a well-defined interface, disregarding any and all implementation details of the underlying graph object. This article has outlined some clear advantages with regard to Python, but there&rsquo;s more to it than that. Graph capabilities factor prominently in the early stages of problem formulation. Even pseudocode uses a graph API, although it may not be defined anywhere. Graphs are, of course, used within every programming language. A common set of capabilities across all of the contexts in which graphs appear can benefit not just specific implementations, but designs and ideas.</p>
<p>A simple language around graph capabilities, used consistently, offers cohesion and reuse potential that&rsquo;s hard to achieve otherwise.</p>


<h1 class="relative group">Conclusion 
    <div id="conclusion" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#conclusion" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Although graph theory is a complex topic, the behavior of graph-like objects need not be. Just ten operations suffice to define all of the behaviors associated with graphs. Codifying these behaviors as a <code>Python</code> protocol allows functions to focus on fundamental behaviors rather than implementation idiosyncrasies. Limiting the scope of the <code>Graph</code> protocol makes multiple special-purpose implementations practical. More broadly, a common vocabulary around graph behavior means that concepts, algorithms, and designs developed on one platform can readily be adapted to others.</p>

          
          
          
        </div>
        
        

        
        

          
      </div>
     
      
      
        
        
          
          
        
      <script>
        var oid = "views_posts\/2022-01-26-graphs-from-scratch-in-python.md"
        var oid_likes = "likes_posts\/2022-01-26-graphs-from-scratch-in-python.md"
      </script>
      
      
      <script type="text/javascript" src="/js/page.min.0860cf4e04fa2d72cc33ddba263083464d48f67de06114529043cb4623319efed4f484fd7f1730df5abea0e2da6f3538855634081d02f2d6e920b956f063e823.js" integrity="sha512-CGDPTgT6LXLMM926JjCDRk1I9n3gYRRSkEPLRiMxnv7U9IT9fxcw31q&#43;oOLabzU4hVY0CB0C8tbpILlW8GPoIw=="></script>
      
  
    </section>
  <footer class="pt-8 max-w-prose print:hidden">

    
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group mr-3" href="/articles/2022/01/12/penny-codes/">
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Penny Codes</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2022-01-12T14:00:00&#43;00:00">January 12, 2022</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="flex text-right group ml-3" href="/articles/2022/02/09/v3000-molfile-enhanced-stereochemistry-representation/">
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >V3000 Molfile Enhanced Stereochemistry Representation</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2022-02-09T20:00:00&#43;00:00">February 9, 2022</time>
                  
                </span>
              </span>
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


    
  </footer>
</article>

      <div id="top-scroller" class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0">
  <a href="#the-top"
    class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top" title="Scroll to top">
    &uarr;
  </a>
</div>
    </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
  
  <div class="flex items-center justify-between">

    
    
    <p class="text-sm text-neutral-500 dark:text-neutral-400">
      &copy;
      2024
      
    </p>
    

    
    
    <p class="text-xs text-neutral-500 dark:text-neutral-400">
      
      
      Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a>
    </p>
    

  </div>
  <script>
    
    mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
      margin: 24,
      background: 'rgba(0,0,0,0.5)',
      scrollOffset: 0,
    })
    
  </script>
  
  
  <script type="text/javascript" src="/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js" integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]"
  data-url="http://localhost:1313/"
  style="z-index:500"
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)"
      >
        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

  </div>
</body>

</html>
