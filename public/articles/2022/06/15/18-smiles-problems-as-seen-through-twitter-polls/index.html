<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>18 SMILES Problems as Seen through Twitter Polls | Depth-First</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="Understanding the problem is the first step toward solving it.">
    <meta name="generator" content="Hugo 0.139.4">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    
      <meta name="author" content = "Richard L. Apodaca">
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    

    
      

    

    

    
      <link rel="canonical" href="http://localhost:1313/articles/2022/06/15/18-smiles-problems-as-seen-through-twitter-polls/">
    

    <meta property="og:url" content="http://localhost:1313/articles/2022/06/15/18-smiles-problems-as-seen-through-twitter-polls/">
  <meta property="og:site_name" content="Depth-First">
  <meta property="og:title" content="18 SMILES Problems as Seen through Twitter Polls">
  <meta property="og:description" content="Understanding the problem is the first step toward solving it.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2022-06-15T16:30:00+00:00">
    <meta property="article:modified_time" content="2022-06-15T16:30:00+00:00">

  <meta itemprop="name" content="18 SMILES Problems as Seen through Twitter Polls">
  <meta itemprop="description" content="Understanding the problem is the first step toward solving it.">
  <meta itemprop="datePublished" content="2022-06-15T16:30:00+00:00">
  <meta itemprop="dateModified" content="2022-06-15T16:30:00+00:00">
  <meta itemprop="wordCount" content="1514">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="18 SMILES Problems as Seen through Twitter Polls">
  <meta name="twitter:description" content="Understanding the problem is the first step toward solving it.">

	
  </head><body class="ma0 avenir bg-near-white development">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Depth-First
      
    </a>
    <div class="flex-l items-center">
      

      
      <div class="ananke-socials"></div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Posts
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1">18 SMILES Problems as Seen through Twitter Polls</h1>
      
      <p class="tracked">
        By <strong>Richard L. Apodaca</strong>
      </p>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2022-06-15T16:30:00Z">June 15, 2022</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>SMILES is a de facto standard for chemical data exchange. It&rsquo;s routinely found in public-facing databases, supported by most widely-used cheminformatics toolkits, and for the last few years has even appeared in the context of machine learning. The problem is that the language was never completely specified.</p>
<p>The claim that one of chemistry&rsquo;s most important data formats is incompletely specified may seem extraordinary. As Carl Sagan so famously put it, extraordinary claims require extraordinary evidence. <a href="https://github.com/rapodaca/dialect">A paper I&rsquo;m working on</a> presents this evidence, outlines some implications, and offers practical solution. But there&rsquo;s another way to understand the breadth and depth of the problem: the social dimension.</p>
<p>Those who read <a href="https://twitter.com/rapodaca">my Tweets</a> have probably noticed a series of polls I&rsquo;ve been running since 2020. In this series I pose multiple-choice question about SMILES. I&rsquo;ve posted 18 of them, each typically receiving from a handful to 30 responses. I&rsquo;ve noticed some patterns in doing this and thought it might be interesting to collect everything in a single place through this post. My comments sometimes use the phrase &ldquo;the documentation,&rdquo; which refers to the documentation published by Daylight and Weininger. There&rsquo;s more <a href="/articles/2022/06/01/protosmiles/">here</a>.</p>
<p>To be clear I don&rsquo;t view these polls as necessarily representative of the wider chemistry community&rsquo;s views on SMILES. For one thing, sample size is small. For another, I&rsquo;m not sure who my followers are, their level of expertise, or how many bots are answering these polls. I do, however, note some recurring patterns in the responses that might warrant further exploration. Most importantly, though, several of these surveys generated discussions which are worth reading. Finally, the examples I chose resulted from actual problems I faced in writing a <a href="https://github.com/rapodaca/dialect">manuscript</a> and a <a href="https://github.com/rapodaca/dialect.rs">reference implementation</a> for a path forward. Each poll therefore reflect an area where the documentation is especially weak.</p>
<h1 id="chemical-elements">Chemical Elements</h1>
<p>What chemical elements does SMILES allow? The answer might surprise you. Consider this question from earlier this year:</p>
<!-- raw HTML omitted -->
<p>&ldquo;Ts&rdquo; is of course the symbol for the element <a href="https://en.wikipedia.org/wiki/Tennessine">tennessine</a>. Its addition to the periodic table by IUPAC occurred many years after everything written by Weininger or Daylight about SMILES had been published. As such, it raises the question of how SMILES should evolve. The survey reveals not just a split in opinions, but clear uncertainty on the topic.</p>
<p>Next, consider <a href="https://en.wikipedia.org/wiki/Hassium">hahnium</a>. Haven&rsquo;t heard of it? Neither had I until I started really digging into the documentation. Weininger appears to have been unaware that IUPAC resolved the long-running controversy over the naming of element 105 by replacing the symbol &ldquo;Ha&rdquo; with &ldquo;Db&rdquo; (dubnium). A periodic table he presents in one document uses the old element symbol, implying that Ha is a valid SMILES element symbol. Responders were divided.</p>
<!-- raw HTML omitted -->
<h1 id="aromaticity">Aromaticity</h1>
<p>SMILES supports a concept Weininger called &ldquo;aromaticity.&rdquo; It confusingly has little relationship to the concept of the same name in organic chemistry. Worse, aromaticity is one of the things that&rsquo;s hardest to nail down in SMILES.</p>
<p>Let&rsquo;s start with something easy first: what atoms can be marked as &ldquo;aromatic?&rdquo; Something that just about everyone knows about SMILES is that lower case atoms are &ldquo;aromatic.&rdquo; But which atoms can be marked in this way?</p>
<p>Respondents were split on the question when it comes to silicon.</p>
<!-- raw HTML omitted -->
<p>They were, however, more convinced that tellurium qualifies as an aromatic atom.</p>
<!-- raw HTML omitted -->
<p>The problem is that the documentation never says unambiguously <em>which</em> atoms can be marked aromatic. So it should come as no surprise that different people will have different ideas on the topic.</p>
<p>The star atom (&quot;*&quot;) may seem familiar and reasonable. It denotes an atom whose element is unknown. What happens when this atom appears in a SMILES aromatic ring?</p>
<!-- raw HTML omitted -->
<p>About half said that the resulting SMILES is invalid. Nothing in the documentation speaks to this notion, so I have to give the popcorn people points on this one.</p>
<p>On the other hand, strange questions arise when you really start thinking about the meaning of the star atom in aromatic systems. Consider this one.</p>
<!-- raw HTML omitted -->
<p>Only two people voted on this one, something I think might be due to <a href="https://en.wikipedia.org/wiki/2021_United_States_Capitol_attack">a recent event</a> that blew Twitter up for some time.</p>
<p>The aromatic bond (&quot;:&quot;) seems straightforward enough on the surface. But appearances can be deceiving. Although the documentation states that the bond type exists, no actual effect of its presence was offered. It&rsquo;s hard to read a lot into the survey below given the low turnout (even by the standards of the other surveys), but the first option is completely incompatible with the others, and the second two options may or may not be compatible depending on the application.</p>
<!-- raw HTML omitted -->
<p>What are the precise steps for converting an aromatic structure to a &ldquo;kekulized&rdquo; form (alternating single- and double-bonds)? The documentation says very little on the topic. This leads to a lot of confusion around what happens to existing bonds. Take the following for example.</p>
<!-- raw HTML omitted -->
<p>The correct assignment of bond orders is no trivial matter. Get it wrong and everything about the molecule could be wrong, from the formula to the molecular weight to almost every chemical property. The majority are saying that kekulization does not promote a double bond to a triple bond. The problem is that the documentation says nothing on this issue.</p>
<p>What are the implications for molecules like <a href="https://en.wikipedia.org/wiki/Aryne">benzyne</a>. How should such species be represented in SMILES using aromatic notation, if at all? Consider the following.</p>
<!-- raw HTML omitted -->
<p>The low response rate makes it harder to draw conclusions, but the majority response on this one is inconsistent with the previous one. Again, the documentation is silent on this important issue and so there will be disagreements.</p>
<p>However the aromatic form is kekulized, the procedure should be internally consistent. So what happens when a six membered ring has all aromatic atoms and explicit single bonds between each one?</p>
<!-- raw HTML omitted -->
<p>The majority says the species is an error. Oddly, no other question showed such high degree of consensus despite the results appearing at least superficially to contradict the previous two surveys. Nevertheless, nothing in the existing documentation states (or even implies) the majority view.</p>
<h1 id="hydrogen-suppression">Hydrogen Suppression</h1>
<p><a href="/articles/2020/06/08/hydrogen-suppression-in-smiles/">Hydrogen suppression</a> in SMILES takes two forms: virtual hydrogen and implicit hydrogen. The former associates an integer hydrogen count with an atom as an attribute and the latter computes an integer hydrogen count.</p>
<p>A recurring limitation in the documentation is that integer quantities lack upper and lower bounds. Virtual hydrogen count is one such property. Is a zero virtual hydrogen count allowed? If the attribute is missing it defaults to zero (e.g, &ldquo;[C]&rdquo;), but the documentation is silent on whether &ldquo;H0&rdquo; is allowed.</p>
<!-- raw HTML omitted -->
<p>The special case of a virtual hydrogen count on hydrogen itself is ambiguously treated in the documentation. The majority says it is allowed, but it&rsquo;s not hard to interpret the documentation as saying the opposite, as noted in the comments for the following survey.</p>
<!-- raw HTML omitted -->
<p>What happens when virtual hydrogen count is less than an atom&rsquo;s default valence? Respondents were not in agreement for the survey below. For its part, the documentation says nothing, so I give the &ldquo;do nothing special&rdquo; responders credit. The third response is demonstrably against the documentation.</p>
<!-- raw HTML omitted -->
<h1 id="stereochemistry">Stereochemistry</h1>
<p>SMILES supports stereochemical configuration for the simple case of tetrahedrally-arranged substituents. But what happens when a stereocenter is possible but configuration is not set? The documentation says nothing, and not surprisingly the respondents are split.</p>
<!-- raw HTML omitted -->
<p>Double bond conformation is supported through a most cumbersome mechanism of partial parity bonds. Without getting into the details, using this feature gets very difficult when combined with bridging over ring-closure bonds. The survey below is a case in point. My reading says that the response most consistent with the documentation is the first one.</p>
<!-- raw HTML omitted -->
<p>The documentation does not consider the possibility that <em>three</em> substituents might appear on a double bond terminal. As such, the response to the survey below is not surprisingly split.</p>
<!-- raw HTML omitted -->
<p><a href="http://opensmiles.org">OpenSMILES</a> was an initiative to, at least in part, address the ambiguities in the available SMILES documentation. Even so, nailing down double bond conformation is no easy task. What happens when only one of two necessary partial parity bonds are used? OpenSMILES gives no clear answer, and the responses were mixed.</p>
<!-- raw HTML omitted -->
<h1 id="conclusion">Conclusion</h1>
<p>What can be learned from this ongoing experiment so far? The main lesson I draw is that there are even today a lot of conflicting views about SMILES syntax and semantics. This should be unsettling given the important role SMILES has assumed in the modern practice of chemistry. How many <a href="https://www.go-fair.org/fair-principles/">FAIR principles</a> are at risk because the chemistry community can&rsquo;t agree on what strings purporting to be SMILES mean? <a href="https://baoilleach.blogspot.com/">Noel O&rsquo;Boyle</a> has made a start with the <a href="https://baoilleach.blogspot.com/2020/10/the-smiles-reading-benchmark-two-years.html">SMILES Reading Benchmark</a>, but I think more work is justified.</p>
<p>From time to time calls for the standardization of SMILES pop up. It may be too late for that. Many decades have elapsed since SMILES was introduced. Vendors have implemented idiosyncratic behavior, and their customers have come to rely on it. Too much of the authoritative documentation created by Weininger and Daylight is ambiguous or even self-contradictory. Too little attention has been paid to interoperability along the way. With that I&rsquo;ll end with a final survey:</p>
<!-- raw HTML omitted -->
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://localhost:1313/" >
    &copy;  Depth-First 2024 
  </a>
    <div><div class="ananke-socials"></div>
</div>
  </div>
</footer>

  </body>
</html>
