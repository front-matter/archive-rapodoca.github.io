<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>MX Performance Comparison #3: Substructure Search in MX and CDK | Depth-First</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="Substructure search is a fundamental cheminformatics operation. MX, the open source cheminformatics toolkit, contains an implementation based on the VF monomorphism algorithm. How fast is it? Let&rsquo;s compare it to CDK&rsquo;s UniversalIsomorphismTester.

The full report is available here. The full source code can be found on GitHub.
This test reads the molecules contained in a 416-record SD file into memory during setup. Then, during the test phase, each of these molecules is compared for a substructure relationship to a benzene molecule. As you can see, MX ran this test nearly five times faster than CDK.">
    <meta name="generator" content="Hugo 0.139.4">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    

    
      

    

    

    
      <link rel="canonical" href="http://localhost:1313/articles/2009/01/22/mx-performance-comparison-%233-substructure-search-in-mx-and-cdk/">
    

    <meta property="og:url" content="http://localhost:1313/articles/2009/01/22/mx-performance-comparison-%233-substructure-search-in-mx-and-cdk/">
  <meta property="og:site_name" content="Depth-First">
  <meta property="og:title" content="MX Performance Comparison #3: Substructure Search in MX and CDK">
  <meta property="og:description" content="Substructure search is a fundamental cheminformatics operation. MX, the open source cheminformatics toolkit, contains an implementation based on the VF monomorphism algorithm. How fast is it? Let’s compare it to CDK’s UniversalIsomorphismTester.
The full report is available here. The full source code can be found on GitHub.
This test reads the molecules contained in a 416-record SD file into memory during setup. Then, during the test phase, each of these molecules is compared for a substructure relationship to a benzene molecule. As you can see, MX ran this test nearly five times faster than CDK.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="articles">
    <meta property="article:published_time" content="2009-01-22T00:00:00+00:00">
    <meta property="article:modified_time" content="2009-01-22T00:00:00+00:00">

  <meta itemprop="name" content="MX Performance Comparison #3: Substructure Search in MX and CDK">
  <meta itemprop="description" content="Substructure search is a fundamental cheminformatics operation. MX, the open source cheminformatics toolkit, contains an implementation based on the VF monomorphism algorithm. How fast is it? Let’s compare it to CDK’s UniversalIsomorphismTester.
The full report is available here. The full source code can be found on GitHub.
This test reads the molecules contained in a 416-record SD file into memory during setup. Then, during the test phase, each of these molecules is compared for a substructure relationship to a benzene molecule. As you can see, MX ran this test nearly five times faster than CDK.">
  <meta itemprop="datePublished" content="2009-01-22T00:00:00+00:00">
  <meta itemprop="dateModified" content="2009-01-22T00:00:00+00:00">
  <meta itemprop="wordCount" content="276">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="MX Performance Comparison #3: Substructure Search in MX and CDK">
  <meta name="twitter:description" content="Substructure search is a fundamental cheminformatics operation. MX, the open source cheminformatics toolkit, contains an implementation based on the VF monomorphism algorithm. How fast is it? Let’s compare it to CDK’s UniversalIsomorphismTester.
The full report is available here. The full source code can be found on GitHub.
This test reads the molecules contained in a 416-record SD file into memory during setup. Then, during the test phase, each of these molecules is compared for a substructure relationship to a benzene molecule. As you can see, MX ran this test nearly five times faster than CDK.">

	
  </head><body class="ma0 avenir bg-near-white development">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Depth-First
      
    </a>
    <div class="flex-l items-center">
      

      
      <div class="ananke-socials"></div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Articles
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1">MX Performance Comparison #3: Substructure Search in MX and CDK</h1>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2009-01-22T00:00:00Z">January 22, 2009</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p><a href="/articles/2008/11/13/one-of-these-things-is-not-like-the-other">Substructure search</a> is a fundamental cheminformatics operation. <a href="http://metamolecular.com/mx/">MX</a>, the open source cheminformatics toolkit, contains an implementation <a href="/articles/2008/11/17/substructure-search-from-scratch-in-java-part-1-the-atom-mapping-problem">based on</a> the <a href="/articles/2008/11/13/one-of-these-things-is-not-like-the-other">VF monomorphism algorithm</a>. How fast is it? Let&rsquo;s compare it to CDK&rsquo;s <a href="http://cheminfo.informatics.indiana.edu/~rguha/code/java/nightly/api/org/openscience/cdk/isomorphism/UniversalIsomorphismTester.html">UniversalIsomorphismTester</a>.</p>
<p><img src="/images/posts/20090122/benchmark/testcase0.jpg" alt="Benchmark" title="Benchmark"></p>
<p>The full report is available <a href="/images/posts/20090122/benchmark/index.html">here</a>. <a href="http://github.com/rapodaca/cheminfbenchmark/tree/20090122">The full source code</a> can be found on <a href="http://github.com/">GitHub</a>.</p>
<p>This test reads the molecules contained in a <a href="http://github.com/rapodaca/cheminfbenchmark/blob/c2d7d926381e1bcf0f365777861f71ff563d8ae7/data/pubchem_416_benzenes.sdf">416-record SD file</a> into memory during setup. Then, during the test phase, each of these molecules is compared for a substructure relationship to a benzene molecule. As you can see, MX ran this test nearly five times faster than CDK.</p>
<p>MX and CDK differ in the algorithms used for substructure match. Whereas MX uses a variant of VF, CDK uses a variant of Ullmann. As noted by the VF creators, these two algorithms have <a href="http://amalfi.dis.unina.it/people/vento/lavori/gbr01bm.pdf">very different performance characteristics</a>, with VF always outperforming Ullmann. The performance gap increases quickly with increasing graph size.</p>
<p>CDK will soon have a new substructure matcher <a href="http://rguha.wordpress.com/2008/11/18/java-port-of-vflib-works-and-its-blazing/">based on Rajarshi Guha&rsquo;s implementation</a>. It will be interesting to directly compare this new CDK matcher to the one used by MX.</p>
<p>As is the case with the <a href="/articles/2009/01/21/mx-performance-comparison-2-exhaustive-ring-perception-in-mx-and-cdk">MX/CDK ring perception comparison</a>, it should be noted that the MX substructure matcher implementation is optimized for readability and correctness, but not performance. A number of interesting opportunities exist for increasing the performance of the MX substructure matcher.</p>
<p>One point to note: MX and CDK differed in the number of hits found, with MX detecting all 416 and CDK finding 412. This is most likely due to the presence of isotopically-labelled benzenes in the dataset. Depending on your interpretation of a substructure match, either CDK or MX could be returning the &ldquo;correct&rdquo; answer.</p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://localhost:1313/" >
    &copy;  Depth-First 2024 
  </a>
    <div><div class="ananke-socials"></div>
</div>
  </div>
</footer>

  </body>
</html>
