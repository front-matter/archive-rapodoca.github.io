<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Hacking PubChem - Learning to Speak PUG | Depth-First</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="A previous article introduced PubChem&rsquo;s Power User Gateway (PUG), an XML-based communication channel. Although NIH kindly supplies a commented schema for PUG queries and responses, there&rsquo;s nothing like seeing real examples when learning a new language. This article will describe one method for conveniently generating PUG XML queries.
Let PubChem Build Your Query
One of the options on the PubChem search page is &ldquo;Save Query.&rdquo; As it turns out, PubChem saves queries in PUG XML (I&rsquo;ll just call it PUGML). In other words, preparing a query using the PubChem search page and saving it gives a simple method for creating PUGML queries. Let&rsquo;s try it.">
    <meta name="generator" content="Hugo 0.139.4">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    
      <meta name="author" content = "Richard L. Apodaca">
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    

    
      

    

    

    
      <link rel="canonical" href="http://localhost:1313/articles/2007/06/11/hacking-pubchem-learning-to-speak-pug/">
    

    <meta property="og:url" content="http://localhost:1313/articles/2007/06/11/hacking-pubchem-learning-to-speak-pug/">
  <meta property="og:site_name" content="Depth-First">
  <meta property="og:title" content="Hacking PubChem - Learning to Speak PUG">
  <meta property="og:description" content="A previous article introduced PubChem’s Power User Gateway (PUG), an XML-based communication channel. Although NIH kindly supplies a commented schema for PUG queries and responses, there’s nothing like seeing real examples when learning a new language. This article will describe one method for conveniently generating PUG XML queries.
Let PubChem Build Your Query One of the options on the PubChem search page is “Save Query.” As it turns out, PubChem saves queries in PUG XML (I’ll just call it PUGML). In other words, preparing a query using the PubChem search page and saving it gives a simple method for creating PUGML queries. Let’s try it.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2007-06-11T00:00:00+00:00">
    <meta property="article:modified_time" content="2007-06-11T00:00:00+00:00">

  <meta itemprop="name" content="Hacking PubChem - Learning to Speak PUG">
  <meta itemprop="description" content="A previous article introduced PubChem’s Power User Gateway (PUG), an XML-based communication channel. Although NIH kindly supplies a commented schema for PUG queries and responses, there’s nothing like seeing real examples when learning a new language. This article will describe one method for conveniently generating PUG XML queries.
Let PubChem Build Your Query One of the options on the PubChem search page is “Save Query.” As it turns out, PubChem saves queries in PUG XML (I’ll just call it PUGML). In other words, preparing a query using the PubChem search page and saving it gives a simple method for creating PUGML queries. Let’s try it.">
  <meta itemprop="datePublished" content="2007-06-11T00:00:00+00:00">
  <meta itemprop="dateModified" content="2007-06-11T00:00:00+00:00">
  <meta itemprop="wordCount" content="425">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Hacking PubChem - Learning to Speak PUG">
  <meta name="twitter:description" content="A previous article introduced PubChem’s Power User Gateway (PUG), an XML-based communication channel. Although NIH kindly supplies a commented schema for PUG queries and responses, there’s nothing like seeing real examples when learning a new language. This article will describe one method for conveniently generating PUG XML queries.
Let PubChem Build Your Query One of the options on the PubChem search page is “Save Query.” As it turns out, PubChem saves queries in PUG XML (I’ll just call it PUGML). In other words, preparing a query using the PubChem search page and saving it gives a simple method for creating PUGML queries. Let’s try it.">

	
  </head><body class="ma0 avenir bg-near-white development">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Depth-First
      
    </a>
    <div class="flex-l items-center">
      

      
      <div class="ananke-socials"></div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Posts
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1">Hacking PubChem - Learning to Speak PUG</h1>
      
      <p class="tracked">
        By <strong>Richard L. Apodaca</strong>
      </p>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2007-06-11T00:00:00Z">June 11, 2007</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>A previous article introduced PubChem&rsquo;s <a href="/articles/2007/06/04/hacking-pubchem-power-user-gateway">Power User Gateway</a> (PUG), an XML-based communication channel. Although NIH kindly supplies a <a href="ftp://ftp.ncbi.nlm.nih.gov/pubchem/specifications/pug.xsd">commented schema</a> for PUG queries and responses, there&rsquo;s nothing like seeing real examples when learning a new language. This article will describe one method for conveniently generating PUG XML queries.</p>
<h1 id="let-pubchem-build-your-query">Let PubChem Build Your Query</h1>
<p>One of the options on the <a href="http://pubchem.ncbi.nlm.nih.gov/search/search.cgi">PubChem search page</a> is &ldquo;Save Query.&rdquo; As it turns out, PubChem saves queries in PUG XML (I&rsquo;ll just call it PUGML). In other words, preparing a query using the PubChem search page and saving it gives a simple method for creating PUGML queries. Let&rsquo;s try it.</p>
<p><img src="/images/posts/20070611/screenshot.png" alt="Screenshot" title="Screenshot"></p>
<p>Using the &ldquo;Sketch&rdquo; button, draw the structure of benzimidazole. Under &ldquo;Search Type&rdquo;, select &ldquo;Substructure.&rdquo; Now click &ldquo;Save Query&rdquo;, and you&rsquo;ll download a substructure query for benzimidazole in PUGML:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">&lt;</span>?xml version=&#34;1.0&#34;?&amp;gt;
</span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;!DOCTYPE PCT-Data PUBLIC &#34;-//NCBI//NCBI PCTools/EN&#34; &#34;http://pubchem.ncbi.nlm.nih.gov/pug/pug.dtd&#34;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;PCT-Data&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;PCT-Data_input&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;PCT-InputData&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;PCT-InputData_query&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;PCT-Query&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&lt;PCT-Query_type&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;PCT-QueryType&gt;</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&lt;PCT-QueryType_css&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;PCT-QueryCompoundCS&gt;</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#f92672">&lt;PCT-QueryCompoundCS_query&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&lt;PCT-QueryCompoundCS_query_data&gt;</span>C1=CC=CC2=C1N=C[N]2<span style="color:#f92672">&lt;/PCT-QueryCompoundCS_query_data&gt;</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#f92672">&lt;/PCT-QueryCompoundCS_query&gt;</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#f92672">&lt;PCT-QueryCompoundCS_type&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&lt;PCT-QueryCompoundCS_type_subss&gt;</span>
</span></span><span style="display:flex;"><span>                      <span style="color:#f92672">&lt;PCT-CSStructure&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&lt;PCT-CSStructure_bonds</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;true&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>                      <span style="color:#f92672">&lt;/PCT-CSStructure&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&lt;/PCT-QueryCompoundCS_type_subss&gt;</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#f92672">&lt;/PCT-QueryCompoundCS_type&gt;</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#f92672">&lt;PCT-QueryCompoundCS_results&gt;</span>2000000<span style="color:#f92672">&lt;/PCT-QueryCompoundCS_results&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;/PCT-QueryCompoundCS&gt;</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&lt;/PCT-QueryType_css&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;/PCT-QueryType&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&lt;/PCT-Query_type&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/PCT-Query&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;/PCT-InputData_query&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/PCT-InputData&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/PCT-Data_input&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/PCT-Data&gt;</span>
</span></span></code></pre></div><p>The <!-- raw HTML omitted -->PCT-QueryCompoundCS_type_subss<!-- raw HTML omitted --> element will tell PUG to look for substructures.</p>
<h1 id="using-the-saved-query-with-pug">Using the Saved Query with PUG</h1>
<p>Saving this file as <!-- raw HTML omitted -->benzimidazole_sss.xml<!-- raw HTML omitted -->, lets us feed it to PUG:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -d @benzimidazole_sss.xml <span style="color:#e6db74">&#34;http://pubchem.ncbi.nlm.nih.gov/pug/pug.cgi&#34;</span>
</span></span></code></pre></div><p>and get the following PUGML response:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;!DOCTYPE PCT-Data PUBLIC &#34;-//NCBI//NCBI PCTools/EN&#34; &#34;http://pubchem.ncbi.nlm.nih.gov/pug/pug.dtd&#34;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;PCT-Data&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;PCT-Data_output&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;PCT-OutputData&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;PCT-OutputData_status&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;PCT-Status-Message&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&lt;PCT-Status-Message_status&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;PCT-Status</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;queued&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&lt;/PCT-Status-Message_status&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/PCT-Status-Message&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;/PCT-OutputData_status&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;PCT-OutputData_output&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;PCT-OutputData_output_waiting&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&lt;PCT-Waiting&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;PCT-Waiting_reqid&gt;</span>62668946396085905<span style="color:#f92672">&lt;/PCT-Waiting_reqid&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;PCT-Waiting_message&gt;</span>Structure search job was submitted<span style="color:#f92672">&lt;/PCT-Waiting_message&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&lt;/PCT-Waiting&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/PCT-OutputData_output_waiting&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;/PCT-OutputData_output&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/PCT-OutputData&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/PCT-Data_output&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/PCT-Data&gt;</span>
</span></span></code></pre></div><p>We can then check on the status of our query by saving the following as <!-- raw HTML omitted -->status.xml<!-- raw HTML omitted -->:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>POSTing this to PUG:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -d @status.xml <span style="color:#e6db74">&#34;http://pubchem.ncbi.nlm.nih.gov/pug/pug.cgi&#34;</span>
</span></span></code></pre></div><p>gives us the following PUGML:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;!DOCTYPE PCT-Data PUBLIC &#34;-//NCBI//NCBI PCTools/EN&#34; &#34;http://pubchem.ncbi.nlm.nih.gov/pug/pug.dtd&#34;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;PCT-Data&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;PCT-Data_output&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;PCT-OutputData&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;PCT-OutputData_status&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;PCT-Status-Message&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&lt;PCT-Status-Message_status&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;PCT-Status</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;success&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&lt;/PCT-Status-Message_status&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&lt;PCT-Status-Message_message&gt;</span>Your search has already been completed successfully!.<span style="color:#f92672">&lt;/PCT-Status-Message_message&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/PCT-Status-Message&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;/PCT-OutputData_status&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;PCT-OutputData_output&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;PCT-OutputData_output_entrez&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&lt;PCT-Entrez&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;PCT-Entrez_db&gt;</span>pccompound<span style="color:#f92672">&lt;/PCT-Entrez_db&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;PCT-Entrez_query-key&gt;</span>1<span style="color:#f92672">&lt;/PCT-Entrez_query-key&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;PCT-Entrez_webenv&gt;</span>0CPrI_peUmUtWDooyjxpJ1XAXPcOl-ESZZxj8sJV9ZDR8musMjh1oBTib@1EDD43FA66AE1BE0_0001SID<span style="color:#f92672">&lt;/PCT-Entrez_webenv&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&lt;/PCT-Entrez&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/PCT-OutputData_output_entrez&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;/PCT-OutputData_output&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/PCT-OutputData&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/PCT-Data_output&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/PCT-Data&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[Last time](/articles/2007/06/04/hacking-pubchem-power-user-gateway), we got a URL to download a gzipped SD File. This time, our query specified results to be returned as an Entrez Key through the <span style="color:#f92672">&lt;code&gt;</span>PCT-Entrez_webenv<span style="color:#f92672">&lt;/code&gt;</span> element. We can construct a URL that will let us view these results:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>```bash
</span></span><span style="display:flex;"><span>http://www.ncbi.nlm.nih.gov/sites/entrez?cmd=HistorySearch<span style="color:#960050;background-color:#1e0010">&amp;</span>WebEnvRq=1<span style="color:#960050;background-color:#1e0010">&amp;</span>db=pccompound<span style="color:#960050;background-color:#1e0010">&amp;</span>query_key=1<span style="color:#960050;background-color:#1e0010">&amp;</span>WebEnv=0CPrI_peUmUtWDooyjxpJ1XAXPcOl-ESZZxj8sJV9ZDR8musMjh1oBTib%401EDD43FA66AE1BE0_0001SID
</span></span></code></pre></div><h1 id="where-to-next">Where to Next?</h1>
<p>If we wanted to get a gzipped SD File instead, we&rsquo;d need to edit our original query. But manually editing XML is a lot like mowing a lawn with scissors. What we&rsquo;d really like is a simple API in a language like Ruby that will let us build sophisticated PUG queries, process the results, and pipe them into other queries with little effort. But that&rsquo;s a story for another time.</p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://localhost:1313/" >
    &copy;  Depth-First 2024 
  </a>
    <div><div class="ananke-socials"></div>
</div>
  </div>
</footer>

  </body>
</html>
