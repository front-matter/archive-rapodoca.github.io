<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Parsing SD Files with Ruby and Rubidium | Depth-First</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="Reading SD files is a bread-and-butter cheminformatics operation. At a minimum, a cheminformatics toolkit needs to parse the individual entries of an SD file, and provide access to the embedded molfile and data hash for each.
Recent articles have introduced Rubidium, a Ruby cheminformatics scripting environment. The Rubidium team now announces the release of Rubidium-0.1.1, which, among other features, introduces the ability to parse SD files.
Prerequisites
Rubidium is designed to run on JRuby. Installing JRuby is straightforward on unix-like systems. First, download the JRuby-1.1b1 binary release. Then, unpack the archive to your directory of choice. Set $JRUBY\_HOME and $JAVA\_HOME. Finally, add $JRUBY_HOME/bin to your path.">
    <meta name="generator" content="Hugo 0.139.4">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    

    
      

    

    

    
      <link rel="canonical" href="http://localhost:1313/articles/2007/11/parsing-sd-files-with-ruby-and-rubidium/">
    

    <meta property="og:url" content="http://localhost:1313/articles/2007/11/parsing-sd-files-with-ruby-and-rubidium/">
  <meta property="og:site_name" content="Depth-First">
  <meta property="og:title" content="Parsing SD Files with Ruby and Rubidium">
  <meta property="og:description" content="Reading SD files is a bread-and-butter cheminformatics operation. At a minimum, a cheminformatics toolkit needs to parse the individual entries of an SD file, and provide access to the embedded molfile and data hash for each.
Recent articles have introduced Rubidium, a Ruby cheminformatics scripting environment. The Rubidium team now announces the release of Rubidium-0.1.1, which, among other features, introduces the ability to parse SD files.
Prerequisites Rubidium is designed to run on JRuby. Installing JRuby is straightforward on unix-like systems. First, download the JRuby-1.1b1 binary release. Then, unpack the archive to your directory of choice. Set $JRUBY\_HOME and $JAVA\_HOME. Finally, add $JRUBY_HOME/bin to your path.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="articles">
    <meta property="article:published_time" content="2007-11-12T00:00:00+00:00">
    <meta property="article:modified_time" content="2007-11-12T00:00:00+00:00">

  <meta itemprop="name" content="Parsing SD Files with Ruby and Rubidium">
  <meta itemprop="description" content="Reading SD files is a bread-and-butter cheminformatics operation. At a minimum, a cheminformatics toolkit needs to parse the individual entries of an SD file, and provide access to the embedded molfile and data hash for each.
Recent articles have introduced Rubidium, a Ruby cheminformatics scripting environment. The Rubidium team now announces the release of Rubidium-0.1.1, which, among other features, introduces the ability to parse SD files.
Prerequisites Rubidium is designed to run on JRuby. Installing JRuby is straightforward on unix-like systems. First, download the JRuby-1.1b1 binary release. Then, unpack the archive to your directory of choice. Set $JRUBY\_HOME and $JAVA\_HOME. Finally, add $JRUBY_HOME/bin to your path.">
  <meta itemprop="datePublished" content="2007-11-12T00:00:00+00:00">
  <meta itemprop="dateModified" content="2007-11-12T00:00:00+00:00">
  <meta itemprop="wordCount" content="631">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Parsing SD Files with Ruby and Rubidium">
  <meta name="twitter:description" content="Reading SD files is a bread-and-butter cheminformatics operation. At a minimum, a cheminformatics toolkit needs to parse the individual entries of an SD file, and provide access to the embedded molfile and data hash for each.
Recent articles have introduced Rubidium, a Ruby cheminformatics scripting environment. The Rubidium team now announces the release of Rubidium-0.1.1, which, among other features, introduces the ability to parse SD files.
Prerequisites Rubidium is designed to run on JRuby. Installing JRuby is straightforward on unix-like systems. First, download the JRuby-1.1b1 binary release. Then, unpack the archive to your directory of choice. Set $JRUBY\_HOME and $JAVA\_HOME. Finally, add $JRUBY_HOME/bin to your path.">

	
  </head><body class="ma0 avenir bg-near-white development">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Depth-First
      
    </a>
    <div class="flex-l items-center">
      

      
      <div class="ananke-socials"></div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Articles
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1">Parsing SD Files with Ruby and Rubidium</h1>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2007-11-12T00:00:00Z">November 12, 2007</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>Reading SD files is a bread-and-butter cheminformatics operation. At a minimum, a cheminformatics toolkit needs to parse the individual entries of an SD file, and provide access to the embedded molfile and data hash for each.</p>
<p>Recent articles have introduced <a href="http://rbtk.rubyforge.org">Rubidium</a>, a Ruby cheminformatics scripting environment. The Rubidium team now announces the release of <a href="http://rubyforge.org/frs/?group_id=4671">Rubidium-0.1.1</a>, which, among other features, introduces the ability to parse SD files.</p>
<h1 id="prerequisites">Prerequisites</h1>
<p>Rubidium is designed to run on <a href="http://jruby.codehaus.org/">JRuby</a>. Installing JRuby is straightforward on unix-like systems. First, download the <a href="http://dist.codehaus.org/jruby/jruby-bin-1.1b1.tar.gz">JRuby-1.1b1 binary release</a>. Then, unpack the archive to your directory of choice. Set <code>$JRUBY\_HOME</code> and <code>$JAVA\_HOME</code>. Finally, add <code>$JRUBY_HOME/bin</code> to your path.</p>
<h1 id="installing-rubidium-011">Installing Rubidium-0.1.1</h1>
<p>Generally speaking, it should be possible to install Rubidium with a one-line command to RubyGems:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>jruby -S gem install rbtk
</span></span></code></pre></div><p>Unfortunately at the time of this writing, I was receiving the mysterious <a href="http://www.google.com/search?q=rubygems+%22ERROR:++While+executing+gem+...+OpenURI::HTTPError%22&amp;hl=en&amp;pwst=1&amp;start=0&amp;sa=N">RubyGems 404 error</a> with the RubyForge remote repository:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>jruby -S gem install rbtk
</span></span><span style="display:flex;"><span>Select which gem to install <span style="color:#66d9ef">for</span> your platform <span style="color:#f92672">(</span>java<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span> 1. rbtk 0.1.1 <span style="color:#f92672">(</span>java<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span> 2. rbtk 0.1.0 <span style="color:#f92672">(</span>java<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span> 3. Skip this gem
</span></span><span style="display:flex;"><span> 4. Cancel installation
</span></span><span style="display:flex;"><span>&gt; <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>ERROR:  While executing gem ... <span style="color:#f92672">(</span>OpenURI::HTTPError<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">404</span> Not Found
</span></span></code></pre></div><p>This appears to affect only certain RubyGems on RubyForge - possibly only those with multiple versions. It seems to be an error on the RubyForge server that occasionally appears and then disappears.</p>
<p>As a workaround, you can <a href="http://rubyforge.org/frs/download.php/27819/rbtk-0.1.1-jruby.gem">download the Rubidium gem</a> and install it manually:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ jruby -S gem install tmp/rbtk-0.1.1-jruby.gem
</span></span></code></pre></div><p>Because Rubidium-0.1.1 introduces an <a href="http://rubyforge.org/projects/activesupport/">Active Support</a> dependency, you will need to install that library before installing Rubidium:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>jruby -S gem install tmp/rbtk-0.1.1-jruby.gem
</span></span><span style="display:flex;"><span>ERROR:  While executing gem ... <span style="color:#f92672">(</span>RuntimeError<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    Error instaling tmp/rbtk-0.1.1-jruby.gem:
</span></span><span style="display:flex;"><span>        rbtk requires activesupport &gt;<span style="color:#f92672">=</span> 1.4.2
</span></span><span style="display:flex;"><span>$ jruby -S gem install activesupport
</span></span><span style="display:flex;"><span>Successfully installed activesupport-1.4.4
</span></span><span style="display:flex;"><span>Installing ri documentation <span style="color:#66d9ef">for</span> activesupport-1.4.4...
</span></span><span style="display:flex;"><span>Installing RDoc documentation <span style="color:#66d9ef">for</span> activesupport-1.4.4...
</span></span><span style="display:flex;"><span>$ jruby -S gem install tmp/rbtk-0.1.1-jruby.gem
</span></span><span style="display:flex;"><span>Successfully installed rbtk, version 0.1.1
</span></span><span style="display:flex;"><span>Installing ri documentation <span style="color:#66d9ef">for</span> rbtk-0.1.1-jruby...
</span></span><span style="display:flex;"><span>Installing RDoc documentation <span style="color:#66d9ef">for</span> rbtk-0.1.1-jruby...
</span></span></code></pre></div><p>It&rsquo;s possible that the RubyForge 404 issue will be resolved by the time you read this article, so <code>jruby -S gem install rbtk</code> should be tried first.</p>
<h1 id="parsing-an-sd-file">Parsing an SD File</h1>
<p>Let&rsquo;s say we&rsquo;d like to extract all InChIs from a PubChem dataset. If you don&rsquo;t have one handy, a compilation of about 2000 PubChem benzodiazepines has been <a href="http://rubyforge.org/frs/download.php/27768/pubchem_benzodiazepine_20071110.sdf.gz">deposited on RubyForge</a>.</p>
<p>With our unzipped datafile in our working directory, we can now test the SD File parser by saving the following library to a file called <strong>parse.rb</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span>require <span style="color:#e6db74">&#39;rubygems&#39;</span>
</span></span><span style="display:flex;"><span>gem <span style="color:#e6db74">&#39;rbtk&#39;</span>
</span></span><span style="display:flex;"><span>require <span style="color:#e6db74">&#39;rubidium/sdf&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">parse_sd</span> filename
</span></span><span style="display:flex;"><span>  p <span style="color:#f92672">=</span> <span style="color:#66d9ef">Rubidium</span><span style="color:#f92672">::</span><span style="color:#66d9ef">SDF</span><span style="color:#f92672">::</span><span style="color:#66d9ef">Parser</span><span style="color:#f92672">.</span>new <span style="color:#66d9ef">File</span><span style="color:#f92672">.</span>new(filename)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  p<span style="color:#f92672">.</span>each <span style="color:#66d9ef">do</span> <span style="color:#f92672">|</span>entry<span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span>    puts <span style="color:#e6db74">&#34;InChI: </span><span style="color:#e6db74">#{</span>entry<span style="color:#f92672">[</span><span style="color:#e6db74">&#39;PUBCHEM_NIST_INCHI&#39;</span><span style="color:#f92672">]</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><p>which can be tested with <code>jirb</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>jirb
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:001:0&gt; require <span style="color:#e6db74">&#39;parse&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; true
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:002:0&gt; parse_sd <span style="color:#e6db74">&#39;pubchem_benzodiazepine_20071110.sdf&#39;</span>
</span></span><span style="display:flex;"><span>InChI: InChI<span style="color:#f92672">=</span>1/C16H12Cl2N2O/c1-20-14-7-6-12<span style="color:#f92672">(</span>18<span style="color:#f92672">)</span>8-13<span style="color:#f92672">(</span>14<span style="color:#f92672">)</span>16<span style="color:#f92672">(</span>19-9-15<span style="color:#f92672">(</span>20<span style="color:#f92672">)</span>21<span style="color:#f92672">)</span>10-2-4-11<span style="color:#f92672">(</span>17<span style="color:#f92672">)</span>5-3-10/h2-8H,9H2,1H3
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>truncated<span style="color:#f92672">]</span>
</span></span></code></pre></div><h1 id="rspec-and-behavior-driven-development">RSpec and Behavior-Driven Development</h1>
<p>If you <a href="http://rubyforge.org/frs/download.php/27820/rbtk-0.1.1.tar.gz">check out the Rubidium source distribution</a>, you&rsquo;ll notice that the SD parser library is tested with <a href="http://rspec.rubyforge.org/">RSpec</a>, the <a href="http://en.wikipedia.org/wiki/Behavior_driven_development">BDD</a> framework for Ruby. Ultimately, all components of Rubidium will be tested and documented this way.</p>
<h1 id="acknowledgments">Acknowledgments</h1>
<p>Rubidium&rsquo;s new SD file parser was written by <a href="http://www.moseshohman.com/">Moses Hohman</a>. It was kindly donated by <a href="http://www.collaborativedrug.com/">Collaborative Drug Discovery</a>, who have built their drug discovery application using <a href="http://rubyonrails.com">Ruby on Rails</a>.</p>
<h1 id="future-directions">Future Directions</h1>
<p>One problem in working with SD files is pinpointing encoding errors. A parser should not only raise an exception, but point to a line number and identify offending text to aid debugging. Rubidium&rsquo;s SD parser will eventually incorporate these enhancements.</p>
<p>Because Rubidium runs on JRuby, performance gains may be achievable by re-writing select portions in Java.</p>
<p>Parsing SD files is only the beginning of the story. Many cheminformatics applications need a convenient, fast, and robust method for <em>writing</em> molfiles. This is also something Rubidium will attempt to provide.</p>
<p>If your company or organization is curious about Ruby and cheminforamatics, give Rubidium a try. Rubidium is licensed under the permissive <a href="http://www.opensource.org/licenses/mit-license.php">MIT License</a> to make collaboration as simple as possible.</p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://localhost:1313/" >
    &copy;  Depth-First 2024 
  </a>
    <div><div class="ananke-socials"></div>
</div>
  </div>
</footer>

  </body>
</html>
