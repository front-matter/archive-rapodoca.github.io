<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Easily Calculate TPSA Descriptors from SMILES Strings Using Ruby CDK | Depth-First</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="A D-F reader wrote in to ask how to calculate Topological Polar Surface Area (TPSA) using Ruby CDK. TPSA is one of the most widely-used descriptors for predicting membrane permeability and from it other important ADME properties. This article shows how to calculate TPSA with Ruby using Ruby CDK.
The Library
Our library consists of nothing more than a few method calls to manipulate the underlying CDK library. The tpsa_for method accepts any SMILES string and returns the calculated TPSA:">
    <meta name="generator" content="Hugo 0.139.4">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    

    
      

    

    

    
      <link rel="canonical" href="http://localhost:1313/articles/2007/09/19/easily-calculate-tpsa-descriptors-from-smiles-strings-using-ruby-cdk/">
    

    <meta property="og:url" content="http://localhost:1313/articles/2007/09/19/easily-calculate-tpsa-descriptors-from-smiles-strings-using-ruby-cdk/">
  <meta property="og:site_name" content="Depth-First">
  <meta property="og:title" content="Easily Calculate TPSA Descriptors from SMILES Strings Using Ruby CDK">
  <meta property="og:description" content="A D-F reader wrote in to ask how to calculate Topological Polar Surface Area (TPSA) using Ruby CDK. TPSA is one of the most widely-used descriptors for predicting membrane permeability and from it other important ADME properties. This article shows how to calculate TPSA with Ruby using Ruby CDK.
The Library Our library consists of nothing more than a few method calls to manipulate the underlying CDK library. The tpsa_for method accepts any SMILES string and returns the calculated TPSA:">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="articles">
    <meta property="article:published_time" content="2007-09-19T00:00:00+00:00">
    <meta property="article:modified_time" content="2007-09-19T00:00:00+00:00">

  <meta itemprop="name" content="Easily Calculate TPSA Descriptors from SMILES Strings Using Ruby CDK">
  <meta itemprop="description" content="A D-F reader wrote in to ask how to calculate Topological Polar Surface Area (TPSA) using Ruby CDK. TPSA is one of the most widely-used descriptors for predicting membrane permeability and from it other important ADME properties. This article shows how to calculate TPSA with Ruby using Ruby CDK.
The Library Our library consists of nothing more than a few method calls to manipulate the underlying CDK library. The tpsa_for method accepts any SMILES string and returns the calculated TPSA:">
  <meta itemprop="datePublished" content="2007-09-19T00:00:00+00:00">
  <meta itemprop="dateModified" content="2007-09-19T00:00:00+00:00">
  <meta itemprop="wordCount" content="266">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Easily Calculate TPSA Descriptors from SMILES Strings Using Ruby CDK">
  <meta name="twitter:description" content="A D-F reader wrote in to ask how to calculate Topological Polar Surface Area (TPSA) using Ruby CDK. TPSA is one of the most widely-used descriptors for predicting membrane permeability and from it other important ADME properties. This article shows how to calculate TPSA with Ruby using Ruby CDK.
The Library Our library consists of nothing more than a few method calls to manipulate the underlying CDK library. The tpsa_for method accepts any SMILES string and returns the calculated TPSA:">

	
  </head><body class="ma0 avenir bg-near-white development">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Depth-First
      
    </a>
    <div class="flex-l items-center">
      

      
      <div class="ananke-socials"></div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Articles
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1">Easily Calculate TPSA Descriptors from SMILES Strings Using Ruby CDK</h1>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2007-09-19T00:00:00Z">September 19, 2007</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>A D-F reader wrote in to ask how to calculate Topological Polar Surface Area (TPSA) using Ruby CDK. TPSA is one of the most widely-used descriptors for predicting membrane permeability and from it other important ADME properties. This article shows how to calculate TPSA with Ruby using Ruby CDK.</p>
<h1 id="the-library">The Library</h1>
<p>Our library consists of nothing more than a few method calls to manipulate the underlying <a href="http://cdk.sf.net">CDK</a> library. The <!-- raw HTML omitted -->tpsa_for<!-- raw HTML omitted --> method accepts any SMILES string and returns the calculated TPSA:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span>require <span style="color:#e6db74">&#39;rubygems&#39;</span>
</span></span><span style="display:flex;"><span>require_gem <span style="color:#e6db74">&#39;rcdk&#39;</span>
</span></span><span style="display:flex;"><span>require <span style="color:#e6db74">&#39;rcdk/util&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>jrequire <span style="color:#e6db74">&#39;org.openscience.cdk.qsar.descriptors.molecular.TPSADescriptor&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">module</span> TPSA
</span></span><span style="display:flex;"><span>  @@calc <span style="color:#f92672">=</span> <span style="color:#66d9ef">Org</span><span style="color:#f92672">::</span><span style="color:#66d9ef">Openscience</span><span style="color:#f92672">::</span><span style="color:#66d9ef">Cdk</span><span style="color:#f92672">::</span><span style="color:#66d9ef">Qsar</span><span style="color:#f92672">::</span><span style="color:#66d9ef">Descriptors</span><span style="color:#f92672">::</span><span style="color:#66d9ef">Molecular</span><span style="color:#f92672">::</span><span style="color:#66d9ef">TPSADescriptor</span><span style="color:#f92672">.</span>new
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">tpsa_for</span> smiles
</span></span><span style="display:flex;"><span>    mol <span style="color:#f92672">=</span> <span style="color:#66d9ef">RCDK</span><span style="color:#f92672">::</span><span style="color:#66d9ef">Util</span><span style="color:#f92672">::</span><span style="color:#66d9ef">Lang</span><span style="color:#f92672">.</span>read_smiles smiles
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @@calc<span style="color:#f92672">.</span>calculate(mol)<span style="color:#f92672">.</span>getValue<span style="color:#f92672">.</span>doubleValue
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><h1 id="an-interactive-test">An Interactive Test</h1>
<p>Saving the library to a file called <!-- raw HTML omitted -->tpsa.rb<!-- raw HTML omitted --> lets us test it through interactive Ruby (irb):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>irb
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:001:0&gt; require <span style="color:#e6db74">&#39;tpsa&#39;</span>
</span></span><span style="display:flex;"><span>./tpsa.rb:2:Warning: require_gem is obsolete.  Use gem instead.
</span></span><span style="display:flex;"><span>/usr/local/lib/ruby/gems/1.8/gems/rcdk-0.3.0/lib/rcdk/java.rb:26:Warning: require_gem is obsolete.  Use gem instead.
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; true
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:002:0&gt; include TPSA
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; Object
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:003:0&gt; tpsa_for <span style="color:#e6db74">&#39;COCCc1ccc(OCC(O)CNC(C)C)cc1&#39;</span> <span style="color:#75715e"># metoprolol</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; 50.72
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:004:0&gt; tpsa_for <span style="color:#e6db74">&#39;O=C3Nc1ccc(Cl)cc1C(c2ccccc2)=NC3O&#39;</span> <span style="color:#75715e"># oxazepam</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; 61.69
</span></span></code></pre></div><p>The results we obtain for metoprolol and oxazepam are 50.72 and 61.69, respectively. These values compare well with those reported by Ertl et al. in the <a href="http://dx.doi.org/10.1021/jm000942e">definitive paper on TPSA</a> (50.7 and 61.7, respectively).</p>
<h1 id="conclusions">Conclusions</h1>
<p>It doesn&rsquo;t take much Ruby to command a wide range of cheminformatics functionality - in this case TPSA calculations. But the fun doesn&rsquo;t stop there. The CDK, and by extension Ruby CDK, offer access to a <a href="http://cheminfo.informatics.indiana.edu/~rguha/code/java/nightly/api/org/openscience/cdk/qsar/descriptors/molecular/package-frame.html">wide array of descriptor calculations</a>, each of which follow the same basic pattern outlined here. All of it can be prototyped, debugged, and deployed through one of the most flexible programming languages currently available.</p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://localhost:1313/" >
    &copy;  Depth-First 2024 
  </a>
    <div><div class="ananke-socials"></div>
</div>
  </div>
</footer>

  </body>
</html>
