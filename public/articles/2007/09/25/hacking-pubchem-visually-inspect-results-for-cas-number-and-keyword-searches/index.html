<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Hacking PubChem - Visually Inspect Results for CAS Number and Keyword Searches | Depth-First</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="A recent article described how PubChem could be used to quickly search for CAS numbers. Although useful, the approach is limited in that only an array of PubChem CIDs was returned. What would be really useful would be a simple way to create a report with entries hyperlinked into the PubChem site itself to aid in visual inspection. In this tutorial, we&rsquo;ll see how an HTML template and a few extra lines of code can do just that.">
    <meta name="generator" content="Hugo 0.139.4">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    
      <meta name="author" content = "Richard L. Apodaca">
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    

    
      

    

    

    
      <link rel="canonical" href="http://localhost:1313/articles/2007/09/25/hacking-pubchem-visually-inspect-results-for-cas-number-and-keyword-searches/">
    

    <meta property="og:url" content="http://localhost:1313/articles/2007/09/25/hacking-pubchem-visually-inspect-results-for-cas-number-and-keyword-searches/">
  <meta property="og:site_name" content="Depth-First">
  <meta property="og:title" content="Hacking PubChem - Visually Inspect Results for CAS Number and Keyword Searches">
  <meta property="og:description" content="A recent article described how PubChem could be used to quickly search for CAS numbers. Although useful, the approach is limited in that only an array of PubChem CIDs was returned. What would be really useful would be a simple way to create a report with entries hyperlinked into the PubChem site itself to aid in visual inspection. In this tutorial, we’ll see how an HTML template and a few extra lines of code can do just that.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2007-09-25T00:00:00+00:00">
    <meta property="article:modified_time" content="2007-09-25T00:00:00+00:00">

  <meta itemprop="name" content="Hacking PubChem - Visually Inspect Results for CAS Number and Keyword Searches">
  <meta itemprop="description" content="A recent article described how PubChem could be used to quickly search for CAS numbers. Although useful, the approach is limited in that only an array of PubChem CIDs was returned. What would be really useful would be a simple way to create a report with entries hyperlinked into the PubChem site itself to aid in visual inspection. In this tutorial, we’ll see how an HTML template and a few extra lines of code can do just that.">
  <meta itemprop="datePublished" content="2007-09-25T00:00:00+00:00">
  <meta itemprop="dateModified" content="2007-09-25T00:00:00+00:00">
  <meta itemprop="wordCount" content="515">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Hacking PubChem - Visually Inspect Results for CAS Number and Keyword Searches">
  <meta name="twitter:description" content="A recent article described how PubChem could be used to quickly search for CAS numbers. Although useful, the approach is limited in that only an array of PubChem CIDs was returned. What would be really useful would be a simple way to create a report with entries hyperlinked into the PubChem site itself to aid in visual inspection. In this tutorial, we’ll see how an HTML template and a few extra lines of code can do just that.">

	
  </head><body class="ma0 avenir bg-near-white development">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Depth-First
      
    </a>
    <div class="flex-l items-center">
      

      
      <div class="ananke-socials"></div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Posts
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1">Hacking PubChem - Visually Inspect Results for CAS Number and Keyword Searches</h1>
      
      <p class="tracked">
        By <strong>Richard L. Apodaca</strong>
      </p>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2007-09-25T00:00:00Z">September 25, 2007</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>A recent article described how PubChem could be used to <a href="/articles/2007/09/13/hacking-pubchem-convert-cas-numbers-into-pubchem-cids-with-ruby">quickly search for CAS numbers</a>. Although useful, the approach is limited in that only an array of PubChem CIDs was returned. What would be really useful would be a simple way to create a report with entries hyperlinked into the PubChem site itself to aid in visual inspection. In this tutorial, we&rsquo;ll see how an HTML template and a few extra lines of code can do just that.</p>
<h1 id="the-template">The Template</h1>
<p>Ruby supports a number of HTML templating mechanisms. In this example, we&rsquo;ll use an ERB template resurrected from the <a href="/articles/2006/12/11/hacking-molbank-creating-a-graphical-table-of-contents">Molbank graphical table of contents</a> tutorial:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">html</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">title</span>&gt;
</span></span><span style="display:flex;"><span>      <span style="color:#960050;background-color:#1e0010">&lt;</span>%= &#34;PubChem Search for #{term}&#34; %&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">title</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">h1</span>&gt;
</span></span><span style="display:flex;"><span>      <span style="color:#960050;background-color:#1e0010">&lt;</span>%= &#34;Search: #{term}&#34; %&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">h1</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">table</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#f92672">tr</span>&gt;
</span></span><span style="display:flex;"><span>      <span style="color:#960050;background-color:#1e0010">&lt;</span>% col = 0 %&gt;
</span></span><span style="display:flex;"><span>      <span style="color:#960050;background-color:#1e0010">&lt;</span>% cids.each do |cid| %&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">td</span>&gt;
</span></span><span style="display:flex;"><span>          <span style="color:#960050;background-color:#1e0010">&lt;</span>% image = &#34;http://pubchem.ncbi.nlm.nih.gov/image/imgsrv.fcgi?cid=#{cid}&#34; %&gt;
</span></span><span style="display:flex;"><span>          <span style="color:#960050;background-color:#1e0010">&lt;</span>% summary = &#34;http://pubchem.ncbi.nlm.nih.gov/summary/summary.cgi?cid=#{cid}&#34; %&gt;
</span></span><span style="display:flex;"><span>          &lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&lt;%= summary %&gt;&#34;</span>&gt;
</span></span><span style="display:flex;"><span>            &lt;<span style="color:#f92672">img</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&lt;%= image %&gt;&#34;</span> <span style="color:#a6e22e">border</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;2&#34;</span>&gt;&lt;/<span style="color:#f92672">img</span>&gt;
</span></span><span style="display:flex;"><span>          &lt;/<span style="color:#f92672">a</span>&gt;
</span></span><span style="display:flex;"><span>          &lt;<span style="color:#f92672">center</span>&gt;
</span></span><span style="display:flex;"><span>            &lt;<span style="color:#f92672">span</span> <span style="color:#a6e22e">style</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;font-size: 8px&#34;</span>&gt;
</span></span><span style="display:flex;"><span>              &lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&lt;%= summary %&gt;&#34;</span>&gt;<span style="color:#960050;background-color:#1e0010">&lt;</span>%= &#34;CID-#{cid}&#34; %&gt;&lt;/<span style="color:#f92672">a</span>&gt;
</span></span><span style="display:flex;"><span>            &lt;/<span style="color:#f92672">span</span>&gt;
</span></span><span style="display:flex;"><span>          &lt;/<span style="color:#f92672">center</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;/<span style="color:#f92672">td</span>&gt;
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">&lt;</span>% col += 1 %&gt;
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">&lt;</span>% if col &gt; 5 %&gt;
</span></span><span style="display:flex;"><span>          <span style="color:#960050;background-color:#1e0010">&lt;</span>% col = 0 %&gt;
</span></span><span style="display:flex;"><span>          &lt;/<span style="color:#f92672">tr</span>&gt;
</span></span><span style="display:flex;"><span>          &lt;<span style="color:#f92672">tr</span>&gt;
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">&lt;</span>% end %&gt;
</span></span><span style="display:flex;"><span>      <span style="color:#960050;background-color:#1e0010">&lt;</span>%end %&gt;
</span></span><span style="display:flex;"><span>      &lt;/<span style="color:#f92672">tr</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">table</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">html</span>&gt;
</span></span></code></pre></div><p>The above template uses a search term and an array of CIDs to build a table of results. Each cell in the table contains a color 2D image and the CID, both hyperlinked into PubChem itself.</p>
<p>Saving this library to a file called <!-- raw HTML omitted -->template.rhtml<!-- raw HTML omitted --> is all we need to do.</p>
<h1 id="the-library">The Library</h1>
<p>The library is a modification of the one shown in <!-- raw HTML omitted -->the previous article<!-- raw HTML omitted --> in this series:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span>require <span style="color:#e6db74">&#39;rubygems&#39;</span>
</span></span><span style="display:flex;"><span>require <span style="color:#e6db74">&#39;mechanize&#39;</span>
</span></span><span style="display:flex;"><span>require <span style="color:#e6db74">&#39;erb&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">module</span> PubChemTerms
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">report</span> term
</span></span><span style="display:flex;"><span>    cids <span style="color:#f92672">=</span> get_cids term
</span></span><span style="display:flex;"><span>    erb <span style="color:#f92672">=</span> <span style="color:#66d9ef">ERB</span><span style="color:#f92672">.</span>new(<span style="color:#66d9ef">IO</span><span style="color:#f92672">.</span>read(<span style="color:#e6db74">&#34;template.rhtml&#34;</span>))
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">File</span><span style="color:#f92672">.</span>open <span style="color:#e6db74">&#34;output.html&#34;</span>, <span style="color:#e6db74">&#39;w+&#39;</span> <span style="color:#66d9ef">do</span> <span style="color:#f92672">|</span>file<span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span>      file <span style="color:#f92672">&amp;</span>lt;<span style="color:#f92672">&amp;</span>lt; erb<span style="color:#f92672">.</span>result(binding)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_cids</span> term
</span></span><span style="display:flex;"><span>    agent <span style="color:#f92672">=</span> <span style="color:#66d9ef">WWW</span><span style="color:#f92672">::</span><span style="color:#66d9ef">Mechanize</span><span style="color:#f92672">.</span>new
</span></span><span style="display:flex;"><span>    page <span style="color:#f92672">=</span> agent<span style="color:#f92672">.</span>get <span style="color:#e6db74">&#34;http://www.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=pccompound&amp;retmax=100&amp;term=</span><span style="color:#e6db74">#{</span>term<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    (page<span style="color:#f92672">.</span>parser<span style="color:#f92672">/</span><span style="color:#e6db74">&#34;id&#34;</span>)<span style="color:#f92672">.</span>collect {<span style="color:#f92672">|</span>id<span style="color:#f92672">|</span> id<span style="color:#f92672">.</span>innerHTML}
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><p>The method <!-- raw HTML omitted -->report<!-- raw HTML omitted --> accepts a search term and uses our template to render a report.</p>
<h1 id="testing">Testing</h1>
<p>By saving the above library in a file called <!-- raw HTML omitted -->pubchem.rb<!-- raw HTML omitted -->, we can search by keyword via interactive ruby (irb):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>irb
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:001:0&gt; require <span style="color:#e6db74">&#39;pubchem&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; true
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:002:0&gt; include PubChemTerms
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; Object
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:003:0&gt; report <span style="color:#e6db74">&#39;esomeprazole&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; <span style="color:#75715e">#&lt;File:output.html (closed)&gt;</span>
</span></span></code></pre></div><p>This produces a file called <strong>output.html</strong> that can be viewed with any browser:</p>
<p><img src="/images/posts/20070925/screenshot.png" alt="Screenshot" title="Screenshot"></p>
<p>As in the original version of the library, we can also query by CAS number:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>irb
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:001:0&gt; require <span style="color:#e6db74">&#39;pubchem&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; true
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:002:0&gt; include PubChemTerms
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; Object
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:003:0&gt; report <span style="color:#e6db74">&#39;119141-88-7&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; <span style="color:#75715e">#&lt;File:output.html (closed)&gt;</span>
</span></span></code></pre></div><h1 id="conclusions">Conclusions</h1>
<p>The simple approach outlined here could be extended in many ways. For example, we could easily retrieve molfiles based on keyword or CAS number search. We could pipe queries together or work with query lists. We could <a href="/articles/2007/09/17/hacking-chemspider-query-by-smiles-and-inchi-with-ruby">blend in ChemSpider data</a>. We could even build a simple Web application (with <a href="http://rubyonrails.org">Rails</a>) that returned customized reports. Mixing in Ruby CDK or Ruby Open Babel offers still more possibilities.</p>
<p>Increasingly, the most important question in cheminformatics is not &ldquo;What can we build?&rdquo;, but rather &ldquo;What should we build?&rdquo; Success in this new world requires a much deeper understanding of how cheminformatics software is being used by real chemists and where it&rsquo;s not.</p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://localhost:1313/" >
    &copy;  Depth-First 2024 
  </a>
    <div><div class="ananke-socials"></div>
</div>
  </div>
</footer>

  </body>
</html>
