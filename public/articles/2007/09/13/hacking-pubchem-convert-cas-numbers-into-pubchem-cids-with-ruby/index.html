<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Hacking PubChem - Convert CAS Numbers into PubChem CIDs with Ruby | Depth-First</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="Although the PubChem system has been discussed in numerous recent D-F articles and elsewhere, there&rsquo;s much more to the story that hasn&rsquo;t been told. One of the more intriguing things PubChem can do is look up CAS Numbers for free. In this tutorial, we&rsquo;ll see how a simple Ruby script can be used to automate the conversion of CAS numbers into PubChem Compound IDs (CIDs).
The Library
Our library needs to accept a CAS number and return an array of PubChem CIDs in response. To do this, we&rsquo;ll make use of the Entrez eUtils system. Although Entrez is incredibly complex, the only two things that matter now are that the NIH requires automated scripts to access most of its databases through Entrez, and that Entrez can be used to perform PubChem keyword queries.">
    <meta name="generator" content="Hugo 0.139.4">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    

    
      

    

    

    
      <link rel="canonical" href="http://localhost:1313/articles/2007/09/13/hacking-pubchem-convert-cas-numbers-into-pubchem-cids-with-ruby/">
    

    <meta property="og:url" content="http://localhost:1313/articles/2007/09/13/hacking-pubchem-convert-cas-numbers-into-pubchem-cids-with-ruby/">
  <meta property="og:site_name" content="Depth-First">
  <meta property="og:title" content="Hacking PubChem - Convert CAS Numbers into PubChem CIDs with Ruby">
  <meta property="og:description" content="Although the PubChem system has been discussed in numerous recent D-F articles and elsewhere, there’s much more to the story that hasn’t been told. One of the more intriguing things PubChem can do is look up CAS Numbers for free. In this tutorial, we’ll see how a simple Ruby script can be used to automate the conversion of CAS numbers into PubChem Compound IDs (CIDs).
The Library Our library needs to accept a CAS number and return an array of PubChem CIDs in response. To do this, we’ll make use of the Entrez eUtils system. Although Entrez is incredibly complex, the only two things that matter now are that the NIH requires automated scripts to access most of its databases through Entrez, and that Entrez can be used to perform PubChem keyword queries.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2007-09-13T00:00:00+00:00">
    <meta property="article:modified_time" content="2007-09-13T00:00:00+00:00">

  <meta itemprop="name" content="Hacking PubChem - Convert CAS Numbers into PubChem CIDs with Ruby">
  <meta itemprop="description" content="Although the PubChem system has been discussed in numerous recent D-F articles and elsewhere, there’s much more to the story that hasn’t been told. One of the more intriguing things PubChem can do is look up CAS Numbers for free. In this tutorial, we’ll see how a simple Ruby script can be used to automate the conversion of CAS numbers into PubChem Compound IDs (CIDs).
The Library Our library needs to accept a CAS number and return an array of PubChem CIDs in response. To do this, we’ll make use of the Entrez eUtils system. Although Entrez is incredibly complex, the only two things that matter now are that the NIH requires automated scripts to access most of its databases through Entrez, and that Entrez can be used to perform PubChem keyword queries.">
  <meta itemprop="datePublished" content="2007-09-13T00:00:00+00:00">
  <meta itemprop="dateModified" content="2007-09-13T00:00:00+00:00">
  <meta itemprop="wordCount" content="557">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Hacking PubChem - Convert CAS Numbers into PubChem CIDs with Ruby">
  <meta name="twitter:description" content="Although the PubChem system has been discussed in numerous recent D-F articles and elsewhere, there’s much more to the story that hasn’t been told. One of the more intriguing things PubChem can do is look up CAS Numbers for free. In this tutorial, we’ll see how a simple Ruby script can be used to automate the conversion of CAS numbers into PubChem Compound IDs (CIDs).
The Library Our library needs to accept a CAS number and return an array of PubChem CIDs in response. To do this, we’ll make use of the Entrez eUtils system. Although Entrez is incredibly complex, the only two things that matter now are that the NIH requires automated scripts to access most of its databases through Entrez, and that Entrez can be used to perform PubChem keyword queries.">

	
  </head><body class="ma0 avenir bg-near-white development">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Depth-First
      
    </a>
    <div class="flex-l items-center">
      

      
      <div class="ananke-socials"></div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Posts
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1">Hacking PubChem - Convert CAS Numbers into PubChem CIDs with Ruby</h1>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2007-09-13T00:00:00Z">September 13, 2007</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>Although the PubChem system has been discussed in <a href="http://depth-first.com/articles/tag/pubchem">numerous recent D-F articles</a> and elsewhere, there&rsquo;s much more to the story that hasn&rsquo;t been told. One of the more intriguing things PubChem can do is <a href="http://depth-first.com/articles/2007/05/21/simple-cas-number-lookup-with-pubchem">look up CAS Numbers for free</a>. In this tutorial, we&rsquo;ll see how a simple Ruby script can be used to automate the conversion of CAS numbers into PubChem Compound IDs (CIDs).</p>
<h1 id="the-library">The Library</h1>
<p>Our library needs to accept a CAS number and return an array of PubChem CIDs in response. To do this, we&rsquo;ll make use of the <a href="http://eutils.ncbi.nlm.nih.gov/entrez/query/static/eutils_help.html">Entrez eUtils system</a>. Although Entrez is incredibly complex, the only two things that matter now are that the NIH requires automated scripts to access most of its databases through Entrez, and that Entrez can be used to perform PubChem keyword queries.</p>
<p>The library is simplicity itself:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span>require <span style="color:#e6db74">&#39;rubygems&#39;</span>
</span></span><span style="display:flex;"><span>require <span style="color:#e6db74">&#39;mechanize&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">module</span> PubChemTerms
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_cids</span> term
</span></span><span style="display:flex;"><span>    agent <span style="color:#f92672">=</span> <span style="color:#66d9ef">WWW</span><span style="color:#f92672">::</span><span style="color:#66d9ef">Mechanize</span><span style="color:#f92672">.</span>new
</span></span><span style="display:flex;"><span>    page <span style="color:#f92672">=</span> agent<span style="color:#f92672">.</span>get <span style="color:#e6db74">&#34;http://www.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=pccompound&amp;retmax=100&amp;term=</span><span style="color:#e6db74">#{</span>term<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    (page<span style="color:#f92672">.</span>parser<span style="color:#f92672">/</span><span style="color:#e6db74">&#34;id&#34;</span>)<span style="color:#f92672">.</span>collect {<span style="color:#f92672">|</span>id<span style="color:#f92672">|</span> id<span style="color:#f92672">.</span>innerHTML}
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><p>The excellent Ruby library <!-- raw HTML omitted -->Mechanize<!-- raw HTML omitted --> is used for submitting queries and processing the results. (This is the same library that was used to <!-- raw HTML omitted -->extract full bibliographical information<!-- raw HTML omitted --> from nothing more than a DOI). The only remarkable thing about the library above is how unremarkable it is.</p>
<h1 id="a-test">A Test</h1>
<p>We can test the library by saving it in a file called <!-- raw HTML omitted -->entrez.rb<!-- raw HTML omitted --> and starting an interactive Ruby (irb) session. Opening up my copy of the Merck index to a random page and selecting an entry gives a CAS number to try (64318-79-2 - gemeprost). Plugging this CAS number into our irb session gives:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>irb
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:001:0&gt; require <span style="color:#e6db74">&#39;entrez&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; true
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:002:0&gt; include PubChemTerms
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; Object
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:003:0&gt; get_cids <span style="color:#e6db74">&#39;64318-79-2&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; <span style="color:#f92672">[</span><span style="color:#e6db74">&#34;5282237&#34;</span>, <span style="color:#e6db74">&#34;6434870&#34;</span><span style="color:#f92672">]</span>
</span></span></code></pre></div><p>Our library has returned a Ruby array containing two compound identifiers. We can use PubChem to view their records <a href="http://pubchem.ncbi.nlm.nih.gov/summary/summary.cgi?cid=5282237">here</a> and <a href="http://pubchem.ncbi.nlm.nih.gov/summary/summary.cgi?cid=6434870">here</a>. Visual inspection reveals these two compounds to be isomers of each other, with the first member of the array containing the direct hit.</p>
<p>Let&rsquo;s try another CAS number selected from another random Merck index entry:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:004:0&gt; get_cids <span style="color:#e6db74">&#39;66981-73-5&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; <span style="color:#f92672">[</span><span style="color:#e6db74">&#34;68870&#34;</span>, <span style="color:#e6db74">&#34;169125&#34;</span><span style="color:#f92672">]</span>
</span></span></code></pre></div><p>Again we&rsquo;ve obtained two CIDs, with the <a href="http://pubchem.ncbi.nlm.nih.gov/summary/summary.cgi?cid=68870">first one</a> being the neutral form and the second one being the <a href="http://pubchem.ncbi.nlm.nih.gov/summary/summary.cgi?cid=169125">sodium salt</a> of the antidepressant tianeptine.</p>
<h1 id="applications">Applications</h1>
<p>Now, instead of converting one or two CAS numbers, imagine we&rsquo;ve got a few thousand. Our library could be easily adapted to this purpose. The only caveat is that we&rsquo;d need to <a href="http://eutils.ncbi.nlm.nih.gov/entrez/query/static/eutils_help.html#UserSystemRequirements">observe the Entrez use policy</a> and not overload the server with too many requests. We could build in a delay with Ruby&rsquo;s <!-- raw HTML omitted -->sleep<!-- raw HTML omitted --> method.</p>
<p>Notice that the library can be used to search for any keyword - not just CAS numbers. For example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>irb
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:001:0&gt; require <span style="color:#e6db74">&#39;entrez&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; true
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:002:0&gt; include PubChemTerms
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; Object
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:003:0&gt; get_cids <span style="color:#e6db74">&#39;anandamide&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; <span style="color:#f92672">[</span><span style="color:#e6db74">&#34;5281969&#34;</span>, <span style="color:#e6db74">&#34;5283455&#34;</span>, <span style="color:#e6db74">&#34;5283388&#34;</span>, <span style="color:#e6db74">&#34;4671&#34;</span>, <span style="color:#e6db74">&#34;5353407&#34;</span>, <span style="color:#e6db74">&#34;5283452&#34;</span>, <span style="color:#e6db74">&#34;5283456&#34;</span>, <span style="color:#e6db74">&#34;5283451&#34;</span>, <span style="color:#e6db74">&#34;5283450&#34;</span>, <span style="color:#e6db74">&#34;5283449&#34;</span>, <span style="color:#e6db74">&#34;5283448&#34;</span>, <span style="color:#e6db74">&#34;5283447&#34;</span>, <span style="color:#e6db74">&#34;5283445&#34;</span>, <span style="color:#e6db74">&#34;5283444&#34;</span><span style="color:#f92672">]</span>
</span></span></code></pre></div><p>Like our previous queries, we&rsquo;ve obtained multiple CIDs associated with the term &lsquo;anandamide&rsquo;, with the first one being the direct hit.</p>
<h1 id="conclusions">Conclusions</h1>
<p>Our little library isn&rsquo;t perfect, but it performs a very difficult task cheaply and conveniently in the majority of cases. By mashing up this functionality with other Ruby cheminformatics libraries (for example <a href="/articles/2007/04/09/painless-installation-of-ruby-open-babel">Ruby Open Babel</a> and Ruby CDK, a variety of tough and highly practical cheminformatics problems can be solved elegantly. Look to further installments of the Hacking PubChem series to find out how.</p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://localhost:1313/" >
    &copy;  Depth-First 2024 
  </a>
    <div><div class="ananke-socials"></div>
</div>
  </div>
</footer>

  </body>
</html>
