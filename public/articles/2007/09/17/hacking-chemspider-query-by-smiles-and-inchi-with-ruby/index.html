<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Hacking ChemSpider - Query by SMILES and InChI with Ruby | Depth-First</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="Slowly but surely, cheminformatics Web APIs are starting to appear. What&rsquo;s the big deal, you may ask? By exposing Web APIs, service providers enable third parties to develop new applications that &ldquo;mash up&rdquo; functionality from two or more sites, or which take the original service in directions its founders never considered.
By way of Antony Williams&rsquo; blog, I came across the announcement for the ChemSpider Web API. What can this API do for Web developers? To find out, let&rsquo;s write a small Ruby library.">
    <meta name="generator" content="Hugo 0.139.4">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    
      <meta name="author" content = "Richard L. Apodaca">
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    

    
      

    

    

    
      <link rel="canonical" href="http://localhost:1313/articles/2007/09/17/hacking-chemspider-query-by-smiles-and-inchi-with-ruby/">
    

    <meta property="og:url" content="http://localhost:1313/articles/2007/09/17/hacking-chemspider-query-by-smiles-and-inchi-with-ruby/">
  <meta property="og:site_name" content="Depth-First">
  <meta property="og:title" content="Hacking ChemSpider - Query by SMILES and InChI with Ruby">
  <meta property="og:description" content="Slowly but surely, cheminformatics Web APIs are starting to appear. What’s the big deal, you may ask? By exposing Web APIs, service providers enable third parties to develop new applications that “mash up” functionality from two or more sites, or which take the original service in directions its founders never considered.
By way of Antony Williams’ blog, I came across the announcement for the ChemSpider Web API. What can this API do for Web developers? To find out, let’s write a small Ruby library.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2007-09-17T00:00:00+00:00">
    <meta property="article:modified_time" content="2007-09-17T00:00:00+00:00">

  <meta itemprop="name" content="Hacking ChemSpider - Query by SMILES and InChI with Ruby">
  <meta itemprop="description" content="Slowly but surely, cheminformatics Web APIs are starting to appear. What’s the big deal, you may ask? By exposing Web APIs, service providers enable third parties to develop new applications that “mash up” functionality from two or more sites, or which take the original service in directions its founders never considered.
By way of Antony Williams’ blog, I came across the announcement for the ChemSpider Web API. What can this API do for Web developers? To find out, let’s write a small Ruby library.">
  <meta itemprop="datePublished" content="2007-09-17T00:00:00+00:00">
  <meta itemprop="dateModified" content="2007-09-17T00:00:00+00:00">
  <meta itemprop="wordCount" content="404">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Hacking ChemSpider - Query by SMILES and InChI with Ruby">
  <meta name="twitter:description" content="Slowly but surely, cheminformatics Web APIs are starting to appear. What’s the big deal, you may ask? By exposing Web APIs, service providers enable third parties to develop new applications that “mash up” functionality from two or more sites, or which take the original service in directions its founders never considered.
By way of Antony Williams’ blog, I came across the announcement for the ChemSpider Web API. What can this API do for Web developers? To find out, let’s write a small Ruby library.">

	
  </head><body class="ma0 avenir bg-near-white development">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Depth-First
      
    </a>
    <div class="flex-l items-center">
      

      
      <div class="ananke-socials"></div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Posts
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1">Hacking ChemSpider - Query by SMILES and InChI with Ruby</h1>
      
      <p class="tracked">
        By <strong>Richard L. Apodaca</strong>
      </p>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2007-09-17T00:00:00Z">September 17, 2007</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>Slowly but surely, cheminformatics Web APIs are starting to appear. What&rsquo;s the big deal, you may ask? By exposing Web APIs, service providers enable third parties to develop new applications that <a href="http://depth-first.com/articles/2006/09/23/mashups-for-fun-and-profit">&ldquo;mash up&rdquo;</a> functionality from two or more sites, or which take the original service in directions its founders never considered.</p>
<p>By way of <a href="http://www.chemspider.com/blog">Antony Williams&rsquo; blog</a>, I came across <a href="http://www.chemspider.com/blog/?p=135">the announcement</a> for the <a href="http://www.chemspider.com/inchi.asmx">ChemSpider Web API</a>. What can this API do for Web developers? To find out, let&rsquo;s write a small Ruby library.</p>
<h1 id="the-library">The Library</h1>
<p>Our library will accept a SMILES string or InChI identifier and returns a URL pointing to the corresponding ChemSpider compound summary page. Like <a href="http://depth-first.com/articles/2007/09/13/hacking-pubchem-convert-cas-numbers-into-pubchem-cids-with-ruby">previous Web API demos</a>, this one uses the powerful Ruby library <a href="http://mechanize.rubyforge.org/">Mechanize</a>, leading to very concise code:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span>require <span style="color:#e6db74">&#39;rubygems&#39;</span>
</span></span><span style="display:flex;"><span>require <span style="color:#e6db74">&#39;mechanize&#39;</span>
</span></span><span style="display:flex;"><span>require <span style="color:#e6db74">&#39;hpricot&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">module</span> ChemSpider
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">url_for_inchi</span> inchi
</span></span><span style="display:flex;"><span>    agent <span style="color:#f92672">=</span> <span style="color:#66d9ef">WWW</span><span style="color:#f92672">::</span><span style="color:#66d9ef">Mechanize</span><span style="color:#f92672">.</span>new
</span></span><span style="display:flex;"><span>    page<span style="color:#f92672">=</span> agent<span style="color:#f92672">.</span>get <span style="color:#e6db74">&#34;http://www.chemspider.com/inchi.asmx/InChIToCSID?inchi=</span><span style="color:#e6db74">#{</span>inchi<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    csid <span style="color:#f92672">=</span> (<span style="color:#66d9ef">Hpricot</span>(page<span style="color:#f92672">.</span>body)<span style="color:#f92672">/</span><span style="color:#e6db74">&#34;string&#34;</span>)<span style="color:#f92672">.</span>innerHTML
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    csid <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&#34;</span> ? <span style="color:#66d9ef">nil</span> : <span style="color:#e6db74">&#34;http://www.chemspider.com/RecordView.aspx?id=</span><span style="color:#e6db74">#{</span>csid<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">url_for_smiles</span> smiles
</span></span><span style="display:flex;"><span>    agent <span style="color:#f92672">=</span> <span style="color:#66d9ef">WWW</span><span style="color:#f92672">::</span><span style="color:#66d9ef">Mechanize</span><span style="color:#f92672">.</span>new
</span></span><span style="display:flex;"><span>    page<span style="color:#f92672">=</span> agent<span style="color:#f92672">.</span>get <span style="color:#e6db74">&#34;http://www.chemspider.com/inchi.asmx/SMILESToInChI?smiles=</span><span style="color:#e6db74">#{</span>smiles<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    inchi <span style="color:#f92672">=</span> (<span style="color:#66d9ef">Hpricot</span>(page<span style="color:#f92672">.</span>body)<span style="color:#f92672">/</span><span style="color:#e6db74">&#34;string&#34;</span>)<span style="color:#f92672">.</span>innerHTML
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">raise</span> <span style="color:#e6db74">&#34;Invalid SMILES: </span><span style="color:#e6db74">#{</span>smiles<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#66d9ef">if</span> inchi <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    url_for_inchi inchi
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span> 
</span></span></code></pre></div><p>The <code>url_for_inchi</code> method directly uses the ChemSpider API to query by InChI. The <code>url_for_smiles</code> method first uses the ChemSpider API to convert a SMILES string to an InChI identifier, and then calls the <code>url_for_inchi</code> method.</p>
<p>Two points are worth noting. First, although for convenience the InChI identifier isn&rsquo;t <!-- raw HTML omitted -->escaped<!-- raw HTML omitted --> before being appended to the API URL, strictly speaking it should be. Second, both methods invoke the underlying Mechanize library <!-- raw HTML omitted -->Hpricot<!-- raw HTML omitted --> to parse the raw XML returned by ChemSpider.</p>
<h1 id="testing">Testing</h1>
<p>Saving the above code to a file called <!-- raw HTML omitted -->chemspider.rb<!-- raw HTML omitted -->, we can get the URL to ChemSpider&rsquo;s benzene page from its InChI identifier via interactive Ruby (irb):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>irb
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:001:0&gt; require <span style="color:#e6db74">&#39;chemspider&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; true
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:002:0&gt; include ChemSpider
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; Object
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:003:0&gt; url_for_inchi <span style="color:#e6db74">&#34;InChI=1/C6H6/c1-2-4-6-5-3-1/h1-6H&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;http://www.chemspider.com/RecordView.aspx?id=236&#34;</span>
</span></span></code></pre></div><p>We can work with SMILES strings just as easily as with InChIs:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>irb
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:001:0&gt; require <span style="color:#e6db74">&#39;chemspider&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; true
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:002:0&gt; include ChemSpider
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; Object
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:003:0&gt; url_for_smiles <span style="color:#e6db74">&#39;c1ccccc1&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;http://www.chemspider.com/RecordView.aspx?id=236&#34;</span>
</span></span></code></pre></div><p>Both the InChI and the SMILES string yield a URL pointing to the <a href="http://www.chemspider.com/RecordView.aspx?id=236">same Chemspider page for benzene</a>.</p>
<h1 id="conclusions">Conclusions</h1>
<p>Like most <a href="/articles/2007/01/24/thirty-two-free-chemistry-databases">chemical databases</a>, ChemSpider uses a compound summary page as a way of organizing the available resources for a given molecule. With a method in hand for accessing these pages based on arbitrary SMILES or InChIs, we can begin to think of manipulating ChemSpider independently of its current user interface. But that&rsquo;s a story for another time.</p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://localhost:1313/" >
    &copy;  Depth-First 2024 
  </a>
    <div><div class="ananke-socials"></div>
</div>
  </div>
</footer>

  </body>
</html>
