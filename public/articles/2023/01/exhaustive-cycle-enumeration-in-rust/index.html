<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Exhaustive Cycle Enumeration in Rust | Depth-First</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="Generating the set of all cycles for undirected graphs.">
    <meta name="generator" content="Hugo 0.139.4">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    

    
      

    

    

    
      <link rel="canonical" href="http://localhost:1313/articles/2023/01/exhaustive-cycle-enumeration-in-rust/">
    

    <meta property="og:url" content="http://localhost:1313/articles/2023/01/exhaustive-cycle-enumeration-in-rust/">
  <meta property="og:site_name" content="Depth-First">
  <meta property="og:title" content="Exhaustive Cycle Enumeration in Rust">
  <meta property="og:description" content="Generating the set of all cycles for undirected graphs.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="articles">
    <meta property="article:published_time" content="2023-01-26T15:30:00+00:00">
    <meta property="article:modified_time" content="2023-01-26T15:30:00+00:00">

  <meta itemprop="name" content="Exhaustive Cycle Enumeration in Rust">
  <meta itemprop="description" content="Generating the set of all cycles for undirected graphs.">
  <meta itemprop="datePublished" content="2023-01-26T15:30:00+00:00">
  <meta itemprop="dateModified" content="2023-01-26T15:30:00+00:00">
  <meta itemprop="wordCount" content="519">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Exhaustive Cycle Enumeration in Rust">
  <meta name="twitter:description" content="Generating the set of all cycles for undirected graphs.">

	
  </head><body class="ma0 avenir bg-near-white development">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Depth-First
      
    </a>
    <div class="flex-l items-center">
      

      
      <div class="ananke-socials"></div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Articles
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1">Exhaustive Cycle Enumeration in Rust</h1>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2023-01-26T15:30:00Z">January 26, 2023</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>Enumeration of all cycles is a useful graph operation. This is especially true in cheminformatics, where the set of all cycles is required in tasks ranging from 2D structure layout to electronic characterization and descriptor calculation. Although restricted cycle sets are suitable for some applications, others require exhaustive enumeration. This article introduces a Rust crate for doing that.</p>
<h1 id="introducing-ciclo">Introducing Ciclo</h1>
<p><a href="http://github.com/metamolecular/ciclo/">Ciclo</a> (cì·clo, Italian for &ldquo;cycle&rdquo;) offers a suite of tools for working with cycles, including a function for exhaustive cycle enumeration (<code>all_cycles</code>). Graphs can currently be encoded in <a href="https://en.wikipedia.org/wiki/Edge_list">edge list</a> form. Nodes can be any type implementing the <code>Eq</code>, <code>Hash</code>, <code>Clone</code>, and <code>Debug</code> traits. Ciclo can be installed from <a href="https://crates.io/crates/ciclo">crates.io</a>. For now, Ciclo&rsquo;s scope is limited to exhaustive graph enumeration, but additional cycle utilities might be added later.</p>
<p>The following illustrates the construction of a graph and the enumeration of its cycles.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#66d9ef">use</span> ciclo::Graph;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> ciclo::all_cycles;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">test</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> graph <span style="color:#f92672">=</span> Graph::from_edges(vec![
</span></span><span style="display:flex;"><span>        (<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>),
</span></span><span style="display:flex;"><span>        (<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>),
</span></span><span style="display:flex;"><span>        (<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0</span>),
</span></span><span style="display:flex;"><span>    ]).unwrap();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    println!(all_cycles(graph));
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>More examples can be found in the project&rsquo;s unit test suite.</p>
<h1 id="comparing-cycle-sets">Comparing Cycle Sets</h1>
<p>If you run the code snippet in the preceding section you may notice run-to-run variations. All reported cycles should all be equivalent, but they may not be strictly equal. This results from <code>Graph</code>&rsquo;s use of <code>HashMap</code>, whose key iteration order is non-deterministic.</p>
<p>It&rsquo;s inconvenient to work with cycle sets that may not be strictly equal to each other, especially during development and testing. To solve this problem, Ciclo includes the <code>Cycle</code> type. <code>Cycle</code> can be added to hash maps and sets, allowing the direct comparison of cycle sets, regardless of the manner in which they were generated.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#66d9ef">use</span> std::collections::HashSet;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> ciclo::Graph;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">test</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> left <span style="color:#f92672">=</span> Cycle::new(vec![<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>]);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> right <span style="color:#f92672">=</span> Cycle::new(vec![<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    assert_eq!(left, right)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> <span style="color:#66d9ef">mut</span> set <span style="color:#f92672">=</span> HashSet::new();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    set.insert(left);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    assert!(set.contains(<span style="color:#f92672">&amp;</span>right))
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><code>BTreeMap</code> might look like an option here, but it&rsquo;s not. The order in which cycles are iterated and expressed linearly depends on the implementations of <code>Graph</code> and <code>all_cycles</code>. A hashable <code>Cycle</code> type prevents test suites from failing under future optimization.</p>
<h1 id="about-the-algorithm">About the Algorithm</h1>
<p>Ciclo&rsquo;s <code>all_cycles</code> function is based on an algorithm described in <a href="https://doi.org/10.1021/ci960322f"><em>A New Algorithm for Exhaustive Ring Perception in a Molecular Graph</em></a>. The foundation of this algorithm is the iterative removal of nodes from a <em>path graph</em>. A path graph is an undirected graph where each edge is labeled with a sequence of nodes representing a path.</p>
<p>Removing a node results in the update of all affected edges through <em>path reduction</em>. Path reduction removes a node between two other nodes, updating the respective edges accordingly.</p>
<!-- raw HTML omitted -->
<p>In some cases, path reduction leads to pseudocycles, as below. Such cycles are not reported.</p>
<!-- raw HTML omitted -->
<p>If the node removed from a path graph bears a loop (source and target nodes are identical), a cycle has been detected. The set of all such loops comprises the reported cycle enumeration. The algorithm finishes with the removal of the last node.</p>
<!-- raw HTML omitted -->
<h1 id="conclusion">Conclusion</h1>
<p>Applications in cheminformatics and graph theory more broadly may require access to a graph&rsquo;s set of all cycles. This article introduces a Rust implementation of an algorithm capable of doing so.</p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://localhost:1313/" >
    &copy;  Depth-First 2024 
  </a>
    <div><div class="ananke-socials"></div>
</div>
  </div>
</footer>

  </body>
</html>
