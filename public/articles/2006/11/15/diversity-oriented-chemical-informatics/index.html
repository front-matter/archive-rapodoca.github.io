<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Diversity-Oriented Chemical Informatics | Depth-First</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="How would you enumerate all of the molecules represented by a molecular formula? This question was recently posed to members of the Blue Obelisk mailing list. Formula-based exhaustive structure enumeration may seem on the surface to be just another esoteric problem. Nevertheless, playing with open, interactive software that can perform such enumerations can be a great source of new ideas for applications and unit tests.">
    <meta name="generator" content="Hugo 0.139.4">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    

    
      

    

    

    
      <link rel="canonical" href="http://localhost:1313/articles/2006/11/15/diversity-oriented-chemical-informatics/">
    

    <meta property="og:url" content="http://localhost:1313/articles/2006/11/15/diversity-oriented-chemical-informatics/">
  <meta property="og:site_name" content="Depth-First">
  <meta property="og:title" content="Diversity-Oriented Chemical Informatics">
  <meta property="og:description" content="How would you enumerate all of the molecules represented by a molecular formula? This question was recently posed to members of the Blue Obelisk mailing list. Formula-based exhaustive structure enumeration may seem on the surface to be just another esoteric problem. Nevertheless, playing with open, interactive software that can perform such enumerations can be a great source of new ideas for applications and unit tests.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2006-11-15T00:00:00+00:00">
    <meta property="article:modified_time" content="2006-11-15T00:00:00+00:00">

  <meta itemprop="name" content="Diversity-Oriented Chemical Informatics">
  <meta itemprop="description" content="How would you enumerate all of the molecules represented by a molecular formula? This question was recently posed to members of the Blue Obelisk mailing list. Formula-based exhaustive structure enumeration may seem on the surface to be just another esoteric problem. Nevertheless, playing with open, interactive software that can perform such enumerations can be a great source of new ideas for applications and unit tests.">
  <meta itemprop="datePublished" content="2006-11-15T00:00:00+00:00">
  <meta itemprop="dateModified" content="2006-11-15T00:00:00+00:00">
  <meta itemprop="wordCount" content="688">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Diversity-Oriented Chemical Informatics">
  <meta name="twitter:description" content="How would you enumerate all of the molecules represented by a molecular formula? This question was recently posed to members of the Blue Obelisk mailing list. Formula-based exhaustive structure enumeration may seem on the surface to be just another esoteric problem. Nevertheless, playing with open, interactive software that can perform such enumerations can be a great source of new ideas for applications and unit tests.">

	
  </head><body class="ma0 avenir bg-near-white development">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Depth-First
      
    </a>
    <div class="flex-l items-center">
      

      
      <div class="ananke-socials"></div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Posts
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1">Diversity-Oriented Chemical Informatics</h1>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2006-11-15T00:00:00Z">November 15, 2006</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>How would you enumerate all of the molecules represented by a molecular formula? This question was recently posed to members of the <!-- raw HTML omitted -->Blue Obelisk mailing list<!-- raw HTML omitted -->. Formula-based exhaustive structure enumeration may seem on the surface to be just another esoteric problem. Nevertheless, playing with open, interactive software that can perform such enumerations can be a great source of new ideas for applications and unit tests.</p>
<p>The <!-- raw HTML omitted -->Chemistry Development Kit<!-- raw HTML omitted --> offers a fully-functional exhaustive structure enumerator through its <code>GENMDeterministicGenerator</code> class. This article will use <code>GENMDeterministicGenerator</code> through the <!-- raw HTML omitted -->Ruby CDK<!-- raw HTML omitted --> interface to generate color 2-D images for all molecules of a given molecular formula.</p>
<h1 id="a-solution">A Solution</h1>
<p>The software described in this article will generate a collection of 2-D molecular PNG images based on a user-supplied molecular formula. When viewed in a file browser such as Windows Explorer or <!-- raw HTML omitted -->Konqueror<!-- raw HTML omitted -->, the output is visible as a matrix of images. The filename of each image is given by the SMILES string of the corresponding molecule. All molecules are enumerated, whether they look &ldquo;reasonable&rdquo; or not. As an example, consider a section of the output for &lsquo;C4H8ClNO&rsquo;, which looks like this on my system:</p>
<p><img src="/images/posts/20061115/screenshot.png" alt="Screenshot"></p>
<h1 id="enumerator-a-small-ruby-library">Enumerator: A Small Ruby Library</h1>
<p>We&rsquo;ll create a small Ruby class to do most of the work. Save the following in a file called <!-- raw HTML omitted -->enum.rb<!-- raw HTML omitted -->:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span>require <span style="color:#e6db74">&#39;rubygems&#39;</span>
</span></span><span style="display:flex;"><span>require_gem <span style="color:#e6db74">&#39;rcdk&#39;</span>
</span></span><span style="display:flex;"><span>require <span style="color:#e6db74">&#39;rcdk/util&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>jrequire <span style="color:#e6db74">&#39;org.openscience.cdk.structgen.deterministic.GENMDeterministicGenerator&#39;</span>
</span></span><span style="display:flex;"><span>jrequire <span style="color:#e6db74">&#39;net.sf.structure.cdk.util.ImageKit&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Enumerator</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">initialize</span>(formula)
</span></span><span style="display:flex;"><span>    @generator <span style="color:#f92672">=</span> <span style="color:#66d9ef">Org</span><span style="color:#f92672">::</span><span style="color:#66d9ef">Openscience</span><span style="color:#f92672">::</span><span style="color:#66d9ef">Cdk</span><span style="color:#f92672">::</span><span style="color:#66d9ef">Structgen</span><span style="color:#f92672">::</span><span style="color:#66d9ef">Deterministic</span><span style="color:#f92672">::</span><span style="color:#66d9ef">GENMDeterministicGenerator</span><span style="color:#f92672">.</span>new(formula, <span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>    @width <span style="color:#f92672">=</span> <span style="color:#ae81ff">150</span>
</span></span><span style="display:flex;"><span>    @height <span style="color:#f92672">=</span> <span style="color:#ae81ff">150</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">set_size</span>(width, height)
</span></span><span style="display:flex;"><span>    @width <span style="color:#f92672">=</span> width
</span></span><span style="display:flex;"><span>    @height <span style="color:#f92672">=</span> height
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">write_images</span>
</span></span><span style="display:flex;"><span>    mols <span style="color:#f92672">=</span> @generator<span style="color:#f92672">.</span>getStructures
</span></span><span style="display:flex;"><span>    iterator <span style="color:#f92672">=</span> mols<span style="color:#f92672">.</span>iterator
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (iterator<span style="color:#f92672">.</span>hasNext)
</span></span><span style="display:flex;"><span>      mol <span style="color:#f92672">=</span> <span style="color:#66d9ef">RCDK</span><span style="color:#f92672">::</span><span style="color:#66d9ef">Util</span><span style="color:#f92672">::</span><span style="color:#66d9ef">XY</span><span style="color:#f92672">.</span>coordinate_molecule(iterator<span style="color:#f92672">.</span>next)
</span></span><span style="display:flex;"><span>      smiles <span style="color:#f92672">=</span> <span style="color:#66d9ef">RCDK</span><span style="color:#f92672">::</span><span style="color:#66d9ef">Util</span><span style="color:#f92672">::</span><span style="color:#66d9ef">Lang</span><span style="color:#f92672">.</span>get_smiles(mol)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">Net</span><span style="color:#f92672">::</span><span style="color:#66d9ef">Sf</span><span style="color:#f92672">::</span><span style="color:#66d9ef">Structure</span><span style="color:#f92672">::</span><span style="color:#66d9ef">Cdk</span><span style="color:#f92672">::</span><span style="color:#66d9ef">Util</span><span style="color:#f92672">::</span><span style="color:#66d9ef">ImageKit</span><span style="color:#f92672">.</span>writePNG(mol, @width, @height, <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">#{</span>smiles<span style="color:#e6db74">}</span><span style="color:#e6db74">.png&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><p>As you can see, this class is nothing more than a thin wrapper around a large amount of CDK functionality. Most of the action happens in the <code>write_images</code> method, where three things take place:</p>
<ul>
<li>We retrieve a list of molecules from the <code>GENMDeterministicGenerator</code> instance that satisfy the molecular formula passed to <code>Enumerator's</code> constructor.</li>
<li>These molecules are iterated.</li>
<li>For each molecule, an image is written with the filename given by its SMILES string.</li>
</ul>
<h1 id="testing-the-library">Testing the Library</h1>
<p>To test the library, the following code can either be entered interactively via Interactive Ruby (irb) or saved to a file and run with the Ruby interpreter (ruby):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span>require <span style="color:#e6db74">&#39;enum&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>e<span style="color:#f92672">=</span><span style="color:#66d9ef">Enumerator</span><span style="color:#f92672">.</span>new <span style="color:#e6db74">&#39;C4H8ClNO&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>e<span style="color:#f92672">.</span>write_images
</span></span></code></pre></div><p>Running this code will produce a collection of PNG images in your working directory. By changing the argument passed to the <code>Enumerator</code> constructor, you can change the makeup of the image set.</p>
<h1 id="prerequisites">Prerequisites</h1>
<p>For this tutorial, you&rsquo;ll need <!-- raw HTML omitted -->Ruby CDK<!-- raw HTML omitted --> (RCDK). A recent article described the small amount of system configuration required for <!-- raw HTML omitted -->RCDK on Linux<!-- raw HTML omitted -->. Another article showed how to install <!-- raw HTML omitted -->RCDK on Windows<!-- raw HTML omitted -->.</p>
<h1 id="unexpected-behavior">Unexpected Behavior</h1>
<p>After testing the Enumerator library, you may notice a new file in your working directory called <!-- raw HTML omitted -->structuredata.txt<!-- raw HTML omitted -->. This file is written automatically by <code>GENMDeterministicGenerator</code> on instantiation, providing information on each structure that is generated. The <!-- raw HTML omitted -->CDK API<!-- raw HTML omitted --> does not mention the creation of this file, and it would be preferable for this file to only created on request. I&rsquo;ll be submitting a <!-- raw HTML omitted -->feature request<!-- raw HTML omitted --> to this effect shortly.</p>
<h1 id="food-for-thought">Food for Thought</h1>
<p>If you plan to explore larger areas of chemical space with the Enumerator library, be prepared to wait. The generation of molecules, determination of 2-D coordinates, and rendering can take some time. Of course, the number of molecules increases dramatically with the number of atoms in the molecular formula - a concrete demonstration of what makes organic chemistry the fascinating discipline that it is.</p>
<p>An interesting variation on the ideas presented here would be to filter out molecules based on some criteria. One approach would be to remove molecules containing reactive functionality such as nitrogen substituted with chorine. A SMARTS pattern search could easily form the basis for this filter. In applying this and similar filters, larger areas of interesting chemical space could be sampled in a reasonable amount of time.</p>
<h1 id="conclusions">Conclusions</h1>
<p>CDK&rsquo;s <code>GENMDeterministicGenerator</code> class, when combined with 2-D structure layout and 2-D rendering, provides the foundation of an intriguing tool for exploring chemical diversity. Further combining this capability with that offered by other freely-available tools offers some thought-provoking possibilities.</p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://localhost:1313/" >
    &copy;  Depth-First 2024 
  </a>
    <div><div class="ananke-socials"></div>
</div>
  </div>
</footer>

  </body>
</html>
