<!DOCTYPE html>
<html lang="en-us" dir="ltr" class="scroll-smooth" data-default-appearance="light"
  data-auto-appearance="true"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  
  <meta http-equiv="content-language" content="en-us" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>Running a SMILES Validation Benchmark &middot; Depth-First</title>
  <meta name="title" content="Running a SMILES Validation Benchmark &middot; Depth-First" />
  
  <meta name="description" content="Cleaner cheminformatics datasets begin with standards." />
  
  
  
  <link rel="canonical" href="http://localhost:1313/articles/2020/10/05/running-a-smiles-validation-benchmark/" />
  
  
  
  
  
  
  
  
  
  
  <link type="text/css" rel="stylesheet" href="/css/main.bundle.min.e27868ab1485f7ed7b06b122b4980bd38b19526eb8f7de885181204d28f04a0c47e9c334eff19a06c0278eb2ff8415b983a5d0fb80fd6b5680c926457cc61c57.css"
    integrity="sha512-4nhoqxSF9&#43;17BrEitJgL04sZUm64996IUYEgTSjwSgxH6cM07/GaBsAnjrL/hBW5g6XQ&#43;4D9a1aAySZFfMYcVw==" />
  
  
  <script type="text/javascript" src="/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js"
    integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj&#43;e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script>
  
  
  
  
  
  
  
  
  
  
  
  <script defer type="text/javascript" id="script-bundle" src="/js/main.bundle.min.c178288131a2f1ad46910438db47ac5f7e1c48cf949e49f6dc3310c8ec9660e23fe505805eba4e2e73711335808500360d773a2b64322feb35df52856edca286.js"
    integrity="sha512-wXgogTGi8a1GkQQ420esX34cSM&#43;Unkn23DMQyOyWYOI/5QWAXrpOLnNxEzWAhQA2DXc6K2QyL&#43;s131KFbtyihg==" data-copy="" data-copied=""></script>
  
  
  
  <script src="/lib/zoom/zoom.min.37d2094687372da3f7343a221a470f6b8806f7891aa46a5a03966af7f0ebd38b9fe536cb154e6ad28f006d184b294525a7c4054b6bbb4be62d8b453b42db99bd.js" integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S&#43;Yti0U7QtuZvQ=="></script>
  
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="manifest" href="/site.webmanifest" />
  
  
  
  
  
  
  
  
  <meta property="og:url" content="http://localhost:1313/articles/2020/10/05/running-a-smiles-validation-benchmark/">
  <meta property="og:site_name" content="Depth-First">
  <meta property="og:title" content="Running a SMILES Validation Benchmark">
  <meta property="og:description" content="Cleaner cheminformatics datasets begin with standards.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2020-10-05T18:00:00+00:00">
    <meta property="article:modified_time" content="2020-10-05T18:00:00+00:00">

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Running a SMILES Validation Benchmark">
  <meta name="twitter:description" content="Cleaner cheminformatics datasets begin with standards.">

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "Running a SMILES Validation Benchmark",
    "headline": "Running a SMILES Validation Benchmark",
    
    "abstract": "Cleaner cheminformatics datasets begin with standards.",
    "inLanguage": "en-us",
    "url" : "http:\/\/localhost:1313\/articles\/2020\/10\/05\/running-a-smiles-validation-benchmark\/",
    "author" : {
      "@type": "Person",
      "name": ""
    },
    "copyrightYear": "2020",
    "dateCreated": "2020-10-05T18:00:00\u002b00:00",
    "datePublished": "2020-10-05T18:00:00\u002b00:00",
    
    "dateModified": "2020-10-05T18:00:00\u002b00:00",
    
    
    
    "mainEntityOfPage": "true",
    "wordCount": "2259"
  }]
  </script>


  
  
  
  
  

<script src="/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js" integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj&#43;KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script>






















  
  



  
  
  <meta name="theme-color"/>
  
  
</head>
<body
  class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
  <div id="the-top" class="absolute flex self-center">
    <a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
      href="#main-content"><span
        class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a>
  </div>
  
  
  <div style="padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px"
    class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3">
    
    <div class="flex flex-1 items-center justify-between">
        <nav class="flex space-x-3">

            
            <a href="/" class="text-base font-medium text-gray-500 hover:text-gray-900">Depth-First</a>
            

        </nav>
        <nav class="hidden md:flex items-center space-x-5 md:ml-12 h-12">

            

            


            
            <button id="search-button" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            


            
            
            <div
                class="ltr:mr-14 rtl:ml-14 flex items-center">
                <button id="appearance-switcher" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400">
                    <div class="flex items-center justify-center dark:hidden">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                    </div>
                    <div class="items-center justify-center hidden dark:flex">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                    </div>
                </button>
            </div>
            

        </nav>
        <div class="flex md:hidden items-center space-x-5 md:ml-12 h-12">

            <span></span>

            


            
            <button id="search-button-mobile" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            

            
            
            <button id="appearance-switcher-mobile" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400" style="margin-right:5px">
                <div class="flex items-center justify-center dark:hidden">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                </div>
                <div class="items-center justify-center hidden dark:flex">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                </div>
            </button>
            

        </div>
    </div>
    <div class="-my-2 -mr-2 md:hidden">

        <label id="menu-button" class="block">
            

            </div>
        </label>
    </div>
</div>





  
  <div class="relative flex flex-col grow">
    <main id="main-content" class="grow">
      


<article>
  

  <header id="single_header" class="mt-5 max-w-prose">
    
    <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
      Running a SMILES Validation Benchmark
    </h1>
    <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
      





  
  







  





  



  













<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2020-10-05T18:00:00&#43;00:00">October 5, 2020</time><span class="px-2 text-primary-500">&middot;</span><span>2259 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">11 mins</span>
  

  
  
</div>








    </div>

    
    
    
    
    

    

    
      
      
        
        
<div class="flex author">
  
  <div class="place-self-center">
    
    
    <div class="text-2xl sm:text-lg">
</div>
  </div>
</div>

      

      

      
      <div class="mb-5"></div>
      

    

  </header>
  
  <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
    
    

      <div class="min-w-0 min-h-0 max-w-fit">
        
        


        <div class="article-content max-w-prose mb-20">
          <p>SMILES is an industry standard with a checkered standardization history. Both <a href="https://doi.org/10.1021/ci00057a005" target="_blank">primary literature descriptions</a> and <a href="https://www.daylight.com/dayhtml/doc/theory/theory.smiles.html" target="_blank">online documentation</a> left crucial points unaddressed. These limitations resulted in <a href="http://opensmiles.org/opensmiles.html" target="_blank">OpenSMILES</a>, the first independent attempt to codify the syntax and semantics of the SMILES language. Even so, the situation today still resembles that of two decades ago: the rules of SMILES are encoded by a handful of commonly-used cheminformatics toolkits. This state of affairs may have been tolerable two decades ago when large compound collections rarely left the confines of their host institutions. But the increasing importance of shared public datasets exposes cracks that are increasingly hard to ignore.</p>
<p>Recent articles on this blog have highlighted <a href="/articles/2020/06/01/chemcore-a-cheminformatics-toolkit-for-rust/">ChemCore</a>, an evolving cheminformatics toolkit written in Rust. Among its features is an OpenSMILES-based reader. The lack of an OpenSMILES validation suite leaves toolkit developers without a way to demonstrate compliance. Fortunately, a workaround exists in the form of validation benchmark that reports the behavior of the most common toolkits. This article reports the results of implementing that benchmark with ChemCore.</p>


<h1 class="relative group">About the Benchmark 
    <div id="about-the-benchmark" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#about-the-benchmark" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>The approach used here was outlined in a <a href="https://www.slideshare.net/NextMoveSoftware/a-de-facto-standard-or-a-freeforall" target="_blank">presentation</a> and <a href="https://www.nextmovesoftware.com/products/SMILESBenchmark_ICCS_May2018.pdf" target="_blank">poster</a> from Noel O&rsquo;Boyle in 2018. It begins with a simple question: although toolkits can usually read their own SMILES, how well do they read SMILES written by other toolkits? Contained within the question is the realization that no toolkit is authoritative. They merely exhibit behavior that is more or less consistent with publicly-available documentation.</p>
<p>The result was the <a href="https://github.com/nextmovesoftware/smilesreading" target="_blank">SMILES reading benchmark</a> (&ldquo;the benchmark&rdquo;). At its center the benchmark contains a master file of 47,463 SMILES drawn from the <a href="https://www.ebi.ac.uk/chembl/" target="_blank">ChEMBL23 dataset</a>. For maximum readability, the entries in this file are encoded with <a href="/articles/2020/02/10/a-comprehensive-treatment-of-aromaticity-in-the-smiles-language/">aromaticity</a> disabled. Each toolkit then translates this file into one with aromaticity enabled. Each file produced in this way is then processed by each cheminformatics toolkit in turn to produce a family of output files encoding atomic hydrogen counts. Differences in SMILES reading behavior can be identified by diffing two output files.</p>


<h1 class="relative group">ChemCore SMILES Support 
    <div id="chemcore-smiles-support" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#chemcore-smiles-support" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p><a href="/articles/2020/06/01/chemcore-a-cheminformatics-toolkit-for-rust/">ChemCore</a> is an open source cheminformatics toolkit written in Rust. It implements a <code>read</code> function supporting most of the <a href="http://opensmiles.org/opensmiles.html" target="_blank">Open SMILES</a> specification, including aromaticity. As need and opportunity arise, additional SMILES support will be added in the form of a <code>write</code> function.</p>


<h1 class="relative group">The Project 
    <div id="the-project" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#the-project" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>It&rsquo;s one thing to make the claim that a toolkit conforms to published documentation, but another to prove it. In the absence of a validation suite, the benchmark offers a convenient way to get some basic information. Here&rsquo;s an overview of my implementation:</p>
<ol>
<li>Create a blank Rust project.</li>
<li>Add a <code>main</code> method.</li>
<li><code>main</code> reads each aromatic smiles benchmark file.</li>
<li>For each file, write an output file in which each line records the hydrogen counts on each atom.</li>
<li>Use the Unix utility <code>diff</code> to compare the generated output files with those provided by the benchmark.</li>
</ol>
<p><a href="https://github.com/rapodaca/smiles_benchmark" target="_blank">The project</a> is available on GitHub, and the benchmark is included as a Git submodule for convenience. The following sequence will clone the repository and initialize the benchmark submodule.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>git clone https://github.com/rapodaca/smiles_benchmark.git
</span></span><span style="display:flex;"><span>cd smiles_benchmark
</span></span><span style="display:flex;"><span>git submodule update --init
</span></span></code></pre></div>

<h1 class="relative group">Run the Benchmark 
    <div id="run-the-benchmark" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#run-the-benchmark" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Once cloned and initialized, the project can be run in the usual way with:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>cargo run
</span></span></code></pre></div><p>Allow about ten minutes for the program to run. On completion, the <code>results</code> directory will contain a collection of output files ready for use. Execution can be aborted by pressing control-c.</p>


<h1 class="relative group">Output 
    <div id="output" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#output" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>The text files produced by the Rust program all have the same format. Each line represents the result of parsing an aromatic SMILES and summing atomic <a href="/articles/2019/11/06/virtual-hydrogens/">virtual and implicit hydrogen</a> counts. The first entry on the line is the SMILES ID, obtained from the benchmark source file. The remaining entries are hydrogen counts.</p>
<p>For example, the first line of the file <code>openbabel_dev4Aug17.txt</code> output file is:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>0 2 0 2
</span></span></code></pre></div><p>This line says that the SMILES assigned to ID 0 has three atoms, and their hydrogen counts are 2, 0, and 2, respectively. This approach requires that: (1) atomic indexes are faithfully captured by the <code>read</code> function; and (2) atomic indexes are stable. ChemCore meets both requirements by design.</p>


<h1 class="relative group">Evaluation 
    <div id="evaluation" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#evaluation" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Evaluation relies on the Unix <code>diff</code> utility to compare the file generated by ChemCore with the the one generated by another toolkit reading exactly the same file. For example, the following will compare ChemCore&rsquo;s atomic hydrogen counts with those of the Aug 2017 version of <a href="http://openbabel.org/wiki/Main_Page" target="_blank">Open Babel</a>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>diff results/openbabel_dev4Aug17.txt  &lt;(gzip -dc smilesreading/3-results/chembl/openbabel_dev9May18_reading_openbabel_dev4Aug17.txt.gz) --strip-trailing-cr | code -
</span></span></code></pre></div><p>Two things are noteworthy here. First, the output is piped to my editor of choice, Visual Studio Code. If using this approach, the trailing dash (<code>-</code>) is required. Other editors may have their own requirements. Alternatively, pipe can be omitted, directing output to the console. Second, <code>diff</code> is comparing the uncompressed output file produced by the program with a compressed file contained in the benchmark. This is the part starting with the less than (<code>&lt;</code>) symbol and wrapped in parentheses.</p>
<p>The result is the following diff:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>2235c2235
</span></span><span style="display:flex;"><span>&lt; # 2234 Bad_valence
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>&gt; <span style="color:#ae81ff">2234</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>6441c6441
</span></span><span style="display:flex;"><span>&lt; # 6440 Bad_valence
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>&gt; <span style="color:#ae81ff">6440</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>8288c8288
</span></span><span style="display:flex;"><span>&lt; # 8287 Bad_valence
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>&gt; <span style="color:#ae81ff">8287</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>19611c19611
</span></span><span style="display:flex;"><span>&lt; # 19610 Bad_valence
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>&gt; <span style="color:#ae81ff">19610</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>42337c42337
</span></span><span style="display:flex;"><span>&lt; # 42336 Bad_valence
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>&gt; <span style="color:#ae81ff">42336</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span>
</span></span></code></pre></div><p>Out of over 47,000 tests, only five differences were found between ChemCore&rsquo;s interpretation and that of Open Babel. All of the differences result from ChemCore <em>rejecting</em> SMILES that were accepted by Open Babel. What are these SMILES and what causes the difference in behavior?</p>
<p>The relevant identifiers are 2234, 6440, 8287, 19610, and 42336. The corresponding SMILES can be obtained by opening the applicable source benchmark file:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>cat &lt;(gzip -dc smilesreading/2-aromaticsmiles/chembl/openbabel_dev4Aug17.smi.gz) | code -
</span></span></code></pre></div><p>To recap, the <code>*.smi.gz</code> benchmark file was produced from Open Babel&rsquo;s translation of the non-aromatic benchmark file. Searching the translation for the given identifiers yields the following SMILES, in which comments refer to a zero-based atomic indexing system:</p>
<ul>
<li>2234 (<code>N1[CH](=S)N(C=N1)C</code>). Atom 1 is pentavalent carbon.</li>
<li>6440 (<code>C1=CC=C2[C](=C1)=NC=C2</code>). Atom 4 is pentavalent carbon.</li>
<li>8287 (<code>C1=[C]2=CC=NC2=CC=C1</code>). Atom 1 is pentavalent carbon.</li>
<li>19610 (<code>C12C(CCC[H]1)CCC1C2CCC2C1CCC2</code>). Atom 5 is divalent hydrogen.</li>
<li>42336 (<code>O1[Mg]2(Oc3c(cccc3)C(=O)O2)Oc2c(C1=O)cccc2</code>). Atom 1 is tetravalent magnesium.</li>
</ul>
<p>The reason for the discrepancy is the same in all cases: ChemCore considers bonding arrangements requiring the promotion of core electrons or the invocation of negative electron counts to be errors.</p>
<p>Recall that abundant experimental evidence demonstrates that covalent bonding of the type SMILES captures occurs through valence electrons only. Core electrons do not participate in covalent bonding. A SMILES with a pentavalent carbon requires at least one bond formed with a core electron. In the vast majority of cases, such SMILES represent encoding or software errors. Although less obvious, a similar argument applies to tetravalent magnesium. The situation is even more obvious with divalent hydrogen, which requires the invocation of <em>negative</em> electron count.</p>
<p>For this reason, ChemCore considers molecules containing pentavalent carbon, tetravalent magnesium, and divalent hydrogen to be errors by default. In the interest in breaking the chain of error propagation, attempting to generate such a molecule yields an error.</p>
<p>Note that ChemCore tolerates <em><a href="https://en.wikipedia.org/wiki/Hypervalent_molecule" target="_blank">hypervalence</a></em>. Hypervalence occurs when an atom taps normally inert valence electrons to yield an unusual valence state. For example, nitrogen has five valence electrons. If all are used in covalent bonding the result is pentavalent nitrogen. Such species do not involve core electrons. OpenSMILES explicitly allows pentavalent nitrogen and other hypervalent states as well.</p>
<p>ChemCore supports all forms of hypervalence involving valence electrons. For those extremely rare cases in which the rules are too strict, ChemCore&rsquo;s underlying SMILES reader <a href="/articles/2020/05/25/lets-build-a-smiles-parser-in-rust/">Purr</a> can be used directly.</p>


<h1 class="relative group">Comparison with Other Toolkits 
    <div id="comparison-with-other-toolkits" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#comparison-with-other-toolkits" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Before discussing differences between ChemCore and other toolkits, it should be emphasized that the benchmark was compiled two years ago. This is ample time to address the issues reported here. Nor is the intent to bash any other software. Instead, the goal is to highlight the kinds of differences that can arise when comparing SMILES reading across a wide range of implementations.</p>
<p>Diffing ChemCore&rsquo;s output with that of the relevant benchmark files yielded several observations about other toolkits. They include:</p>
<ul>
<li><strong>Invalid Aromatic Atoms.</strong> OpenSMILES supports a limited set of aromatic (lower case) atoms. Not among them are aromatic tellurium (<code>te</code>) or iodine (<code>i</code>). These atoms are rejected by ChemCore, but some toolkits nevertheless wrote and read them. Aromatic tellurium was especially common, as found in: BIOVIADraw; KnowItAll; OEChem; and RDKit. BIOVIADraw wrote and read aromatic iodine (<code>i</code>).</li>
<li><strong>Inconsistent Double Bond Conformation.</strong> OpenSMILES presents detailed guidelines about the encoding of double bond conformation, which ChemCore follows. Two toolkits read and wrote SMILES with inconsistent encodings: Avalon and OpenChemLib.</li>
<li><strong>Missed Kekulization Error.</strong> OpenSMILES offers little in the way of actionable advice for the kekulization of molecules encoded by aromatic SMILES. To address this problem, <a href="/articles/2020/02/10/a-comprehensive-treatment-of-aromaticity-in-the-smiles-language/">I wrote this detailed proposal</a>, which ChemCore follows. In a nutshell, ChemCore will kekulize only those molecules whose π-subgraphs produce a <a href="/articles/2020/09/28/edmonds-blossom-algorithm-part-1-cast-of-characters/">perfect matching</a>. A SMILES failing this test is considered invalid. Some toolkits kekulized these SMILES without errors, including: Avalon; ChemDoodle API; KnowItAll; OEChem and OpenChemLib.</li>
<li><strong>False Kekulization Error.</strong> One toolkit (JChem) was unable to kekulize several valid aromatic SMILES. This may be <a href="https://twitter.com/baoilleach/status/1313186117374574592" target="_blank">connected</a> to the use of differing toolkit releases to write and read SMILES.</li>
<li><strong>Overwriting Virtual Hydrogen Count.</strong> OpenSMILES requires virtual hydrogen counts, as defined within bracket atoms, to override implicit hydrogen counts. Lack of a count in a bracket atom is interpreted as zero hydrogens. One toolkit, BIOVIADraw, overwrote virtual hydrogen counts, leading to discrepancies with ChemCore&rsquo;s output.</li>
<li><strong>False Valence Error.</strong> One toolkit, Indigo, reported as errors SMILES that are explicitly permitted by OpenSMILES. For example, the presence of pentavalent nitrogen caused entries to be rejected.</li>
<li><strong>Inaccurate Implicit Hydrogen Count.</strong> Two toolkits, BIOVIADraw and iwtoolkit, reported implicit hydrogen counts inconsistent with the <a href="/articles/2020/06/08/hydrogen-suppression-in-smiles/">SMILES valence model</a>.</li>
<li><strong>Missed Valence Error.</strong> Toolkits found to allow SMILES encoding atoms in which core electrons are used for covalent bonding included: BioVIADraw; CDK; Indigo; and OpenBabel.</li>
</ul>


<h1 class="relative group">Not Included 
    <div id="not-included" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#not-included" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>The benchmark supports comparisons other than the one highlighted here. Unfortunately, they tend to require the ability to write SMILES. When ChemCore gains that capability, the remaining comparisons will be reported.</p>


<h1 class="relative group">Rust Implementation 
    <div id="rust-implementation" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#rust-implementation" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>To the best of my knowledge, the ChemCore SMILES validation project adheres to widely-practiced Rust coding standards. As such, it can be used as template for other projects that read text file data and write one or more reports to disk.</p>
<p>The <code>main</code> function kicks things off by setting up read and write directories, then iterating over each entry in the read directory.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">main</span>() -&gt; <span style="color:#a6e22e">io</span>::Result<span style="color:#f92672">&lt;</span>()<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> write_root <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;./results/&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> _ <span style="color:#f92672">=</span> fs::create_dir(write_root);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> read_root <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;./smilesreading/2-aromaticsmiles/chembl&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> result <span style="color:#66d9ef">in</span> fs::read_dir(read_root)<span style="color:#f92672">?</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">let</span> entry <span style="color:#f92672">=</span> result<span style="color:#f92672">?</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">let</span> writer <span style="color:#f92672">=</span> create_writer(<span style="color:#f92672">&amp;</span>entry, write_root)<span style="color:#f92672">?</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">let</span> reader <span style="color:#f92672">=</span> create_reader(<span style="color:#f92672">&amp;</span>entry)<span style="color:#f92672">?</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        process_file(reader, writer)<span style="color:#f92672">?</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Ok(())
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>For each entry, <code>process_file</code> is called. Taking a reader and mutable writer as arguments, its job is to deflate a gzipped source file, extract its id and SMILES, then pass this information to <code>write_line</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">process_file</span>(
</span></span><span style="display:flex;"><span>    reader: <span style="color:#a6e22e">io</span>::BufReader<span style="color:#f92672">&lt;</span>GzDecoder<span style="color:#f92672">&lt;</span>std::fs::File<span style="color:#f92672">&gt;&gt;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">mut</span> writer: <span style="color:#a6e22e">io</span>::LineWriter<span style="color:#f92672">&lt;</span>std::fs::File<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>) -&gt; <span style="color:#a6e22e">io</span>::Result<span style="color:#f92672">&lt;</span>()<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> result <span style="color:#66d9ef">in</span> reader.lines() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">let</span> line <span style="color:#f92672">=</span> result<span style="color:#f92672">?</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">let</span> parts <span style="color:#f92672">=</span> line.split_whitespace().collect::<span style="color:#f92672">&lt;</span>Vec<span style="color:#f92672">&lt;</span>_<span style="color:#f92672">&gt;&gt;</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">let</span> id <span style="color:#f92672">=</span> parts.last().expect(<span style="color:#e6db74">&#34;no parts&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> parts.len() <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span> {
</span></span><span style="display:flex;"><span>            writeln!(<span style="color:#f92672">&amp;</span><span style="color:#66d9ef">mut</span> writer, <span style="color:#e6db74">&#34;# {} No_input&#34;</span>, id)<span style="color:#f92672">?</span>;
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">continue</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        write_line(id, parts.first().expect(<span style="color:#e6db74">&#34;no smiles&#34;</span>), <span style="color:#f92672">&amp;</span><span style="color:#66d9ef">mut</span> writer)<span style="color:#f92672">?</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Ok(())
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><code>write_line</code> accepts an id, SMILES, and <code>LineWriter</code>, using the writer to write one line reporting the status of the SMILES analysis. The analysis consists of counting the hydrogens on each atom when SMILES parsing through ChemCore is successful. Otherwise, one of three error lines is reported.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">write_line</span>(
</span></span><span style="display:flex;"><span>    id: <span style="color:#66d9ef">&amp;</span><span style="color:#66d9ef">str</span>,
</span></span><span style="display:flex;"><span>    smiles: <span style="color:#66d9ef">&amp;</span><span style="color:#66d9ef">str</span>,
</span></span><span style="display:flex;"><span>    writer: <span style="color:#66d9ef">&amp;</span><span style="color:#a6e22e">mut</span> io::LineWriter<span style="color:#f92672">&lt;</span>std::fs::File<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>) -&gt;<span style="color:#a6e22e">io</span>::Result<span style="color:#f92672">&lt;</span>()<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">match</span> daylight::read(smiles) {
</span></span><span style="display:flex;"><span>        Ok(molecule) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">let</span> hcounts <span style="color:#f92672">=</span> molecule.nodes().iter().map(<span style="color:#f92672">|</span>id<span style="color:#f92672">|</span> {
</span></span><span style="display:flex;"><span>                molecule.hydrogens(<span style="color:#f92672">*</span>id).unwrap().to_string()
</span></span><span style="display:flex;"><span>            }).collect::<span style="color:#f92672">&lt;</span>Vec<span style="color:#f92672">&lt;</span>_<span style="color:#f92672">&gt;&gt;</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            writeln!(writer, <span style="color:#e6db74">&#34;{} {}&#34;</span>, id, hcounts.join(<span style="color:#e6db74">&#34; &#34;</span>))<span style="color:#f92672">?</span>;
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        Err(Error::CanNotKekulize) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>            writeln!(writer, <span style="color:#e6db74">&#34;# {} Kekulization_failure&#34;</span>, id)<span style="color:#f92672">?</span>;
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        Err(Error::Hypervalent(_)) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>            writeln!(writer, <span style="color:#e6db74">&#34;# {} Bad_valence&#34;</span>, id)<span style="color:#f92672">?</span>;
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        Err(error) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>            writeln!(writer, <span style="color:#e6db74">&#34;# {} ERROR: {:?}&#34;</span>, id, error)<span style="color:#f92672">?</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Ok(())
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div>

<h1 class="relative group">Conclusion 
    <div id="conclusion" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#conclusion" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Testing ChemCore in the benchmark revealed few unexpected differences between it and more established toolkits. This can be credited to the fact that the benchmark was used to develop the reader. Doing so caught numerous non-obvious bugs. The benchmark demonstrated clear value to this toolkit developer.</p>
<p>Additionally, I think the benchmark could be useful to certain toolkit <em>users</em>. For example, any user who cares about data quality may want to consider running their toolkit against the benchmark. Users with access to more than one toolkit might use the benchmark when considering which one to use for processing external data. I suspect there will be a few surprises.</p>
<p>In principle, a given SMILES should unambiguously represent a specific molecular graph. In practice, things are complicated. As of 2017 the benchmark reveals important differences in how SMILES are interpreted. As long as these differences persist or at least remain undocumented, those working to improve dataset quality in cheminformatics will have the deck stacked against them.</p>
<p>Two changes would go a long way to correcting the situation. First, SMILES standardization efforts should nail down currently-vague areas such as the interpretation of aromatic SMILES. Second, a freely-available validation suite that exercises all SMILES features would allow developers to better align their products with any proposed standard, and document deviations from it.</p>

          
          
          
        </div>
        
        

        
        

          
      </div>
     
      
      
        
        
          
          
        
      <script>
        var oid = "views_posts\/2020-10-05-running-a-smiles-validation-benchmark.md"
        var oid_likes = "likes_posts\/2020-10-05-running-a-smiles-validation-benchmark.md"
      </script>
      
      
      <script type="text/javascript" src="/js/page.min.0860cf4e04fa2d72cc33ddba263083464d48f67de06114529043cb4623319efed4f484fd7f1730df5abea0e2da6f3538855634081d02f2d6e920b956f063e823.js" integrity="sha512-CGDPTgT6LXLMM926JjCDRk1I9n3gYRRSkEPLRiMxnv7U9IT9fxcw31q&#43;oOLabzU4hVY0CB0C8tbpILlW8GPoIw=="></script>
      
  
    </section>
  <footer class="pt-8 max-w-prose print:hidden">

    
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group mr-3" href="/articles/2020/09/28/edmonds-blossom-algorithm-part-1-cast-of-characters/">
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Edmonds' Blossom Algorithm Part 1: Cast of Characters</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2020-09-28T13:00:00&#43;00:00">September 28, 2020</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="flex text-right group ml-3" href="/articles/2020/10/12/start-seeing-valence-and-core-electrons/">
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Start Seeing Valence and Core Electrons</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2020-10-12T18:00:00&#43;00:00">October 12, 2020</time>
                  
                </span>
              </span>
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


    
  </footer>
</article>

      <div id="top-scroller" class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0">
  <a href="#the-top"
    class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top" title="Scroll to top">
    &uarr;
  </a>
</div>
    </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
  
  <div class="flex items-center justify-between">

    
    
    <p class="text-sm text-neutral-500 dark:text-neutral-400">
      &copy;
      2024
      
    </p>
    

    
    
    <p class="text-xs text-neutral-500 dark:text-neutral-400">
      
      
      Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a>
    </p>
    

  </div>
  <script>
    
    mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
      margin: 24,
      background: 'rgba(0,0,0,0.5)',
      scrollOffset: 0,
    })
    
  </script>
  
  
  <script type="text/javascript" src="/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js" integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]"
  data-url="http://localhost:1313/"
  style="z-index:500"
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)"
      >
        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

  </div>
</body>

</html>
