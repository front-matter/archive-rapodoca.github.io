<!DOCTYPE html>
<html lang="en-us" dir="ltr" class="scroll-smooth" data-default-appearance="light"
  data-auto-appearance="true"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  
  <meta http-equiv="content-language" content="en-us" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>Multi-Atom Bonding in Cheminformatics &middot; Depth-First</title>
  <meta name="title" content="Multi-Atom Bonding in Cheminformatics &middot; Depth-First" />
  
  <meta name="description" content="A critical look at the industry-standard approach to bonding, and an alternative." />
  
  
  
  <link rel="canonical" href="http://localhost:1313/articles/2020/04/27/multi-atom-bonding-in-cheminformatics/" />
  
  
  
  
  
  
  
  
  
  
  <link type="text/css" rel="stylesheet" href="/css/main.bundle.min.e27868ab1485f7ed7b06b122b4980bd38b19526eb8f7de885181204d28f04a0c47e9c334eff19a06c0278eb2ff8415b983a5d0fb80fd6b5680c926457cc61c57.css"
    integrity="sha512-4nhoqxSF9&#43;17BrEitJgL04sZUm64996IUYEgTSjwSgxH6cM07/GaBsAnjrL/hBW5g6XQ&#43;4D9a1aAySZFfMYcVw==" />
  
  
  <script type="text/javascript" src="/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js"
    integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj&#43;e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script>
  
  
  
  
  
  
  
  
  
  
  
  <script defer type="text/javascript" id="script-bundle" src="/js/main.bundle.min.c178288131a2f1ad46910438db47ac5f7e1c48cf949e49f6dc3310c8ec9660e23fe505805eba4e2e73711335808500360d773a2b64322feb35df52856edca286.js"
    integrity="sha512-wXgogTGi8a1GkQQ420esX34cSM&#43;Unkn23DMQyOyWYOI/5QWAXrpOLnNxEzWAhQA2DXc6K2QyL&#43;s131KFbtyihg==" data-copy="" data-copied=""></script>
  
  
  
  <script src="/lib/zoom/zoom.min.37d2094687372da3f7343a221a470f6b8806f7891aa46a5a03966af7f0ebd38b9fe536cb154e6ad28f006d184b294525a7c4054b6bbb4be62d8b453b42db99bd.js" integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S&#43;Yti0U7QtuZvQ=="></script>
  
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="manifest" href="/site.webmanifest" />
  
  
  
  
  
  
  
  
  <meta property="og:url" content="http://localhost:1313/articles/2020/04/27/multi-atom-bonding-in-cheminformatics/">
  <meta property="og:site_name" content="Depth-First">
  <meta property="og:title" content="Multi-Atom Bonding in Cheminformatics">
  <meta property="og:description" content="A critical look at the industry-standard approach to bonding, and an alternative.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2020-04-27T18:00:00+00:00">
    <meta property="article:modified_time" content="2020-04-27T18:00:00+00:00">

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Multi-Atom Bonding in Cheminformatics">
  <meta name="twitter:description" content="A critical look at the industry-standard approach to bonding, and an alternative.">

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "Multi-Atom Bonding in Cheminformatics",
    "headline": "Multi-Atom Bonding in Cheminformatics",
    
    "abstract": "A critical look at the industry-standard approach to bonding, and an alternative.",
    "inLanguage": "en-us",
    "url" : "http:\/\/localhost:1313\/articles\/2020\/04\/27\/multi-atom-bonding-in-cheminformatics\/",
    "author" : {
      "@type": "Person",
      "name": ""
    },
    "copyrightYear": "2020",
    "dateCreated": "2020-04-27T18:00:00\u002b00:00",
    "datePublished": "2020-04-27T18:00:00\u002b00:00",
    
    "dateModified": "2020-04-27T18:00:00\u002b00:00",
    
    
    
    "mainEntityOfPage": "true",
    "wordCount": "2145"
  }]
  </script>


  
  
  
  
  

<script src="/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js" integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj&#43;KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script>






















  
  



  
  
  <meta name="theme-color"/>
  
  
</head>
<body
  class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
  <div id="the-top" class="absolute flex self-center">
    <a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
      href="#main-content"><span
        class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a>
  </div>
  
  
  <div style="padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px"
    class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3">
    
    <div class="flex flex-1 items-center justify-between">
        <nav class="flex space-x-3">

            
            <a href="/" class="text-base font-medium text-gray-500 hover:text-gray-900">Depth-First</a>
            

        </nav>
        <nav class="hidden md:flex items-center space-x-5 md:ml-12 h-12">

            

            


            
            <button id="search-button" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            


            
            
            <div
                class="ltr:mr-14 rtl:ml-14 flex items-center">
                <button id="appearance-switcher" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400">
                    <div class="flex items-center justify-center dark:hidden">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                    </div>
                    <div class="items-center justify-center hidden dark:flex">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                    </div>
                </button>
            </div>
            

        </nav>
        <div class="flex md:hidden items-center space-x-5 md:ml-12 h-12">

            <span></span>

            


            
            <button id="search-button-mobile" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            

            
            
            <button id="appearance-switcher-mobile" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400" style="margin-right:5px">
                <div class="flex items-center justify-center dark:hidden">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                </div>
                <div class="items-center justify-center hidden dark:flex">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                </div>
            </button>
            

        </div>
    </div>
    <div class="-my-2 -mr-2 md:hidden">

        <label id="menu-button" class="block">
            

            </div>
        </label>
    </div>
</div>





  
  <div class="relative flex flex-col grow">
    <main id="main-content" class="grow">
      


<article>
  

  <header id="single_header" class="mt-5 max-w-prose">
    
    <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
      Multi-Atom Bonding in Cheminformatics
    </h1>
    <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
      





  
  







  





  



  













<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2020-04-27T18:00:00&#43;00:00">April 27, 2020</time><span class="px-2 text-primary-500">&middot;</span><span>2145 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">11 mins</span>
  

  
  
</div>








    </div>

    
    
    
    
    

    

    
      
      
        
        
<div class="flex author">
  
  <div class="place-self-center">
    
    
    <div class="text-2xl sm:text-lg">
</div>
  </div>
</div>

      

      

      
      <div class="mb-5"></div>
      

    

  </header>
  
  <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
    
    

      <div class="min-w-0 min-h-0 max-w-fit">
        
        


        <div class="article-content max-w-prose mb-20">
          <p>Over the last several decades, cheminformatics has managed to produce <a href="http://openbabel.org/docs/current/FileFormats/Overview.html" target="_blank">a few dozen</a> different ways to exchange molecular encodings and metadata. Despite ongoing experimentation with high-level encoding techniques, these formats are mostly devoid of new ideas around bonding. To the extent that bonding relationships are encoded at all, they occur almost universally as the union of exactly two atoms. This narrow focus finds its way into the major cheminformatics toolkits and ultimately user-facing tools.</p>
<p>Chemists for their part have ignored the cheminformaticians completely. Over the <a href="https://en.wikipedia.org/wiki/Ferrocene" target="_blank">last 70 years</a>, chemists across disciplines have created a dizzying array of stable substances for which a two-atom bonding model is not only inconvenient, but downright wrong. <a href="https://en.wikipedia.org/wiki/List_of_Nobel_laureates_in_Chemistry" target="_blank">Multiple Nobel prizes</a> have been awarded for work featuring stable species flouting the bonding norms of cheminformatics.</p>
<p>This article takes a closer look at cheminformatics&rsquo; two-atom bonding fixation, some consequences, and a solution.</p>


<h1 class="relative group">The Two-Atom Model of Bonding 
    <div id="the-two-atom-model-of-bonding" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#the-two-atom-model-of-bonding" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>The two-atom model of bonding traces its roots to <a href="https://en.wikipedia.org/wiki/Valence_bond_theory" target="_blank">valence bond theory</a>. But in terms of graph theory, a two-atom bond is just a labeled edge of a molecular graph. Toolkits and file formats differ on what to call these edge labels, their syntax, and their semantics. In SMILES, a bond is an edge labeled with a &ldquo;type&rdquo; property that can assume the values: blank; colon (<code>:</code>); hyphen (<code>-</code>); equals (<code>=</code>); octothorpe (<code>#</code>); dollar (<code>$</code>); forward slash (<code>/</code>); and backslash (<code>\</code>). In molfiles, a bond is an edge labeled with a &ldquo;type&rdquo; property (values 1, 2, or 3) and a &ldquo;stereo&rdquo; property (values 0, 1, 3, 4, and 6). In many cheminformatics toolkits, a bond is an edge labeled with an &ldquo;order&rdquo; property that assumes a positive floating-point values.</p>
<p>More broadly speaking, the two-atom bond in cheminformatics serves as an anchor for two properties: (1) a bond order; and (2) a stereo descriptor. I&rsquo;ll discuss stereo descriptors in detail later. For now, let&rsquo;s focus on bond order.</p>
<p>As <a href="/articles/2020/03/16/formal-charge-and-bond-order-are-side-effects/">noted previously</a>, bond order is a computation, not an attribute. This means that it should be derived from one or more attributes. A more robust, but rarely-used, statement of the two-atom model would associate an electron count attribute with an edge. Bond order can then be computed as one-half the electron count. A single bond contains two electrons, a double bond four, and so on. From this perspective, <a href="https://doi.org/10.1021/ci200488k" target="_blank">zero-order bonds</a> seem reasonable as well.</p>
<p>It&rsquo;s not hard to understand the reluctance of cheminformatics to embrace multi-atom bonding. Two-atom bonding is relatively easy to implement. Few common tools support multi-atom bonding. But it turns out that chemistry doesn&rsquo;t care about any of that.</p>


<h1 class="relative group">Practical Consequences 
    <div id="practical-consequences" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#practical-consequences" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>From 2007-2008 I published a series of about 20 short posts highlighting experimental work with substances that could not be adequately represented using prevailing concepts of bonding (and stereochemistry) in cheminformatics. They were all titled <em>How Would Your Cheminformatics Tool Do This?</em> (<a href="/articles/2008/01/10/how-would-your-cheminformatics-tool-do-this/">example</a>). Others have noted similar limitations, to varying degrees, before and since.</p>
<p>At the center of it all lies the two-atom bonding model, which is insufficient for representing large swaths of chemistry today. The problems are many, but often take the form of symmetry artifacts. Atoms that are clearly equivalent become artificially differentiated when two-atom bonds must be used. Additionally, two-atom bonds may lead to hydrogen and electron miscounts.Consider these cases:</p>
<ul>
<li><strong>Organometallics.</strong> These species span a wide range of complexity. At one end, simple <a href="https://en.wikipedia.org/wiki/Boranes" target="_blank">boranes</a> feature three-centered, two-electron boron-hydrogen-boron bonds. At the other end, borane and other metal <a href="https://en.wikipedia.org/wiki/Polyhedral_skeletal_electron_pair_theory" target="_blank">clusters</a> feature molecular orbitals spanning many atoms. In between are <a href="https://en.wikipedia.org/wiki/Metallocene" target="_blank">metallocenes</a>, various <a href="https://en.wikipedia.org/wiki/Transition-metal_allyl_complex" target="_blank">π-allyl species</a>, and a variety of others.</li>
<li><strong>Aromaticity.</strong> Benzene and naphthalene are well-known examples of this very large class. But we don&rsquo;t need to stray far before problems arise. Take the <a href="https://en.wikipedia.org/wiki/Cyclopentadienyl_anion" target="_blank">cyclopentadienyl anion</a> or <a href="https://en.wikipedia.org/wiki/Cyclopropenium_ion" target="_blank">cyclopropenium ion</a> for example. Two-atom bonds fail utterly to capture the symmetry of these species. More broadly, we can find numerous examples of acyclic electron delocalization starting with the humble allyl radical.</li>
<li><strong>Tautomers.</strong> The flip-side of electron delocalization is hydrogen delocalization. <a href="https://chemrxiv.org/articles/Toward_a_Comprehensive_Treatment_of_Tautomerism_in_Chemoinformatics_Including_in_InChI_V2/10794962/1?file=19306895" target="_blank">Tautomers</a> arise from electron shifts capable of capturing or releasing atoms, typically hydrogen. The phenomenon can be seen in <a href="https://doi.org/10.1007/s10822-010-9329-5" target="_blank">numerous molecules</a> in common use, many of which feature prominently in the pharmaceutical industry.</li>
</ul>
<p>Now consider the practical consequences. In 2017, a team working with the Cambridge Crystallographic Data Center collection <a href="https://www.ccdc.cam.ac.uk/support-and-resources/ccdcresources/fba10d07e3ca4191be2785335797a758.pdf" target="_blank">reported</a> that out of a subset of about 500K entries, InChIs could be successfully generated for just 100K. Half of these were categorized as &ldquo;not organic.&rdquo; A similar effort using SMILES with the <a href="http://www.crystallography.net/cod/" target="_blank">Crystallography Open Database</a> resorted to a <a href="https://doi.org/10.1186/s13321-018-0279-6" target="_blank">series of conventions</a> to deal with organometallic bonding. Meanwhile, the lack of formats capable of representing aromaticity has lead (and will likely continue to lead) to <a href="https://www.slideshare.net/baoilleach/we-need-to-talk-about-kekulization-aromaticity-and-smiles" target="_blank">conversion errors</a>. Although InChI has done a lot to alleviate the problem of accounting for tautomeric forms in chemical registration systems, there&rsquo;s <a href="https://doi.org/10.1021/acs.jcim.6b00338" target="_blank">plenty of work</a> still to be done.</p>


<h1 class="relative group">Bonding System 
    <div id="bonding-system" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#bonding-system" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>A <a href="https://doi.org/10.1021/ci00027a001" target="_blank">way forward</a> was proposed in 1997 by Andreas Dietz. Contrary to other work in this area, Dietz didn&rsquo;t exactly propose something new so much as extend the same two-atom bonding concept used in cheminformatics from the beginning.</p>
<p>The proposal considers a bond, not as a labeled edge, but rather a labeled, <em>edge-induced subgraph</em>. A subgraph is a graph that shares some of the nodes and some of the edges of another graph. An edge-induced subgraph contains some of the edges of the original graph, but all of the endpoints. This contrasts with a node-induced subgraph, which contains a subset of nodes, but all of the edges connecting them.</p>
<!-- raw HTML omitted -->
<p>Dietz brought these concepts together with the <em>bonding system</em>. Like a two-atom bond, a bonding system carries metadata. In particular, a bonding system has an attribute representing an electron count.</p>
<p>From this perspective, we can see that a two-atom bond with an electron count attribute is nothing more than a special case of bonding system. In other words, bonding systems can be <em>backward-compatible</em> with two-atom bonds. Unfortunately, Dietz didn&rsquo;t emphasize this point strongly enough.</p>
<p>Backward-compatibility brings substantial practical advantages. The most important of these is phased implementation. A file format or cheminformatics toolkit can start out supporting only two-atom bonding. Later on, it can be extended to support arbitrary multi-atom bonding. The catch is that the starting point must never introduce functionality that will later become incompatible with multi-atom bonding. I recently described a <a href="/articles/2020/04/06/a-minimal-molecule-api/">suitable starting point</a> and will have more to say about retrofitting in later posts.</p>


<h1 class="relative group">Formal Bond Order 
    <div id="formal-bond-order" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#formal-bond-order" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>To make the backward-compatibility of bonding systems more concrete, consider <em>formal bond order</em>. Formal bond order represents the number of electrons shared by each of the terminals of an edge in a molecular graph. A formal bond order of one implies one shared electron per terminal, a formal bond order of two implies two shared electrons, and so on. As noted previously, the bond order of a two-atom bond is simply the electron count divided by two.</p>
<p>Bond order computations over bonding systems follow a similar pattern. As detailed in the next section, however, a given edge can participate in zero, one, or more bonding systems. The account for this freedom, the following relationship for the formal bond order between atoms <del>x</del> and <del>y</del> is used:</p>
<pre tabindex="0"><code class="language-asciimath" data-lang="asciimath">O_{{x,y}} = 1/2sum_(b∈B_{{x,y}})(n(b))/(p(b))
</code></pre><p>where:</p>
<ul>
<li><del>B_{{x,y}}</del> is the set of bonding systems containing the edge <del>{x,y}</del></li>
<li><del>b</del> is a bonding system</li>
<li><del>n(b)</del> is the number of electrons in bonding system <del>b</del></li>
<li><del>p(b)</del> is the number of edges in bonding system <del>b</del></li>
</ul>
<p>Two-atom bonds are merely a special case. Consider ethane. Its only C-C bond can be represented by a one-edge bonding system. Using the equation above, we note that this bonding system has two electrons (<del>n(b) = 2</del>) and one edge (<del>p(b) = 1</del>). The formal bond order of the C-C bonding system in ethane is then given by:</p>
<pre tabindex="0"><code class="language-asciimath" data-lang="asciimath">O_{{1,2}} = 1/2*(n(b))/(p(b))  = 1/2*(2/1) = 1
</code></pre><p>As expected, this is a single bond.</p>
<p>Now consider the allyl radical. It can be considered to have three heavy-atom bonding systems. Two of them are represented as traditional two-electron, one-edge C-C bonds. The third is a three-electron, two-edge bond (<del>n(b) = 3</del>, <del>p(b) = 2</del>). It follows that the formal bond order over either edge in the allyl radical is:</p>
<pre tabindex="0"><code class="language-asciimath" data-lang="asciimath">O_{{1,2}} = 1/2*((2/1) + (3/2)) = 7/4
</code></pre><p>Note that we get the same answer if we model the allyl radical with two extended bonding systems. For example, two electrons could be associated with a two-edge bonding system, and a third electron could be associated with a separate two-edge bonding system:</p>
<pre tabindex="0"><code class="language-asciimath" data-lang="asciimath">O_{{1,2}} = 1/2*((2/1) + (2/2) + (1/2)) = 7/4
</code></pre><p>Either way, a formal bond order (7/4) may seem odd from the perspective of molecular orbital theory, which would predict two-electron occupancy of a bonding MO with single occupancy of a non-bonding orbital. Doesn&rsquo;t the bonding system approach overstate the &ldquo;real&rdquo; bond order?</p>
<!-- raw HTML omitted -->
<p>A similar situation arises with any toolkit that allows species such as dihelium (SMILES; <code>[He]=[He]</code>). Despite a formal bond order of two, dihelium displays a fleeting existence experimentally. MO theory predicts a bond order of zero, which is consistent with experimental evidence.</p>
<!-- raw HTML omitted -->
<p>Formal bond order, regardless of context, should be viewed more as an electron accounting tool rather than a representation of reality. This caveat applies regardless of whether multi-atom bonding is being used.</p>


<h1 class="relative group">Notation 
    <div id="notation" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#notation" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>To prepare for more specific examples, some new notation will be needed. Rather than verbose English-language descriptions, it&rsquo;s more convenient to use a compact shorthand.</p>
<p>Dietz proposes a notation based on a non-empty edge set, raising the question of <em>connectedness</em>. A graph is said to be connected if a route can be traced from any node to any other node through an alternating path of edges and nodes. But an edge set can generate a disconnected subgraph. Must bonding systems be based on connected subgraphs? All of the examples presented by Dietz are connected, but no requirement is stated.</p>
<p>Given that disconnected bonding systems appear to have no application, it&rsquo;s best to disallow them. Our notation system can enforce this rule by replacing the edge set with a representation of a traversal.</p>
<p>Just such a system has been in use for many years now in the form of the <a href="https://www.inchi-trust.org/download/104/InChI_TechMan.pdf" target="_blank">InChI connectivity layer</a>, itself based on SMILES. With this as the starting point, here&rsquo;s a procedure for generating a simple bonding system notation:</p>
<ol>
<li>Assign each atom in the molecular graph an integer index starting with one.</li>
<li>Identify the connected subgraph underlying the bonding system <code>B</code>.</li>
<li>Perform a depth-first traversal over <code>B</code> starting with any of its nodes.</li>
<li>For each node traversed, write its index determined in step (1).</li>
<li>Wrap any branch in parentheses (<code>(</code> and <code>)</code>).</li>
<li>Separate other node-node traversals with a hyphen (<code>-</code>).</li>
<li>When closing a cycle, repeat the node index determined in step (1).</li>
<li>Append the string with a colon (<code>:</code>) followed by the electron count.</li>
<li>Wrap the entire string in curly braces (<code>{</code> and <code>}</code>).</li>
</ol>
<p>Consider again the allyl radical. Starting with a primary carbon, we number the nodes sequentially from 1-3, inclusive. Traversing the bonding system subgraph and assigning an electron count yields:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>{1-2-3:3}
</span></span></code></pre></div><p>As another example, consider benzene. Its π-system can be represented as a bonding system comprised of a six-edge cyclic subgraph and six electrons:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>{1-2-3-4-5-6-1:6}
</span></span></code></pre></div>

<h1 class="relative group">Examples 
    <div id="examples" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#examples" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<!-- raw HTML omitted -->
<p>A few examples of the ways in which bonding systems can be used are depicted above. Example notations follow:</p>
<ol>
<li>ferrocene. <code>{2(1)-3(1)-4(1)-5(1)-6(2)-1-7-8(1)-9(1)-10(1)-11(1)-7:12}</code></li>
<li>π-allyl palladium chloride dimer. <code>{1-2-3(1)-4-1:3}</code></li>
<li>cyclopentadienyl anion. <code>{1-2-3-4-5-1:6}1</code></li>
<li>nitro group. <code>{1(2)-3:3}</code></li>
<li>norbornyl cation. <code>{1-2-3-1:2}</code></li>
<li>acetic acid. <code>{1-2-5-3-1:4}</code></li>
<li>acetylactetone. <code>{2-3-4-6-7-8-2:6}</code></li>
<li>imidazole anion. <code>{1-2-3-4-5-1:6}</code></li>
<li>imidazole alternative. <code>{1-2-3-4-5(1)-6-2:6}</code></li>
</ol>
<p>As these examples illustrate, multi-atom bonding systems are well-suited to eliminating artificial symmetry and preserving electron counts. The role is similar to that played by <a href="/articles/2020/02/10/a-comprehensive-treatment-of-aromaticity-in-the-smiles-language/">aromaticity in SMILES</a>, and mobile hydrogens in InChI. But unlike aromaticity, bonding systems can be used without ambiguity because all electron counts are fully specified. Nor do bonding systems overload an already-controversial term used in chemistry. Finally, bonding systems need not overlap the sigma bonding framework (for example, <strong>1</strong>, <strong>2</strong>, <strong>5</strong>, <strong>6</strong>, <strong>7</strong>, and <strong>9</strong>).</p>
<p>Like any tool, bonding systems can cause harm through misuse. A case in point is structure <strong>9</strong>. Inclusion of the hydrogen atom within an extended bonding system framework eliminates artificial symmetry that would otherwise be induced by two-atom bonding representations. However, this approach can lead to non-intuitive conclusions. Depending on the application, the alternative imidazole anion <strong>8</strong> might be more appropriate. Each option communicates something different. As Dietz observes:</p>
<blockquote>
<p>Note that a molecular structure representation cannot free the user from the task to decide how a chemical structure should be represented. However, a lack of versatility might force the user to represent a chemical structure in a certain manner, even if he actually would prefer to represent it differently.</p>
</blockquote>


<h1 class="relative group">Conclusion 
    <div id="conclusion" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#conclusion" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Multi-atom bonding appears in many areas of chemistry. The entrenched cheminformatics convention of two-atom bonding is inadequate when faced with chemistry&rsquo;s full repertoire. Multi-atom bonding offers a solution that can be implemented in a backward-compatible way.</p>

          
          
          
        </div>
        
        

        
        

          
      </div>
     
      
      
        
        
          
          
        
      <script>
        var oid = "views_posts\/2020-04-27-multi-atom-bonding-in-cheminformatics.md"
        var oid_likes = "likes_posts\/2020-04-27-multi-atom-bonding-in-cheminformatics.md"
      </script>
      
      
      <script type="text/javascript" src="/js/page.min.0860cf4e04fa2d72cc33ddba263083464d48f67de06114529043cb4623319efed4f484fd7f1730df5abea0e2da6f3538855634081d02f2d6e920b956f063e823.js" integrity="sha512-CGDPTgT6LXLMM926JjCDRk1I9n3gYRRSkEPLRiMxnv7U9IT9fxcw31q&#43;oOLabzU4hVY0CB0C8tbpILlW8GPoIw=="></script>
      
  
    </section>
  <footer class="pt-8 max-w-prose print:hidden">

    
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group mr-3" href="/articles/2020/04/20/smiles-formal-grammar/">
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >SMILES Formal Grammar</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2020-04-20T18:00:00&#43;00:00">April 20, 2020</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="flex text-right group ml-3" href="/articles/2020/05/04/stereochemistry-and-atom-parity-in-smiles/">
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Stereochemistry and Atom Parity in SMILES</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2020-05-04T16:00:00&#43;00:00">May 4, 2020</time>
                  
                </span>
              </span>
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


    
  </footer>
</article>

      <div id="top-scroller" class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0">
  <a href="#the-top"
    class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top" title="Scroll to top">
    &uarr;
  </a>
</div>
    </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
  
  <div class="flex items-center justify-between">

    
    
    <p class="text-sm text-neutral-500 dark:text-neutral-400">
      &copy;
      2024
      
    </p>
    

    
    
    <p class="text-xs text-neutral-500 dark:text-neutral-400">
      
      
      Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a>
    </p>
    

  </div>
  <script>
    
    mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
      margin: 24,
      background: 'rgba(0,0,0,0.5)',
      scrollOffset: 0,
    })
    
  </script>
  
  
  <script type="text/javascript" src="/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js" integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]"
  data-url="http://localhost:1313/"
  style="z-index:500"
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)"
      >
        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

  </div>
</body>

</html>
