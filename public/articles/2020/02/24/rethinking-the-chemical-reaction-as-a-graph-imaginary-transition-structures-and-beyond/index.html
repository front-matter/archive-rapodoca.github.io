<!DOCTYPE html>
<html lang="en-us" dir="ltr" class="scroll-smooth" data-default-appearance="light"
  data-auto-appearance="true"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  
  <meta http-equiv="content-language" content="en-us" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>Rethinking the Chemical Reaction as a Graph: Imaginary Transition Structures and Beyond &middot; Depth-First</title>
  <meta name="title" content="Rethinking the Chemical Reaction as a Graph: Imaginary Transition Structures and Beyond &middot; Depth-First" />
  
  <meta name="description" content="Bridging the divide between reactions and molecules in cheminformatics." />
  
  
  
  <link rel="canonical" href="http://localhost:1313/articles/2020/02/24/rethinking-the-chemical-reaction-as-a-graph-imaginary-transition-structures-and-beyond/" />
  
  
  
  
  
  
  
  
  
  
  <link type="text/css" rel="stylesheet" href="/css/main.bundle.min.e27868ab1485f7ed7b06b122b4980bd38b19526eb8f7de885181204d28f04a0c47e9c334eff19a06c0278eb2ff8415b983a5d0fb80fd6b5680c926457cc61c57.css"
    integrity="sha512-4nhoqxSF9&#43;17BrEitJgL04sZUm64996IUYEgTSjwSgxH6cM07/GaBsAnjrL/hBW5g6XQ&#43;4D9a1aAySZFfMYcVw==" />
  
  
  <script type="text/javascript" src="/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js"
    integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj&#43;e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script>
  
  
  
  
  
  
  
  
  
  
  
  <script defer type="text/javascript" id="script-bundle" src="/js/main.bundle.min.c178288131a2f1ad46910438db47ac5f7e1c48cf949e49f6dc3310c8ec9660e23fe505805eba4e2e73711335808500360d773a2b64322feb35df52856edca286.js"
    integrity="sha512-wXgogTGi8a1GkQQ420esX34cSM&#43;Unkn23DMQyOyWYOI/5QWAXrpOLnNxEzWAhQA2DXc6K2QyL&#43;s131KFbtyihg==" data-copy="" data-copied=""></script>
  
  
  
  <script src="/lib/zoom/zoom.min.37d2094687372da3f7343a221a470f6b8806f7891aa46a5a03966af7f0ebd38b9fe536cb154e6ad28f006d184b294525a7c4054b6bbb4be62d8b453b42db99bd.js" integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S&#43;Yti0U7QtuZvQ=="></script>
  
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="manifest" href="/site.webmanifest" />
  
  
  
  
  
  
  
  
  <meta property="og:url" content="http://localhost:1313/articles/2020/02/24/rethinking-the-chemical-reaction-as-a-graph-imaginary-transition-structures-and-beyond/">
  <meta property="og:site_name" content="Depth-First">
  <meta property="og:title" content="Rethinking the Chemical Reaction as a Graph: Imaginary Transition Structures and Beyond">
  <meta property="og:description" content="Bridging the divide between reactions and molecules in cheminformatics.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2020-02-24T14:00:00+00:00">
    <meta property="article:modified_time" content="2020-02-24T14:00:00+00:00">

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Rethinking the Chemical Reaction as a Graph: Imaginary Transition Structures and Beyond">
  <meta name="twitter:description" content="Bridging the divide between reactions and molecules in cheminformatics.">

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "Rethinking the Chemical Reaction as a Graph: Imaginary Transition Structures and Beyond",
    "headline": "Rethinking the Chemical Reaction as a Graph: Imaginary Transition Structures and Beyond",
    
    "abstract": "Bridging the divide between reactions and molecules in cheminformatics.",
    "inLanguage": "en-us",
    "url" : "http:\/\/localhost:1313\/articles\/2020\/02\/24\/rethinking-the-chemical-reaction-as-a-graph-imaginary-transition-structures-and-beyond\/",
    "author" : {
      "@type": "Person",
      "name": ""
    },
    "copyrightYear": "2020",
    "dateCreated": "2020-02-24T14:00:00\u002b00:00",
    "datePublished": "2020-02-24T14:00:00\u002b00:00",
    
    "dateModified": "2020-02-24T14:00:00\u002b00:00",
    
    
    
    "mainEntityOfPage": "true",
    "wordCount": "2105"
  }]
  </script>


  
  
  
  
  

<script src="/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js" integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj&#43;KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script>






















  
  



  
  
  <meta name="theme-color"/>
  
  
</head>
<body
  class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
  <div id="the-top" class="absolute flex self-center">
    <a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
      href="#main-content"><span
        class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a>
  </div>
  
  
  <div style="padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px"
    class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3">
    
    <div class="flex flex-1 items-center justify-between">
        <nav class="flex space-x-3">

            
            <a href="/" class="text-base font-medium text-gray-500 hover:text-gray-900">Depth-First</a>
            

        </nav>
        <nav class="hidden md:flex items-center space-x-5 md:ml-12 h-12">

            

            


            
            <button id="search-button" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            


            
            
            <div
                class="ltr:mr-14 rtl:ml-14 flex items-center">
                <button id="appearance-switcher" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400">
                    <div class="flex items-center justify-center dark:hidden">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                    </div>
                    <div class="items-center justify-center hidden dark:flex">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                    </div>
                </button>
            </div>
            

        </nav>
        <div class="flex md:hidden items-center space-x-5 md:ml-12 h-12">

            <span></span>

            


            
            <button id="search-button-mobile" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            

            
            
            <button id="appearance-switcher-mobile" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400" style="margin-right:5px">
                <div class="flex items-center justify-center dark:hidden">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                </div>
                <div class="items-center justify-center hidden dark:flex">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                </div>
            </button>
            

        </div>
    </div>
    <div class="-my-2 -mr-2 md:hidden">

        <label id="menu-button" class="block">
            

            </div>
        </label>
    </div>
</div>





  
  <div class="relative flex flex-col grow">
    <main id="main-content" class="grow">
      


<article>
  

  <header id="single_header" class="mt-5 max-w-prose">
    
    <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
      Rethinking the Chemical Reaction as a Graph: Imaginary Transition Structures and Beyond
    </h1>
    <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
      





  
  







  





  



  













<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2020-02-24T14:00:00&#43;00:00">February 24, 2020</time><span class="px-2 text-primary-500">&middot;</span><span>2105 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">10 mins</span>
  

  
  
</div>








    </div>

    
    
    
    
    

    

    
      
      
        
        
<div class="flex author">
  
  <div class="place-self-center">
    
    
    <div class="text-2xl sm:text-lg">
</div>
  </div>
</div>

      

      

      
      <div class="mb-5"></div>
      

    

  </header>
  
  <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
    
    

      <div class="min-w-0 min-h-0 max-w-fit">
        
        


        <div class="article-content max-w-prose mb-20">
          <p>Cheminformatics concerns itself with two entities: molecules and reactions. A molecule embodies chemistry&rsquo;s static nature, whereas a reaction embodies the dynamic. Although there are important problems to solve on both sides, cheminformatics tends to focus on molecular tools over reaction tools. One reason is complexity. Reaction tools require solutions to all of the problem required by molecule tools, and then some.</p>
<p>Then there&rsquo;s graph theory. For 150 years, theoretical chemistry and later cheminformatics have reaped the benefits of close ties with this branch of mathematics. An obvious relationship between the two fields presents itself: in a molecule, atoms map to nodes and bonds map to edges. Algorithms and proofs from graph theory are applied to molecular problems. Likewise, molecular problems inspire graph theory. The crossover continues to this day. Reactions, on the other hand, don&rsquo;t align in such an obvious way. Although reaction networks, where nodes map to molecules and edges map to transformations can be built, this approach presents several challenges.</p>
<p>What if reactions could be formulated more like molecules? That was the premise of a series of papers from the 1980s.</p>


<h1 class="relative group">Arrow Notation 
    <div id="arrow-notation" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#arrow-notation" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Arrow notation depicts a chemical reaction with the head pointing away from starting materials and toward products. This convention, which <a href="https://doi.org/10.1080/00033795900200088" target="_blank">dates back to at least 1757</a>, is still used today. In modern notation, catalysts and excess reagents often appear above the arrow, with time, temperature, and solvent below.</p>
<!-- raw HTML omitted -->
<p>Cheminformatics tools have for the most part adopted arrow notation. For example, <a href="https://www.daylight.com/meetings/summerschool01/course/basics/smirks.html" target="_blank">Daylight documentation</a> explains how to use the greater than (<code>&gt;</code>) symbol as a reaction arrow. Other examples can also be found, including the <a href="https://www.3dsbiovia.com/products/collaborative-science/biovia-draw/ctfile-no-fee.html" target="_blank">MDL RXNFile format</a>.</p>


<h1 class="relative group">The Problem with Arrow Notation 
    <div id="the-problem-with-arrow-notation" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#the-problem-with-arrow-notation" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Easily understandable and ubiquitous though it may be, arrow notation drags some baggage into the cheminformatics arena. Problems include:</p>
<ul>
<li>Repetition. Non-participating atoms and bonds are duplicated on both sides of the arrow.</li>
<li>Hypergraph. A single reaction maps potentially many reactants to many products. If molecules are nodes in a reaction graph, then a reaction arrow maps to a <a href="https://en.wikipedia.org/wiki/Hypergraph" target="_blank">hypergraph edge</a>. Graph manipulation procedures often explicitly disallow such graphs.</li>
<li>Atom mapping. We usually want to correlate an atom or bond in the starting material with one appearing in a product. Arrow notation requires a secondary mapping system.</li>
<li>The above complexities make it difficult to re-use standard graph-based computational methods such as cycle perception, traversal, and isomorphism detection.</li>
</ul>
<p>The result is two disconnected cheminformatics software stacks: one dealing with molecules and the other dealing with reactions. The division can be seen from the bottom software layer (the cheminformatics toolkit) all the way to the user interface (structure vs. reaction editors). Attractive though it may be in the beginning, arrow notation unnecessarily fragments the code base.</p>


<h1 class="relative group">Imaginary Transition Structures (ITS) 
    <div id="imaginary-transition-structures-its" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#imaginary-transition-structures-its" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>In 1986, <a href="https://doi.org/10.22052/ijmc.2016.13882" target="_blank">Shinsaku Fujita</a> proposed an alternative to arrow notation. His approach, <a href="https://doi.org/10.1021/ci00052a009" target="_blank">Imaginary Transition Structures</a> (ITS), viewed reactions as &ldquo;an extended kind of chemical structure.&rdquo; This system encodes reactants, products, and atom mappings within a single, undirected, connected graph.</p>
<!-- raw HTML omitted -->
<p>Consider the acid-catalyzed hydrolysis of ethyl acetate. Here, two reacting species (ethyl acetate and water) produce two products (ethanol and acetic acid). Hydrogen chloride, serving as a catalyst, appears on both sides. The arrow notation for this reaction is:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>CH3CO2CH2CH3 + H2O + HCl → CH3CO2H + CH3CH2OH + HCl
</span></span></code></pre></div><p>An ITS for this reaction could be encoded as follows. First, create a starting graph <em>S</em> as the sum of all reactant molecular graphs. Next, create a products graph <em>P</em> as the sum of all product molecular graphs. Finally, sum these two graphs to create a third graph, which will contain all nodes and edges in the reaction. Label each edge according to whether the reaction creates, breaks, or leaves unchanged the corresponding bond. The resulting graph is an ITS.</p>
<!-- raw HTML omitted -->
<p>Catalysts can optionally be omitted. If they are, the result is an <em>abbreviated ITS</em>. The abbreviated ITS for ethyl acetate hydrolysis can be represented as:</p>
<!-- raw HTML omitted -->
<p>The edges in an ITS graph (&ldquo;ITS bonds&rdquo;) are classified according to their role in the corresponding reaction:</p>
<ul>
<li>an <em>in-bond</em> is formed by the reaction;</li>
<li>an <em>out-bond</em> is broken by the reaction; and</li>
<li>a <em>par-bond</em> is preserved by the reaction.</li>
</ul>
<p>Within a data model, ITS bonds are labeled with an ordered pair of integers (<em>a</em>, <em>b</em>). The first member <em>a</em> denotes the bond order at the start of the reaction. The second member <em>b</em> denotes the change in bond order caused by the reaction. For example:</p>
<ul>
<li>a single par bond (unchanged by the reaction) would be labeled as (1, 0);</li>
<li>a single in-bond (formed by the reaction) would be labeled as (0, +1);</li>
<li>a single out-bond (broken by the reaction) would be labeled as (1, -1).</li>
<li>a double bond reduced during a reaction would be labeled as (2, -1).</li>
</ul>
<p>And so on. Summing <em>a</em> and <em>b</em> yields the bond order in the product. Given a molecular graph with three possible bond orders (1, 2, and 3), the possible ITS graph edge labels, and the proposed visual representation, are:</p>
<!-- raw HTML omitted -->
<p>As originally formulated, ITS does not capture formal charges consumed or produced during a reaction. For example, the reaction of trimethylamine and methyl iodide has the following arrow notation:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>(CH3)3N + CH3I -&gt; (CH4)N+I-
</span></span></code></pre></div><p>The formal charges produced by the reaction will not be captured by an ITS. The same applies to stereochemistry. A <a href="https://doi.org/10.1021/ci00055a004" target="_blank">follow-up paper</a> offers comprehensive solutions to both problems. A simpler approach, in which ionic bonds are modeled as edges in the ITS graph is <a href="https://doi.org/10.1021/ci00052a011" target="_blank">also described</a>.</p>
<p>ITS transforms the problem of reaction manipulation into one of graph manipulation. As such, we get a number of useful features essentially for free.</p>


<h1 class="relative group">Regenerating Reactants and Products 
    <div id="regenerating-reactants-and-products" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#regenerating-reactants-and-products" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>An edged-labeled ITS can be used to regenerate either the set of reactants or the set of products through graph manipulation. Fujita describes two processes:</p>
<ol>
<li><strong>Projection to starting stage (PS).</strong> Extract all nodes in the ITS graph as atoms. For each edge label (<em>a</em>, <em>b</em>) in the ITS graph, add a bond of order <em>a</em>. The result is a molecular graph in which each connected component is an input to the reaction.</li>
<li><strong>Projection to product stage (PP).</strong> Extract all nodes in the ITS graph as atoms. For each edge label (<em>a</em>, <em>b</em>) in the ITS graph, add a bond of order <em>a</em> + <em>b</em>. The result is a molecular graph in which each connected component is an output from the reaction.</li>
</ol>
<!-- raw HTML omitted -->


<h1 class="relative group">Graph of Reaction Centers 
    <div id="graph-of-reaction-centers" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#graph-of-reaction-centers" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>As sophomore organic chemistry students are taught, molecules can be classified by the functional groups they contain. Viewed from the perspective of graph theory, a functional group represents a subgraph over one or more molecular graphs. Functional groups in turn provide a wealth of insight into reactivity and other physical properties of the molecules containing them. Learning how one functional group behaves lets you say a lot about an unknown molecule in which it appears.</p>
<p>We can likewise glean valuable information by looking at ITS subgraphs. An important example is the <em>reaction center graph</em> (RC graph). An RC graph is a subgraph of an ITS containing only dynamic nodes and edges. An edge is dynamic if it: (1) represents an in-bond; (2) represents an out-bond; or (3) lies between two dynamic nodes. A dynamic node is incident to at least one dynamic edge.</p>
<p>As an example, the RC graph of ethyl acetate hydrolysis catalyzed by hydrogen chloride can be drawn as follows:</p>
<!-- raw HTML omitted -->
<p>We can think of an RC graph as the reaction analog of the functional group. Like molecules sharing a common functional group, ITS graphs sharing a common RC graph are likely to behave similarly and share similar characteristics.</p>
<p>Graph theory provides powerful tools for further analysis of RC graphs. Consider how the edges of an RC graph alternate between in- and out-bonds. The RC graph of ethyl acetate hydrolysis drawn above consist of a single cycle in which edges alternative between being formed (in-bonds) and broken (out-bonds).</p>
<p>Fujita refers to an alternating sequence of in- and out-bonds in an RC graph as a <em>string</em>. He goes on to classify reactions according to the number of strings they contain (&ldquo;stringity&rdquo;). A string will always occur over a cycle, however an abbreviated ITS can produce acyclic strings. A reaction containing multiple strings can sometimes be thought of as occurring over multiple steps. For example, condensation reactions such as ketalization, esterification, or imine formation produce bicyclic RC graphs in which two strings can be traced.</p>
<p>Although not mentioned in his original work, what Fujita is describing can also be cast in terms of the graph theoretical problem of <a href="/articles/2019/04/02/the-maximum-matching-problem/"><em>perfect matching</em></a>. A matching is a subgraph in which every node has degree one. Matchings can be classified as maximal, maximum, or perfect depending on coverage. A perfect matching contains all the nodes of its supergraph.</p>
<!-- raw HTML omitted -->
<p>It turns out that every valid RC graph, whether cyclic or acyclic, has a perfect matching over in- and out-bonds. Organic chemists would recognize the striking similarity to &ldquo;pushing electrons&rdquo; in an aromatic system or within a reaction mechanism.</p>
<p>The requirement for a perfect matching over the dynamic bonds of an RC graph can be applied in several ways. For example, we can use it to validate arbitrary reactions. Alternatively, we can use it to invent new reactions.</p>


<h1 class="relative group">Rethinking the Chemical Reaction as Graph 
    <div id="rethinking-the-chemical-reaction-as-graph" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#rethinking-the-chemical-reaction-as-graph" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>The graph-based model of reactions afforded by ITS offers several opportunities not available through arrow notation. Some of them include:</p>
<ul>
<li><strong>Classification.</strong> An ITS can be classified by graph invariants including cycle count, <a href="https://en.wikipedia.org/wiki/Cyclomatic_complexity" target="_blank">cyclomatic
complexity</a>, edge count, and node count.</li>
<li><strong>Validation.</strong> A valid ITS must contain a perfect matching over dynamic edges.</li>
<li><strong>Invention.</strong> Which valid RC graphs have never been reported as reactions in the literature? What do they have in common?</li>
<li><strong>Storage/Retrieval/Indexing</strong>. Molecular fingerprints have been used for decades to index molecules and define similarity relationships. All of the same analysis work with ITS graphs.</li>
<li><strong>Editing.</strong> Molecules <em>and</em> reactions can be edited using the same compact tool.</li>
<li><strong>Depiction</strong>. The redundancy of arrow notation results large depictions in which atom/bond mapping isn&rsquo;t always obvious. ITS depictions approach the compactness of chemical structures while explicitly and accurately representing reactant/product mapping.</li>
</ul>


<h1 class="relative group">Machine Learning 
    <div id="machine-learning" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#machine-learning" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>An intriguing recent development in the use of ITS-style reaction graphs comes by way of machine learning. A group led by Varnek <a href="https://chemrxiv.org/articles/Discovery_of_Novel_Chemical_Reactions_by_Deep_Generative_Recurrent_Neural_Network/11635929/1" target="_blank">recently described</a> the discovery of novel reactions using a representation similar to Fujita&rsquo;s ITS. Varnek&rsquo;s publications refer to the ITS concept as a <em>Condensed Graph of Reaction</em> (CGR).</p>
<p>The technique, called &ldquo;SMILES/CGR&rdquo; extends SMILES so as to capture dynamic bonds. In-bonds and out-bonds are represented using a new bond notation wrapped in brackets. For example, a single bond broken in a reaction would be represented as <code>[-&gt;.]</code>. A single bond formed by a reaction would be represented as <code>[.&gt;-]</code>. A double bond reduced to a single bond in a reaction would be represented as <code>[=&gt;-]</code>, and so on.</p>
<!-- raw HTML omitted -->
<p>Combining this notation with the now common approach of <a href="/articles/2019/03/19/chemical-line-notations-for-deep-learning-deepsmiles-and-beyond/">SMILES-based autoencoders</a> lead to several reactions not present in the training set.</p>
<p>The Varnek group has produced a substantial body of work applying reaction graphs to a diverse array of problems:</p>
<ul>
<li><a href="https://doi.org/10.1142/S0218213011000140" target="_blank">A Representation to Apply Usual Data Mining Techniques to Chemical Reactions — Illustration on the Rate Constant of SN2 Reactions in Water</a> Modeling rates of reaction.</li>
<li><a href="https://doi.org/10.1007/s10822-018-0101-6" target="_blank">Assessment of tautomer distribution using the condensed reaction graph approach</a> Modeling tautomer distributions as reaction graphs.</li>
<li><a href="https://doi.org/10.1021/acs.jcim.6b00319" target="_blank">Automatized Assessment of Protective Group Reactivity: A Step Toward Big Reaction Data Analysis</a> Protecting group removal recommendations via reaction graphs.</li>
<li><a href="https://doi.org/10.1021/ci500698a" target="_blank">Expert System for Predicting Reaction Conditions: The Michael Reaction Case</a> Predicting reaction feasibility. No difference between reagent-based descriptors and reaction-based descriptors.</li>
<li><a href="https://doi.org/10.1021/ci300149n" target="_blank">Mining Chemical Reactions Using Neighborhood Behavior and Condensed Graphs of Reactions Approaches</a> Similarity-based virtual screening.</li>
<li><a href="https://doi.org/10.1021/ci300418q" target="_blank">Models for Identification of Erroneous Atom-to-Atom Mapping of Reactions Performed by Automated Algorithms</a>. Validation of mappings made by other tools.</li>
<li><a href="https://doi.org/10.1021/acs.jcim.6b00359" target="_blank">Prediction of Activity Cliffs Using Condensed Graphs of Reaction Representations, Descriptor Recombination, Support Vector Machine Classification, and Support Vector Regression</a> A pair of molecules can be modeled as a transformation and so condensed graph can be used.</li>
</ul>
<p>At least two software packages created by Varnek group associates have been released as open source. <a href="https://github.com/cimm-kzn/CGRtools" target="_blank">CGRTools</a> is a toolkit for working with reaction graphs. <a href="https://github.com/stsouko/CGRdb/blob/master/doc/tutorial/main.ipynb" target="_blank">CGRdb</a> is a reaction database organized around reaction graphs.</p>


<h1 class="relative group">Conclusion 
    <div id="conclusion" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#conclusion" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Imaginary Transition Structures, and more broadly reaction graphs, offer a powerful abstraction for working with reactions. By encoding starting materials, products, and atom/bond mappings in a single graph, reaction analyses can take advantage of the same techniques developed for molecular graphs over the last 50 years. The appearance of the first study combining machine learning autoencoders with reaction graphs may foreshadow a renaissance in reaction cheminformatics, with reaction graphs leading the way.</p>

          
          
          
        </div>
        
        

        
        

          
      </div>
     
      
      
        
        
          
          
        
      <script>
        var oid = "views_posts\/2020-02-24-rethinking-the-chemical-reaction-as-a-graph-imaginary-transition-structures-and-beyond.md"
        var oid_likes = "likes_posts\/2020-02-24-rethinking-the-chemical-reaction-as-a-graph-imaginary-transition-structures-and-beyond.md"
      </script>
      
      
      <script type="text/javascript" src="/js/page.min.0860cf4e04fa2d72cc33ddba263083464d48f67de06114529043cb4623319efed4f484fd7f1730df5abea0e2da6f3538855634081d02f2d6e920b956f063e823.js" integrity="sha512-CGDPTgT6LXLMM926JjCDRk1I9n3gYRRSkEPLRiMxnv7U9IT9fxcw31q&#43;oOLabzU4hVY0CB0C8tbpILlW8GPoIw=="></script>
      
  
    </section>
  <footer class="pt-8 max-w-prose print:hidden">

    
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group mr-3" href="/articles/2020/02/17/graphs-in-rust-introducing-gamma/">
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Graphs in Rust: Introducing Gamma</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2020-02-17T14:00:00&#43;00:00">February 17, 2020</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="flex text-right group ml-3" href="/articles/2020/03/02/compiling-inchi-to-webassembly-part-2-from-molfile-to-inchi/">
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Compiling InChI to WebAssembly Part 2: From Molfile to InChI</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2020-03-02T14:00:00&#43;00:00">March 2, 2020</time>
                  
                </span>
              </span>
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


    
  </footer>
</article>

      <div id="top-scroller" class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0">
  <a href="#the-top"
    class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top" title="Scroll to top">
    &uarr;
  </a>
</div>
    </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
  
  <div class="flex items-center justify-between">

    
    
    <p class="text-sm text-neutral-500 dark:text-neutral-400">
      &copy;
      2024
      
    </p>
    

    
    
    <p class="text-xs text-neutral-500 dark:text-neutral-400">
      
      
      Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a>
    </p>
    

  </div>
  <script>
    
    mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
      margin: 24,
      background: 'rgba(0,0,0,0.5)',
      scrollOffset: 0,
    })
    
  </script>
  
  
  <script type="text/javascript" src="/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js" integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]"
  data-url="http://localhost:1313/"
  style="z-index:500"
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)"
      >
        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

  </div>
</body>

</html>
