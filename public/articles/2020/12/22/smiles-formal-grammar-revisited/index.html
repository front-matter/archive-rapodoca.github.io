<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>SMILES Formal Grammar Revisited | Depth-First</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="Encapsulating the full OpenSMILES syntax using a set of streamlined production rules.">
    <meta name="generator" content="Hugo 0.139.4">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    
      <meta name="author" content = "Richard L. Apodaca">
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    

    
      

    

    

    
      <link rel="canonical" href="http://localhost:1313/articles/2020/12/22/smiles-formal-grammar-revisited/">
    

    <meta property="og:url" content="http://localhost:1313/articles/2020/12/22/smiles-formal-grammar-revisited/">
  <meta property="og:site_name" content="Depth-First">
  <meta property="og:title" content="SMILES Formal Grammar Revisited">
  <meta property="og:description" content="Encapsulating the full OpenSMILES syntax using a set of streamlined production rules.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2020-12-22T18:00:00+00:00">
    <meta property="article:modified_time" content="2020-12-22T18:00:00+00:00">

  <meta itemprop="name" content="SMILES Formal Grammar Revisited">
  <meta itemprop="description" content="Encapsulating the full OpenSMILES syntax using a set of streamlined production rules.">
  <meta itemprop="datePublished" content="2020-12-22T18:00:00+00:00">
  <meta itemprop="dateModified" content="2020-12-22T18:00:00+00:00">
  <meta itemprop="wordCount" content="1412">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="SMILES Formal Grammar Revisited">
  <meta name="twitter:description" content="Encapsulating the full OpenSMILES syntax using a set of streamlined production rules.">

	
  </head><body class="ma0 avenir bg-near-white development">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Depth-First
      
    </a>
    <div class="flex-l items-center">
      

      
      <div class="ananke-socials"></div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Posts
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1">SMILES Formal Grammar Revisited</h1>
      
      <p class="tracked">
        By <strong>Richard L. Apodaca</strong>
      </p>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2020-12-22T18:00:00Z">December 22, 2020</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>A <a href="/articles/2020/04/20/smiles-formal-grammar/">previous article</a> presented a formal grammar for the SMILES language. Its most notable feature was the lack of left-recursion, which enables simple, efficient parsers to be written. However, that first attempt left some room for improvement. In this article, a new grammar is presented that addresses outstanding points.</p>
<h1 id="limitations-of-previous-grammar">Limitations of Previous Grammar</h1>
<p>Limitations of the previous grammar included:</p>
<ol>
<li>Multiple unbounded quantifiers. Three production rules (<code>&lt;line&gt;</code>, <code>&lt;chain&gt;</code>, and <code>&lt;branch&gt;</code>) require loops, which complicates parser development, testing, and debugging.</li>
<li>Complex logic in the <code>&lt;chain&gt;</code> production, which complicated parser development.</li>
<li>No star symbol (<code>*</code>), a key feature of SMILES.</li>
<li>Non-tetrahedral stereo templates (e.g., <code>OH1</code>) were not supported.</li>
<li>Only three-digit atom classes were supported, which may limit certain applications.</li>
</ol>
<p>The new grammar addresses all of these points.</p>
<p>Powerful though grammars may be, there are many things they <em>can not</em> do. A grammar merely describes syntax. Semantics are out of scope. Examples of SMILES language features that can not be addressed by a formal grammar include:</p>
<ul>
<li>valance analysis</li>
<li>double bond conformation analysis</li>
<li>isotope validation</li>
<li>kekulization and kekulizability determination</li>
<li>ring closure balancing</li>
</ul>
<h1 id="using-a-formal-grammar">Using a Formal Grammar</h1>
<p>The SMILES grammar described here belongs to a class designated as <em><a href="https://en.wikipedia.org/wiki/LL_parser">LL(1)</a></em>. LL(1) grammars are desirable because they can be parsed from left to right with only one character of lookahead. This enables a technique I call <a href="/articles/2019/01/22/scanner-driven-parser-development/">Scanner-Driven Parser Development</a>. The idea is to wrap a string with an object of type <code>Scanner</code>. Doing so allows character-by-character processing to occur through just three simple operations. With a <code>Scanner</code> in hand, the grammar&rsquo;s production rules can be transformed into functions that call themselves or each other. The result is a recursive descent parser.</p>
<p>Aside from serving as a parser blueprint, a formal grammar can be used to make and test claims about specific SMILES strings. For example, SMILES does not support a dot character (<code>.</code>) preceding a ring closure number. This excludes strings such as <code>C.1CC1</code>. A grammar should make low-level syntax rules like this clear. As such, a well-crafted formal grammar can play a pivotal role in language standardization.</p>
<h1 id="a-toy-grammar">A Toy Grammar</h1>
<p>Having outlined the main goals, an improved SMILES grammar can now be developed. As before, we start with a toy grammar illustrating the overall structure of SMILES syntax:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bnf" data-lang="bnf"><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">smiles</span>&gt;   <span style="color:#f92672">::=</span> &lt;<span style="color:#a6e22e">atom</span>&gt; &lt;<span style="color:#a6e22e">body</span>&gt;*
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">body</span>&gt;     <span style="color:#f92672">::=</span> &lt;<span style="color:#a6e22e">branch</span>&gt; | &lt;<span style="color:#a6e22e">split</span>&gt; | &lt;<span style="color:#a6e22e">union</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">branch</span>&gt;   <span style="color:#f92672">::=</span> &#34;(&#34; ( &lt;<span style="color:#a6e22e">dot</span>&gt; | &lt;<span style="color:#a6e22e">bond</span>&gt; )? &lt;<span style="color:#a6e22e">smiles</span>&gt; &#34;)&#34;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">split</span>&gt;    <span style="color:#f92672">::=</span> &lt;<span style="color:#a6e22e">dot</span>&gt; &lt;<span style="color:#a6e22e">smiles</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">union</span>&gt;    <span style="color:#f92672">::=</span> &lt;<span style="color:#a6e22e">bond</span>&gt;? ( &lt;<span style="color:#a6e22e">smiles</span>&gt; | &lt;<span style="color:#a6e22e">rnum</span>&gt; )
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">dot</span>&gt;      <span style="color:#f92672">::=</span> &#34;.&#34;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">bond</span>&gt;     <span style="color:#f92672">::=</span> &#34;-&#34;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">atom</span>&gt;     <span style="color:#f92672">::=</span> &#34;*&#34;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">rnum</span>&gt;     <span style="color:#f92672">::=</span> &#34;1&#34;
</span></span></code></pre></div><p>This grammar can be tested using the <a href="https://mdkrajnak.github.io/ebnftest/">EBNF Evaluator</a>. Copy the above EBNF grammar into the text area labeled &ldquo;EBNF Grammar.&rdquo; Then test different text inputs for validity.</p>
<p>Three points about this grammar are worth noting:</p>
<ol>
<li>Only one unbounded quantifier is present, <code>&lt;body&gt;*</code>. A parser based on the grammar will therefore require only one explicit loop.</li>
<li>Production rules lack complex logic.</li>
<li>Production rules have more descriptive names.</li>
</ol>
<h1 id="full-stereochemical-parities">Full Stereochemical Parities</h1>
<p>The previous grammar supported only two stereochemical parities: clockwise (<code>@@</code>) and counterclockwise(<code>@</code>). But as the <a href="http://opensmiles.org/opensmiles.html">OpenSMILES specification documents</a>, SMILES supports more sophisticated stereochemical templates, including square planar (<code>SP</code>), trigonal bipyramidal (<code>TB</code>), and octahedral (<code>OH</code>).</p>
<p>The full range of stereochemical parities can be represented with the following production rules:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bnf" data-lang="bnf"><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">parity</span>&gt;        <span style="color:#f92672">::=</span> &#34;@&#34; ( &#34;@&#34; | &lt;<span style="color:#a6e22e">parity_suffix</span>&gt; )?
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">parity_suffix</span>&gt; <span style="color:#f92672">::=</span> &lt;<span style="color:#a6e22e">parity_th</span>&gt; | &lt;<span style="color:#a6e22e">parity_al</span>&gt; | &lt;<span style="color:#a6e22e">parity_sp</span>&gt; | &lt;<span style="color:#a6e22e">parity_tb</span>&gt; | &lt;<span style="color:#a6e22e">parity_oh</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">parity_th</span>&gt;     <span style="color:#f92672">::=</span> &#34;TH&#34; (&#34;1&#34; | &#34;2&#34; )
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">parity_al</span>&gt;     <span style="color:#f92672">::=</span> &#34;AL&#34; (&#34;1&#34; | &#34;2&#34; )
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">parity_sp</span>&gt;     <span style="color:#f92672">::=</span> &#34;SP&#34; ( &#34;1&#34; | &#34;2&#34; | &#34;3&#34; )
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">parity_tb</span>&gt;     <span style="color:#f92672">::=</span> &#34;TB&#34; &lt;<span style="color:#a6e22e">twenty</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">parity_oh</span>&gt;     <span style="color:#f92672">::=</span> &#34;OH&#34; &lt;<span style="color:#a6e22e">thirty</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">twenty</span>&gt;        <span style="color:#f92672">::=</span> ( &#34;1&#34; &lt;<span style="color:#a6e22e">digit</span>&gt;? )
</span></span><span style="display:flex;"><span>                  | ( &#34;2&#34; &#34;0&#34;? )
</span></span><span style="display:flex;"><span>                  | ( &#34;3&#34; | &#34;4&#34; | &#34;5&#34; | &#34;6&#34; | &#34;7&#34; | &#34;8&#34; | &#34;9&#34; )
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">thirty</span>&gt;        <span style="color:#f92672">::=</span> ( &#34;1&#34; &lt;<span style="color:#a6e22e">digit</span>&gt;? )
</span></span><span style="display:flex;"><span>                  | ( &#34;2&#34; &lt;<span style="color:#a6e22e">digit</span>&gt;? )
</span></span><span style="display:flex;"><span>                  | ( &#34;3&#34; &#34;0&#34;? )
</span></span><span style="display:flex;"><span>                  | ( &#34;4&#34; | &#34;5&#34; | &#34;6&#34; | &#34;7&#34; | &#34;8&#34; | &#34;9&#34; )
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">digit</span>&gt;         <span style="color:#f92672">::=</span> &#34;0&#34; | &#34;1&#34; | &#34;2&#34; | &#34;3&#34; | &#34;4&#34; | &#34;5&#34; | &#34;6&#34; | &#34;7&#34; | &#34;8&#34; | &#34;9&#34;
</span></span></code></pre></div><p>That&rsquo;s a lot of effort for some rarely-used stereo parities. But to build a parser capable of reading the entire OpenSMILES syntax, these production rules are all required.</p>
<h1 id="full-grammar">Full Grammar</h1>
<p>The toy grammar uses pared-down atom and bond definitions. Let&rsquo;s remedy that by putting everything together:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bnf" data-lang="bnf"><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">smiles</span>&gt;           <span style="color:#f92672">::=</span> &lt;<span style="color:#a6e22e">atom</span>&gt; &lt;<span style="color:#a6e22e">body</span>&gt;*
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">body</span>&gt;             <span style="color:#f92672">::=</span> &lt;<span style="color:#a6e22e">branch</span>&gt; | &lt;<span style="color:#a6e22e">split</span>&gt; | &lt;<span style="color:#a6e22e">union</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">branch</span>&gt;           <span style="color:#f92672">::=</span> &#34;(&#34; ( &lt;<span style="color:#a6e22e">dot</span>&gt; | &lt;<span style="color:#a6e22e">bond</span>&gt; )? &lt;<span style="color:#a6e22e">smiles</span>&gt; &#34;)&#34;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">split</span>&gt;            <span style="color:#f92672">::=</span> &lt;<span style="color:#a6e22e">dot</span>&gt; &lt;<span style="color:#a6e22e">smiles</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">union</span>&gt;            <span style="color:#f92672">::=</span> &lt;<span style="color:#a6e22e">bond</span>&gt;? ( &lt;<span style="color:#a6e22e">smiles</span>&gt; | &lt;<span style="color:#a6e22e">rnum</span>&gt; )
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">atom</span>&gt;             <span style="color:#f92672">::=</span> &lt;<span style="color:#a6e22e">organic</span>&gt; | &lt;<span style="color:#a6e22e">bracket</span>&gt; | &lt;<span style="color:#a6e22e">star</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">bracket</span>&gt;          <span style="color:#f92672">::=</span> &#34;[&#34; &lt;<span style="color:#a6e22e">isotope</span>&gt;? ( &lt;<span style="color:#a6e22e">symbol</span>&gt; | &lt;<span style="color:#a6e22e">bracket_aromatic</span>&gt; | &lt;<span style="color:#a6e22e">star</span>&gt; ) &lt;<span style="color:#a6e22e">parity</span>&gt;? &lt;<span style="color:#a6e22e">hcount</span>&gt;? &lt;<span style="color:#a6e22e">charge</span>&gt;? &lt;<span style="color:#a6e22e">map</span>&gt;? &#34;]&#34;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">isotope</span>&gt;          <span style="color:#f92672">::=</span> &lt;<span style="color:#a6e22e">digit</span>&gt;? &lt;<span style="color:#a6e22e">digit</span>&gt;? &lt;<span style="color:#a6e22e">digit</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">hcount</span>&gt;           <span style="color:#f92672">::=</span> &#34;H&#34; &lt;<span style="color:#a6e22e">digit</span>&gt;?
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">charge</span>&gt;           <span style="color:#f92672">::=</span> &#34;+&#34; ( &#34;+&#34; | &lt;<span style="color:#a6e22e">fifteen</span>&gt; )? | &#34;-&#34; ( &#34;-&#34; | &lt;<span style="color:#a6e22e">fifteen</span>&gt; )?
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">map</span>&gt;              <span style="color:#f92672">::=</span> &#34;:&#34; &lt;<span style="color:#a6e22e">digit</span>&gt;? &lt;<span style="color:#a6e22e">digit</span>&gt;? &lt;<span style="color:#a6e22e">digit</span>&gt;? &lt;<span style="color:#a6e22e">digit</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">rnum</span>&gt;             <span style="color:#f92672">::=</span> &lt;<span style="color:#a6e22e">digit</span>&gt; | &#34;%&#34; &lt;<span style="color:#a6e22e">digit</span>&gt; &lt;<span style="color:#a6e22e">digit</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">parity</span>&gt;           <span style="color:#f92672">::=</span> &#34;@&#34; ( &#34;@&#34; | &lt;<span style="color:#a6e22e">parity_suffix</span>&gt; )?
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">parity_suffix</span>&gt;    <span style="color:#f92672">::=</span> &lt;<span style="color:#a6e22e">parity_th</span>&gt; |&lt;<span style="color:#a6e22e">parity_al</span>&gt; | &lt;<span style="color:#a6e22e">parity_sp</span>&gt; | &lt;<span style="color:#a6e22e">parity_tb</span>&gt; | &lt;<span style="color:#a6e22e">parity_oh</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">parity_th</span>&gt;        <span style="color:#f92672">::=</span> &#34;TH&#34; (&#34;1&#34; | &#34;2&#34; )
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">parity_al</span>&gt;        <span style="color:#f92672">::=</span> &#34;AL&#34; (&#34;1&#34; | &#34;2&#34; )
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">parity_sp</span>&gt;        <span style="color:#f92672">::=</span> &#34;SP&#34; ( &#34;1&#34; | &#34;2&#34; | &#34;3&#34; )
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">parity_tb</span>&gt;        <span style="color:#f92672">::=</span> &#34;TB&#34; &lt;<span style="color:#a6e22e">twenty</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">parity_oh</span>&gt;        <span style="color:#f92672">::=</span> &#34;OH&#34; &lt;<span style="color:#a6e22e">thirty</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">organic</span>&gt;          <span style="color:#f92672">::=</span> &#34;B&#34; &#34;r&#34;? | &#34;C&#34; &#34;l&#34;? | &#34;N&#34; | &#34;O&#34; | &#34;P&#34; | &#34;S&#34;
</span></span><span style="display:flex;"><span>                     | &#34;F&#34; | &#34;I&#34; | &#34;At&#34; | &#34;Ts&#34;
</span></span><span style="display:flex;"><span>                     | &#34;b&#34; | &#34;c&#34; | &#34;n&#34; | &#34;o&#34; | &#34;p&#34; | &#34;s&#34;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">symbol</span>&gt;           <span style="color:#f92672">::=</span> &#34;A&#34; ( &#34;c&#34; | &#34;g&#34; | &#34;l&#34; | &#34;m&#34; | &#34;r&#34; | &#34;s&#34; | &#34;t&#34; | &#34;u&#34; )
</span></span><span style="display:flex;"><span>                     | &#34;B&#34; ( &#34;a&#34; | &#34;e&#34; | &#34;h&#34; | &#34;i&#34; | &#34;k&#34; | &#34;r&#34; )?
</span></span><span style="display:flex;"><span>                     | &#34;C&#34; ( &#34;a&#34; | &#34;d&#34; | &#34;e&#34; | &#34;f&#34; | &#34;l&#34; | &#34;m&#34; | &#34;n&#34; | &#34;o&#34;
</span></span><span style="display:flex;"><span>                     | &#34;r&#34; | &#34;s&#34; | &#34;u&#34; )?
</span></span><span style="display:flex;"><span>                     | &#34;D&#34; ( &#34;b&#34; | &#34;s&#34; | &#34;y&#34; )
</span></span><span style="display:flex;"><span>                     | &#34;E&#34; ( &#34;r&#34; | &#34;s&#34; | &#34;u&#34; )
</span></span><span style="display:flex;"><span>                     | &#34;F&#34; ( &#34;e&#34; | &#34;l&#34; | &#34;m&#34; | &#34;r&#34; )?
</span></span><span style="display:flex;"><span>                     | &#34;G&#34; ( &#34;a&#34; | &#34;d&#34; | &#34;e&#34; )
</span></span><span style="display:flex;"><span>                     | &#34;H&#34; ( &#34;e&#34; | &#34;f&#34; | &#34;g&#34; | &#34;o&#34; | &#34;s&#34; )?
</span></span><span style="display:flex;"><span>                     | &#34;I&#34; ( &#34;n&#34; | &#34;r&#34; )?
</span></span><span style="display:flex;"><span>                     | &#34;K&#34; &#34;r&#34;?
</span></span><span style="display:flex;"><span>                     | &#34;L&#34; ( &#34;a&#34; | &#34;i&#34; | &#34;r&#34; | &#34;u&#34; | &#34;v&#34; )
</span></span><span style="display:flex;"><span>                     | &#34;M&#34; ( &#34;c&#34; | &#34;g&#34; | &#34;n&#34; | &#34;o&#34; | &#34;t&#34; )
</span></span><span style="display:flex;"><span>                     | &#34;N&#34; ( &#34;a&#34; | &#34;b&#34; | &#34;d&#34; | &#34;e&#34; | &#34;h&#34; | &#34;i&#34; | &#34;o&#34; | &#34;p&#34; )?
</span></span><span style="display:flex;"><span>                     | &#34;O&#34; ( &#34;g&#34; | &#34;s&#34; )?
</span></span><span style="display:flex;"><span>                     | &#34;P&#34; ( &#34;a&#34; | &#34;b&#34; | &#34;d&#34; | &#34;m&#34; | &#34;o&#34; | &#34;r&#34; | &#34;t&#34; | &#34;u&#34; )?
</span></span><span style="display:flex;"><span>                     | &#34;R&#34; ( &#34;a&#34; | &#34;b&#34; | &#34;e&#34; | &#34;f&#34; | &#34;g&#34; | &#34;h&#34; | &#34;n&#34; | &#34;u&#34; )
</span></span><span style="display:flex;"><span>                     | &#34;S&#34; ( &#34;b&#34; | &#34;c&#34; | &#34;e&#34; | &#34;g&#34; | &#34;i&#34; | &#34;m&#34; | &#34;n&#34; | &#34;r&#34; )?
</span></span><span style="display:flex;"><span>                     | &#34;T&#34; ( &#34;a&#34; | &#34;b&#34; | &#34;c&#34; | &#34;e&#34; | &#34;h&#34; | &#34;i&#34; | &#34;l&#34; | &#34;m&#34;
</span></span><span style="display:flex;"><span>                     | &#34;s&#34; )
</span></span><span style="display:flex;"><span>                     | &#34;U&#34; | &#34;V&#34; | &#34;W&#34; | &#34;Xe&#34; | &#34;Y&#34; &#34;b&#34;?
</span></span><span style="display:flex;"><span>                     | &#34;Z&#34; ( &#34;n&#34; | &#34;r&#34; )
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">bracket_aromatic</span>&gt; <span style="color:#f92672">::=</span> &#34;b&#34; | &#34;c&#34; | &#34;n&#34; | &#34;o&#34; | &#34;p&#34; | &#34;s&#34; &#34;e&#34;? | &#34;as&#34;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">bond</span>&gt;             <span style="color:#f92672">::=</span> &#34;-&#34; | &#34;=&#34; | &#34;#&#34; | &#34;$&#34; | &#34;/&#34; | &#34;\\&#34;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">fifteen</span>&gt;          <span style="color:#f92672">::=</span> &#34;1&#34; (&#34;0&#34; | &#34;1&#34; | &#34;2&#34; | &#34;3&#34; | &#34;4&#34; | &#34;5&#34;)?
</span></span><span style="display:flex;"><span>                     | ( &#34;2&#34; | &#34;3&#34; | &#34;4&#34; | &#34;5&#34; | &#34;6&#34; | &#34;7&#34; | &#34;8&#34; | &#34;9&#34; )
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">twenty</span>&gt;           <span style="color:#f92672">::=</span> ( &#34;1&#34; &lt;<span style="color:#a6e22e">digit</span>&gt;? )
</span></span><span style="display:flex;"><span>                     | ( &#34;2&#34; &#34;0&#34;? )
</span></span><span style="display:flex;"><span>                     | ( &#34;3&#34; | &#34;4&#34; | &#34;5&#34; | &#34;6&#34; | &#34;7&#34; | &#34;8&#34; | &#34;9&#34; )
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">thirty</span>&gt;           <span style="color:#f92672">::=</span> ( &#34;1&#34; &lt;<span style="color:#a6e22e">digit</span>&gt;? )
</span></span><span style="display:flex;"><span>                     | ( &#34;2&#34; &lt;<span style="color:#a6e22e">digit</span>&gt;? )
</span></span><span style="display:flex;"><span>                     | ( &#34;3&#34; &#34;0&#34;? )
</span></span><span style="display:flex;"><span>                     | ( &#34;4&#34; | &#34;5&#34; | &#34;6&#34; | &#34;7&#34; | &#34;8&#34; | &#34;9&#34; )
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">digit</span>&gt;            <span style="color:#f92672">::=</span> &#34;0&#34; | &#34;1&#34; | &#34;2&#34; | &#34;3&#34; | &#34;4&#34; | &#34;5&#34; | &#34;6&#34; | &#34;7&#34; | &#34;8&#34; | &#34;9&#34;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">dot</span>&gt;              <span style="color:#f92672">::=</span> &#34;.&#34;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">star</span>&gt;             <span style="color:#f92672">::=</span> &#34;*&#34;
</span></span></code></pre></div><p>This new grammar supports all features defined by the <a href="http://opensmiles.org">OpenSMILES specification</a>. As the previous section highlighted, the core set of rules can be expressed with a handful of productions. Unlocking the full set of features, particularly bracket atom properties, requires many more productions.</p>
<h1 id="conclusion">Conclusion</h1>
<p>An improved LL(1) SMILES formal grammar has been developed. It supports all features in the OpenSMILES specification. The grammar presented here simplifies some previously-presented production rules and uses more descriptive production names. As such, the new grammar be used as a starting point for the development of efficient and robust OpenSMILES-compliant parsers. It can also help to address a number of questions regarding allowed SMILES syntax.</p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://localhost:1313/" >
    &copy;  Depth-First 2024 
  </a>
    <div><div class="ananke-socials"></div>
</div>
  </div>
</footer>

  </body>
</html>
