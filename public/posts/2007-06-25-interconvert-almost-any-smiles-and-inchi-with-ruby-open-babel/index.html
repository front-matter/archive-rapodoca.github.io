<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Interconvert (Almost) Any SMILES and InChI with Ruby Open Babel | My New Hugo Site</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="SMILES and InChI are the two most widely-used line notations in cheminformatics. Not surprisingly, there are many situations in which it&rsquo;s useful to interconvert the two. This article shows a simple method for doing so using Ruby Open Babel.
Parsing InChIs
Version 1.01 of the IUPAC/NIST C InChI toolkit introduced the ability to parse InChIs. This capability has subsequently been incorporated into Open Babel, and by extension, Ruby Open Babel. It&rsquo;s this capability that we&rsquo;ll take advantage of.">
    <meta name="generator" content="Hugo 0.139.4">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    

    
      

    

    

    
      <link rel="canonical" href="http://localhost:1313/posts/2007-06-25-interconvert-almost-any-smiles-and-inchi-with-ruby-open-babel/">
    

    <meta property="og:url" content="http://localhost:1313/posts/2007-06-25-interconvert-almost-any-smiles-and-inchi-with-ruby-open-babel/">
  <meta property="og:site_name" content="My New Hugo Site">
  <meta property="og:title" content="Interconvert (Almost) Any SMILES and InChI with Ruby Open Babel">
  <meta property="og:description" content="SMILES and InChI are the two most widely-used line notations in cheminformatics. Not surprisingly, there are many situations in which it’s useful to interconvert the two. This article shows a simple method for doing so using Ruby Open Babel.
Parsing InChIs Version 1.01 of the IUPAC/NIST C InChI toolkit introduced the ability to parse InChIs. This capability has subsequently been incorporated into Open Babel, and by extension, Ruby Open Babel. It’s this capability that we’ll take advantage of.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2007-06-25T00:00:00+00:00">
    <meta property="article:modified_time" content="2007-06-25T00:00:00+00:00">

  <meta itemprop="name" content="Interconvert (Almost) Any SMILES and InChI with Ruby Open Babel">
  <meta itemprop="description" content="SMILES and InChI are the two most widely-used line notations in cheminformatics. Not surprisingly, there are many situations in which it’s useful to interconvert the two. This article shows a simple method for doing so using Ruby Open Babel.
Parsing InChIs Version 1.01 of the IUPAC/NIST C InChI toolkit introduced the ability to parse InChIs. This capability has subsequently been incorporated into Open Babel, and by extension, Ruby Open Babel. It’s this capability that we’ll take advantage of.">
  <meta itemprop="datePublished" content="2007-06-25T00:00:00+00:00">
  <meta itemprop="dateModified" content="2007-06-25T00:00:00+00:00">
  <meta itemprop="wordCount" content="467">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Interconvert (Almost) Any SMILES and InChI with Ruby Open Babel">
  <meta name="twitter:description" content="SMILES and InChI are the two most widely-used line notations in cheminformatics. Not surprisingly, there are many situations in which it’s useful to interconvert the two. This article shows a simple method for doing so using Ruby Open Babel.
Parsing InChIs Version 1.01 of the IUPAC/NIST C InChI toolkit introduced the ability to parse InChIs. This capability has subsequently been incorporated into Open Babel, and by extension, Ruby Open Babel. It’s this capability that we’ll take advantage of.">

	
  </head><body class="ma0 avenir bg-near-white development">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        My New Hugo Site
      
    </a>
    <div class="flex-l items-center">
      

      
      <div class="ananke-socials"></div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Posts
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1">Interconvert (Almost) Any SMILES and InChI with Ruby Open Babel</h1>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2007-06-25T00:00:00Z">June 25, 2007</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>SMILES and InChI are the two most widely-used <a href="http://depth-first.com/articles/2007/03/14/eleven-qualities-of-the-perfect-line-notation-for-the-web">line notations</a> in cheminformatics. Not surprisingly, there are many situations in which it&rsquo;s useful to interconvert the two. This article shows a simple method for doing so using <a href="http://depth-first.com/articles/tag/rubyopenbabel">Ruby Open Babel</a>.</p>
<h1 id="parsing-inchis">Parsing InChIs</h1>
<p>Version 1.01 of the IUPAC/NIST C InChI toolkit introduced the ability to parse InChIs. This capability has subsequently been incorporated into <a href="http://openbabel.sf.net">Open Babel</a>, and by extension, Ruby Open Babel. It&rsquo;s this capability that we&rsquo;ll take advantage of.</p>
<h1 id="a-simple-library">A Simple Library</h1>
<p>The following library provides everything we need to convert between SMILES and InChI via Ruby:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span>require <span style="color:#e6db74">&#39;openbabel&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">module</span> InChI
</span></span><span style="display:flex;"><span>  @@to_smiles <span style="color:#f92672">=</span> <span style="color:#66d9ef">OpenBabel</span><span style="color:#f92672">::</span><span style="color:#66d9ef">OBConversion</span><span style="color:#f92672">.</span>new
</span></span><span style="display:flex;"><span>  @@to_inchi <span style="color:#f92672">=</span> <span style="color:#66d9ef">OpenBabel</span><span style="color:#f92672">::</span><span style="color:#66d9ef">OBConversion</span><span style="color:#f92672">.</span>new
</span></span><span style="display:flex;"><span>  @@to_smiles<span style="color:#f92672">.</span>set_in_and_out_formats <span style="color:#e6db74">&#39;inchi&#39;</span>, <span style="color:#e6db74">&#39;smi&#39;</span>
</span></span><span style="display:flex;"><span>  @@to_inchi<span style="color:#f92672">.</span>set_in_and_out_formats <span style="color:#e6db74">&#39;smi&#39;</span>, <span style="color:#e6db74">&#39;inchi&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">inchi_to_smiles</span> inchi
</span></span><span style="display:flex;"><span>    mol <span style="color:#f92672">=</span> <span style="color:#66d9ef">OpenBabel</span><span style="color:#f92672">::</span><span style="color:#66d9ef">OBMol</span><span style="color:#f92672">.</span>new
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @@to_smiles<span style="color:#f92672">.</span>read_string(mol, inchi) <span style="color:#f92672">or</span> <span style="color:#66d9ef">raise</span> <span style="color:#e6db74">&#34;Can&#39;t parse InChI: </span><span style="color:#e6db74">#{</span>inchi<span style="color:#e6db74">}</span><span style="color:#e6db74">.&#34;</span>
</span></span><span style="display:flex;"><span>    @@to_smiles<span style="color:#f92672">.</span>write_string(mol)<span style="color:#f92672">.</span>strip
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">smiles_to_inchi</span> smiles
</span></span><span style="display:flex;"><span>    mol <span style="color:#f92672">=</span> <span style="color:#66d9ef">OpenBabel</span><span style="color:#f92672">::</span><span style="color:#66d9ef">OBMol</span><span style="color:#f92672">.</span>new
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @@to_inchi<span style="color:#f92672">.</span>read_string(mol, smiles) <span style="color:#f92672">or</span> <span style="color:#66d9ef">raise</span> <span style="color:#e6db74">&#34;Can&#39;t parse SMILES </span><span style="color:#e6db74">#{</span>smiles<span style="color:#e6db74">}</span><span style="color:#e6db74">.&#34;</span>
</span></span><span style="display:flex;"><span>    @@to_inchi<span style="color:#f92672">.</span>write_string(mol)<span style="color:#f92672">.</span>strip
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><h1 id="testing-the-library">Testing the Library</h1>
<p>After saving the above code to a file named <code>inchi.rb</code>, we can interactively convert SMILES and InChIs:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>irb
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:001:0&gt; require <span style="color:#e6db74">&#39;inchi&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; true
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:002:0&gt; include InChI
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; Object
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:003:0&gt; smiles <span style="color:#f92672">=</span> inchi_to_smiles <span style="color:#e6db74">&#34;InChI=1/C14H12/c1-3-7-13(8-4-1)11-12-14-9-5-2-6-10-14/h1-12H/b12-11-&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;c1ccc(cc1)C(/[H])=C(/[H])c1ccccc1&#34;</span>
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:004:0&gt; inchi <span style="color:#f92672">=</span> smiles_to_inchi smiles
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;InChI=1/C14H12/c1-3-7-13(8-4-1)11-12-14-9-5-2-6-10-14/h1-12H/b12-11-&#34;</span>
</span></span></code></pre></div><p>In the above test, the InChI for <em>cis</em>-stilbene is converted into a SMILES string which is then converted back to InChI form with complete fidelity, including alkene geometry. Note that this would not have been possible using the approach that was <a href="http://depth-first.com/articles/2006/09/19/decoding-inchis-with-rino">previously discussed</a> in which molfiles were used as intermediate datastructures.</p>
<p>What about chiral centers? Here the results are mixed. For example, when the round-trip conversion is applied to propranalol (<a href="http://pubchem.ncbi.nlm.nih.gov/summary/summary.cgi?cid=21138">PubChem</a>, <a href="http://60minutes.yahoo.com/segment/21/memory_drug">Video</a>), the configuration of the stereocenter is <em>inverted</em>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>irb
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:001:0&gt; require <span style="color:#e6db74">&#39;inchi&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; true
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:002:0&gt; include InChI
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; Object
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:003:0&gt; smiles <span style="color:#f92672">=</span> inchi_to_smiles <span style="color:#e6db74">&#34;InChI=1/C16H21NO2/c1-12(2)17-10-14(18)11-19-16-9-5-7-13-6-3-4-8-15(13)16/h3-9,12,14,17-18H,10-11H2,1-2H3/t14-/m1/s1&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;CC(C)NC[C@@H](COc1cccc2ccccc12)O&#34;</span>
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:004:0&gt; inchi <span style="color:#f92672">=</span> smiles_to_inchi smiles
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;InChI=1/C16H21NO2/c1-12(2)17-10-14(18)11-19-16-9-5-7-13-6-3-4-8-15(13)16/h3-9,12,14,17-18H,10-11H2,1-2H3/t14-/m0/s1&#34;</span>
</span></span></code></pre></div><p>However, the same round-trip conversion of phenethanol works without inversion of stereochemistry:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>irb
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:001:0&gt; require <span style="color:#e6db74">&#39;inchi&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; true
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:002:0&gt; include InChI
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; Object
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:003:0&gt; smiles <span style="color:#f92672">=</span> inchi_to_smiles <span style="color:#e6db74">&#34; InChI=1/C8H10O/c1-7(9)8-5-3-2-4-6-8/h2-7,9H,1H3/t7-/m0/s1&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;C[C@@H](c1ccccc1)O&#34;</span>
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:004:0&gt; inchi <span style="color:#f92672">=</span> smiles_to_inchi smiles
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;InChI=1/C8H10O/c1-7(9)8-5-3-2-4-6-8/h2-7,9H,1H3/t7-/m0/s1&#34;</span>
</span></span></code></pre></div><p>The most likely explanation is that under certain conditions, Open Babel incorrectly interprets and/or writes stereo parities.</p>
<h1 id="one-more-gotcha">One More Gotcha</h1>
<p>On my system (Linux Mandriva 2007.1), attempting to perform the round-trip test on glucose resulted (reproducibly) in a segfault:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>irb
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:001:0&gt; require <span style="color:#e6db74">&#39;inchi&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; true
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:002:0&gt; include InChI
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; Object
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:003:0&gt; smiles <span style="color:#f92672">=</span> inchi_to_smiles <span style="color:#e6db74">&#34;InChI=1/C6H12O6/c7-1-2-3(8)4(9)5(10)6(11)12-2/h2-11H,1H2/t2-,3-,4+,5-,6?/m1/s1&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;C([C@H]1[C@H]([C@@H]([C@H](C(O)O1)O)O)O)O&#34;</span>
</span></span><span style="display:flex;"><span>irb<span style="color:#f92672">(</span>main<span style="color:#f92672">)</span>:004:0&gt; inchi <span style="color:#f92672">=</span> smiles_to_inchi smiles
</span></span><span style="display:flex;"><span>./inchi.rb:20: <span style="color:#f92672">[</span>BUG<span style="color:#f92672">]</span> Segmentation fault
</span></span><span style="display:flex;"><span>ruby 1.8.6 <span style="color:#f92672">(</span>2007-03-13<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>i686-linux<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Aborted
</span></span></code></pre></div><p>The same segfault was obtained when using the <!-- raw HTML omitted -->babel<!-- raw HTML omitted --> command-line utility:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>babel -ismi -oinchi
</span></span><span style="display:flex;"><span>C<span style="color:#f92672">([</span>C@H<span style="color:#f92672">]</span>1<span style="color:#f92672">[</span>C@H<span style="color:#f92672">]([</span>C@@H<span style="color:#f92672">]([</span>C@H<span style="color:#f92672">](</span>C<span style="color:#f92672">(</span>O<span style="color:#f92672">)</span>O1<span style="color:#f92672">)</span>O<span style="color:#f92672">)</span>O<span style="color:#f92672">)</span>O<span style="color:#f92672">)</span>O
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Return<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>Segmentation fault
</span></span></code></pre></div><h1 id="conclusions">Conclusions</h1>
<p>As you can see, Ruby Open Babel makes short work of interconverting SMILES and InChIs. Despite problems with stereochemical configuration and segfaults on reading certain SMILES strings, the approach outlined here offers a quick and economical way to interconvert a variety of SMILES and InChIs.</p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://localhost:1313/" >
    &copy;  My New Hugo Site 2024 
  </a>
    <div><div class="ananke-socials"></div>
</div>
  </div>
</footer>

  </body>
</html>
